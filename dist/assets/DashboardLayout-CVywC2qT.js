const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Admin-D1IZtL4U.js","assets/ui-vendor-BTHa3W3g.js","assets/react-vendor-a_rYd-gI.js","assets/index-DKqWIKfe.js","assets/chart-vendor-CfBne3GF.js","assets/firebase-vendor-D8A9P6qX.js","assets/index-DOovqBVl.css","assets/tabs-BrE8LWGL.js","assets/index-S1lbbb0H.js","assets/input-DG_vOk1H.js","assets/select-C7ccaO9_.js","assets/index-CdAzXW5_.js","assets/label-DpUXcNw5.js","assets/stat-card-DMiS061l.js","assets/alert-CHQ3_92j.js","assets/dialog-BtDHLVke.js","assets/Relatorios-DL8XmX1l.js","assets/useFirestore-8n9kLk64.js","assets/user-specific.service-DdAfuukF.js","assets/user-subcollections.service-D4i0Ubm3.js","assets/Historico-Bpoztb4v.js","assets/format-DPwKrYwk.js","assets/pt-BR-DnZ5gAgy.js","assets/Pagamentos-Z9iqf9l2.js","assets/Saldos-DrrYyZRZ.js","assets/GestaoFuncionarios-CRN6zh8Y.js","assets/EmployeeProfile-BGjOFdkM.js","assets/Dashboard-CCZBhmmE.js","assets/user-config.service-CoX90ZHO.js"])))=>i.map(i=>d[i]);
var ai=Object.defineProperty;var oi=(n,e,t)=>e in n?ai(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ps=(n,e,t)=>oi(n,typeof e!="symbol"?e+"":e,t);import{j as l,i as Be,ag as ii,_ as We,ah as li,X as ar,k as ms,ai as ci,aj as ui,U as di,D as fi,F as hi,ak as pi,e as mi,g as gi,C as _i,al as bi,a6 as wi,a0 as yi,S as vi,am as xi,an as Si}from"./ui-vendor-BTHa3W3g.js";import{r as h,u as Ci,j as Ai}from"./react-vendor-a_rYd-gI.js";import{_ as fe,d as Le,c as Dn,e as G,P as ee,b as xe,a as J,G as ue,f as Ei,h as oe,i as or,B as Ue,C as Ri,v as Pi,w as Ni,y as Ii,j as Oi,D as Ti,H as ki,u as $i,r as Di,s as ji,I as Mi,n as ir,l as Li}from"./index-DKqWIKfe.js";import{y as Fi,p as en,q as gs,t as _s,x as Bi,v as bs,G as ws,e as ys}from"./firebase-vendor-D8A9P6qX.js";import{I as Wi}from"./input-DG_vOk1H.js";import{a as Ui,u as tn}from"./index-S1lbbb0H.js";const qi=(n=1024)=>{const[e,t]=h.useState(!1);return h.useEffect(()=>{const s=()=>{t(window.innerWidth<n)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[n]),e},Hi=()=>{const n=h.useCallback(s=>{switch(s){case"/admin":fe(()=>import("./Admin-D1IZtL4U.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]));break;case"/relatorios":fe(()=>import("./Relatorios-DL8XmX1l.js").then(r=>r.R),__vite__mapDeps([16,1,2,3,4,5,6,10,8,11,17,18,19]));break;case"/historico":fe(()=>import("./Historico-Bpoztb4v.js"),__vite__mapDeps([20,1,2,3,4,5,6,15,9,12,10,8,11,17,18,19,21,22]));break;case"/pagamentos":fe(()=>import("./Pagamentos-Z9iqf9l2.js"),__vite__mapDeps([23,1,2,3,4,5,6,9,10,8,11,17,18,19]));break;case"/saldos":fe(()=>import("./Saldos-DrrYyZRZ.js"),__vite__mapDeps([24,1,2,3,4,5,6,9,12,17,18,19,15,8]));break;case"/gestao-funcionarios":fe(()=>import("./GestaoFuncionarios-CRN6zh8Y.js"),__vite__mapDeps([25,1,2,3,4,5,6,9,15,17,18,19,12,14,8])),fe(()=>import("./EmployeeProfile-BGjOFdkM.js"),__vite__mapDeps([26,1,2,3,4,5,6,9,12,10,8,11,15,17,18,19]));break;case"/dashboard":fe(()=>import("./Dashboard-CCZBhmmE.js"),__vite__mapDeps([27,1,2,13,3,4,5,6,15,9,12,17,18,19,28,10,8,11,21,22]));break}},[]),e=h.useCallback(s=>{n(s)},[n]),t=h.useCallback(()=>{"requestIdleCallback"in window?window.requestIdleCallback(()=>{n("/dashboard"),n("/gestao-funcionarios"),n("/pagamentos")}):setTimeout(()=>{n("/dashboard"),n("/gestao-funcionarios"),n("/pagamentos")},2e3)},[n]);return{preloadRoute:n,preloadOnHover:e,preloadOnIdle:t}};function P(n,e,t,s,r){if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}function p(n,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(n):s?s.value:e.get(n)}let lr=function(){const{crypto:n}=globalThis;if(n?.randomUUID)return lr=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^t()&15>>+s/4).toString(16))};function wn(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const yn=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};class E extends Error{}class q extends E{constructor(e,t,s,r){super(`${q.makeMessage(e,t,s)}`),this.status=e,this.headers=r,this.requestID=r?.get("x-request-id"),this.error=t;const a=t;this.code=a?.code,this.param=a?.param,this.type=a?.type}static makeMessage(e,t,s){const r=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,s,r){if(!e||!r)return new Ft({message:s,cause:yn(t)});const a=t?.error;return e===400?new cr(e,a,s,r):e===401?new ur(e,a,s,r):e===403?new dr(e,a,s,r):e===404?new fr(e,a,s,r):e===409?new hr(e,a,s,r):e===422?new pr(e,a,s,r):e===429?new mr(e,a,s,r):e>=500?new gr(e,a,s,r):new q(e,a,s,r)}}class Y extends q{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Ft extends q{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class jn extends Ft{constructor({message:e}={}){super({message:e??"Request timed out."})}}class cr extends q{}class ur extends q{}class dr extends q{}class fr extends q{}class hr extends q{}class pr extends q{}class mr extends q{}class gr extends q{}class _r extends E{constructor(){super("Could not parse response content as the length limit was reached")}}class br extends E{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class qe extends Error{constructor(e){super(e)}}const Vi=/^[a-z][a-z0-9+.-]*:/i,zi=n=>Vi.test(n);let V=n=>(V=Array.isArray,V(n)),vs=V;function wr(n){return typeof n!="object"?{}:n??{}}function Xi(n){if(!n)return!0;for(const e in n)return!1;return!0}function Ki(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function nn(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}const Ji=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new E(`${n} must be an integer`);if(e<0)throw new E(`${n} must be a positive integer`);return e},Yi=n=>{try{return JSON.parse(n)}catch{return}},nt=n=>new Promise(e=>setTimeout(e,n)),Ne="6.3.0",Gi=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function Qi(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Zi=()=>{const n=Qi();if(n==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ne,"X-Stainless-OS":Ss(Deno.build.os),"X-Stainless-Arch":xs(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ne,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(n==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ne,"X-Stainless-OS":Ss(globalThis.process.platform??"unknown"),"X-Stainless-Arch":xs(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=el();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ne,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ne,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function el(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const s=t.exec(navigator.userAgent);if(s){const r=s[1]||0,a=s[2]||0,o=s[3]||0;return{browser:e,version:`${r}.${a}.${o}`}}}return null}const xs=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Ss=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Cs;const tl=()=>Cs??(Cs=Zi());function nl(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function yr(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function vr(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return yr({start(){},async pull(t){const{done:s,value:r}=await e.next();s?t.close():t.enqueue(r)},async cancel(){await e.return?.()}})}function xr(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function sl(n){if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await n[Symbol.asyncIterator]().return?.();return}const e=n.getReader(),t=e.cancel();e.releaseLock(),await t}const rl=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),Sr="RFC3986",Cr=n=>String(n),As={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:Cr},al="RFC1738";let vn=(n,e)=>(vn=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),vn(n,e));const ne=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),sn=1024,ol=(n,e,t,s,r)=>{if(n.length===0)return n;let a=n;if(typeof n=="symbol"?a=Symbol.prototype.toString.call(n):typeof n!="string"&&(a=String(n)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(i){return"%26%23"+parseInt(i.slice(2),16)+"%3B"});let o="";for(let i=0;i<a.length;i+=sn){const c=a.length>=sn?a.slice(i,i+sn):a,d=[];for(let m=0;m<c.length;++m){let u=c.charCodeAt(m);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||r===al&&(u===40||u===41)){d[d.length]=c.charAt(m);continue}if(u<128){d[d.length]=ne[u];continue}if(u<2048){d[d.length]=ne[192|u>>6]+ne[128|u&63];continue}if(u<55296||u>=57344){d[d.length]=ne[224|u>>12]+ne[128|u>>6&63]+ne[128|u&63];continue}m+=1,u=65536+((u&1023)<<10|c.charCodeAt(m)&1023),d[d.length]=ne[240|u>>18]+ne[128|u>>12&63]+ne[128|u>>6&63]+ne[128|u&63]}o+=d.join("")}return o};function il(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function Es(n,e){if(V(n)){const t=[];for(let s=0;s<n.length;s+=1)t.push(e(n[s]));return t}return e(n)}const Ar={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},Er=function(n,e){Array.prototype.push.apply(n,V(e)?e:[e])};let Rs;const F={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ol,encodeValuesOnly:!1,format:Sr,formatter:Cr,indices:!1,serializeDate(n){return(Rs??(Rs=Function.prototype.call.bind(Date.prototype.toISOString)))(n)},skipNulls:!1,strictNullHandling:!1};function ll(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const rn={};function Rr(n,e,t,s,r,a,o,i,c,d,m,u,g,f,v,_,C,x){let b=n,y=x,R=0,O=!1;for(;(y=y.get(rn))!==void 0&&!O;){const $=y.get(n);if(R+=1,typeof $<"u"){if($===R)throw new RangeError("Cyclic object value");O=!0}typeof y.get(rn)>"u"&&(R=0)}if(typeof d=="function"?b=d(e,b):b instanceof Date?b=g?.(b):t==="comma"&&V(b)&&(b=Es(b,function($){return $ instanceof Date?g?.($):$})),b===null){if(a)return c&&!_?c(e,F.encoder,C,"key",f):e;b=""}if(ll(b)||il(b)){if(c){const $=_?e:c(e,F.encoder,C,"key",f);return[v?.($)+"="+v?.(c(b,F.encoder,C,"value",f))]}return[v?.(e)+"="+v?.(String(b))]}const k=[];if(typeof b>"u")return k;let T;if(t==="comma"&&V(b))_&&c&&(b=Es(b,c)),T=[{value:b.length>0?b.join(",")||null:void 0}];else if(V(d))T=d;else{const $=Object.keys(b);T=m?$.sort(m):$}const D=i?String(e).replace(/\./g,"%2E"):String(e),N=s&&V(b)&&b.length===1?D+"[]":D;if(r&&V(b)&&b.length===0)return N+"[]";for(let $=0;$<T.length;++$){const j=T[$],Qt=typeof j=="object"&&typeof j.value<"u"?j.value:b[j];if(o&&Qt===null)continue;const Zt=u&&i?j.replace(/\./g,"%2E"):j,ri=V(b)?typeof t=="function"?t(N,Zt):N:N+(u?"."+Zt:"["+Zt+"]");x.set(n,R);const hs=new WeakMap;hs.set(rn,x),Er(k,Rr(Qt,ri,t,s,r,a,o,i,t==="comma"&&_&&V(b)?null:c,d,m,u,g,f,v,_,C,hs))}return k}function cl(n=F){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||F.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Sr;if(typeof n.format<"u"){if(!vn(As,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const s=As[t];let r=F.filter;(typeof n.filter=="function"||V(n.filter))&&(r=n.filter);let a;if(n.arrayFormat&&n.arrayFormat in Ar?a=n.arrayFormat:"indices"in n?a=n.indices?"indices":"repeat":a=F.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:F.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:F.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:F.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:F.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?F.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:F.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:F.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:F.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:F.encodeValuesOnly,filter:r,format:t,formatter:s,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:F.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:F.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:F.strictNullHandling}}function ul(n,e={}){let t=n;const s=cl(e);let r,a;typeof s.filter=="function"?(a=s.filter,t=a("",t)):V(s.filter)&&(a=s.filter,r=a);const o=[];if(typeof t!="object"||t===null)return"";const i=Ar[s.arrayFormat],c=i==="comma"&&s.commaRoundTrip;r||(r=Object.keys(t)),s.sort&&r.sort(s.sort);const d=new WeakMap;for(let g=0;g<r.length;++g){const f=r[g];s.skipNulls&&t[f]===null||Er(o,Rr(t[f],f,i,c,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,d))}const m=o.join(s.delimiter);let u=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),m.length>0?u+m:""}function dl(n){let e=0;for(const r of n)e+=r.length;const t=new Uint8Array(e);let s=0;for(const r of n)t.set(r,s),s+=r.length;return t}let Ps;function Mn(n){let e;return(Ps??(e=new globalThis.TextEncoder,Ps=e.encode.bind(e)))(n)}let Ns;function Is(n){let e;return(Ns??(e=new globalThis.TextDecoder,Ns=e.decode.bind(e)))(n)}var z,X;class Bt{constructor(){z.set(this,void 0),X.set(this,void 0),P(this,z,new Uint8Array),P(this,X,null)}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Mn(e):e;P(this,z,dl([p(this,z,"f"),t]));const s=[];let r;for(;(r=fl(p(this,z,"f"),p(this,X,"f")))!=null;){if(r.carriage&&p(this,X,"f")==null){P(this,X,r.index);continue}if(p(this,X,"f")!=null&&(r.index!==p(this,X,"f")+1||r.carriage)){s.push(Is(p(this,z,"f").subarray(0,p(this,X,"f")-1))),P(this,z,p(this,z,"f").subarray(p(this,X,"f"))),P(this,X,null);continue}const a=p(this,X,"f")!==null?r.preceding-1:r.preceding,o=Is(p(this,z,"f").subarray(0,a));s.push(o),P(this,z,p(this,z,"f").subarray(r.index)),P(this,X,null)}return s}flush(){return p(this,z,"f").length?this.decode(`
`):[]}}z=new WeakMap,X=new WeakMap;Bt.NEWLINE_CHARS=new Set([`
`,"\r"]);Bt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function fl(n,e){for(let r=e??0;r<n.length;r++){if(n[r]===10)return{preceding:r,index:r+1,carriage:!1};if(n[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function hl(n){for(let s=0;s<n.length-1;s++){if(n[s]===10&&n[s+1]===10||n[s]===13&&n[s+1]===13)return s+2;if(n[s]===13&&n[s+1]===10&&s+3<n.length&&n[s+2]===13&&n[s+3]===10)return s+4}return-1}const Rt={off:0,error:200,warn:300,info:400,debug:500},Os=(n,e,t)=>{if(n){if(Ki(Rt,n))return n;W(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Rt))}`)}};function He(){}function at(n,e,t){return!e||Rt[n]>Rt[t]?He:e[n].bind(e)}const pl={error:He,warn:He,info:He,debug:He};let Ts=new WeakMap;function W(n){const e=n.logger,t=n.logLevel??"off";if(!e)return pl;const s=Ts.get(e);if(s&&s[0]===t)return s[1];const r={error:at("error",e,t),warn:at("warn",e,t),info:at("info",e,t),debug:at("debug",e,t)};return Ts.set(e,[t,r]),r}const ge=n=>(n.options&&(n.options={...n.options},delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);var Fe;class ae{constructor(e,t,s){this.iterator=e,Fe.set(this,void 0),this.controller=t,P(this,Fe,s)}static fromSSEResponse(e,t,s){let r=!1;const a=s?W(s):console;async function*o(){if(r)throw new E("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const c of ml(e,t))if(!i){if(c.data.startsWith("[DONE]")){i=!0;continue}if(c.event===null||!c.event.startsWith("thread.")){let d;try{d=JSON.parse(c.data)}catch(m){throw a.error("Could not parse message into JSON:",c.data),a.error("From chunk:",c.raw),m}if(d&&d.error)throw new q(void 0,d.error,void 0,e.headers);yield d}else{let d;try{d=JSON.parse(c.data)}catch(m){throw console.error("Could not parse message into JSON:",c.data),console.error("From chunk:",c.raw),m}if(c.event=="error")throw new q(void 0,d.error,d.message,void 0);yield{event:c.event,data:d}}}i=!0}catch(c){if(wn(c))return;throw c}finally{i||t.abort()}}return new ae(o,t,s)}static fromReadableStream(e,t,s){let r=!1;async function*a(){const i=new Bt,c=xr(e);for await(const d of c)for(const m of i.decode(d))yield m;for(const d of i.flush())yield d}async function*o(){if(r)throw new E("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const c of a())i||c&&(yield JSON.parse(c));i=!0}catch(c){if(wn(c))return;throw c}finally{i||t.abort()}}return new ae(o,t,s)}[(Fe=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],t=[],s=this.iterator(),r=a=>({next:()=>{if(a.length===0){const o=s.next();e.push(o),t.push(o)}return a.shift()}});return[new ae(()=>r(e),this.controller,p(this,Fe,"f")),new ae(()=>r(t),this.controller,p(this,Fe,"f"))]}toReadableStream(){const e=this;let t;return yr({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:r,done:a}=await t.next();if(a)return s.close();const o=Mn(JSON.stringify(r)+`
`);s.enqueue(o)}catch(r){s.error(r)}},async cancel(){await t.return?.()}})}}async function*ml(n,e){if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new E("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new E("Attempted to iterate over a response with no body");const t=new _l,s=new Bt,r=xr(n.body);for await(const a of gl(r))for(const o of s.decode(a)){const i=t.decode(o);i&&(yield i)}for(const a of s.flush()){const o=t.decode(a);o&&(yield o)}}async function*gl(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const s=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?Mn(t):t;let r=new Uint8Array(e.length+s.length);r.set(e),r.set(s,e.length),e=r;let a;for(;(a=hl(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class _l{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,r]=bl(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function bl(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function Pr(n,e){const{response:t,requestLogID:s,retryOfRequestLogID:r,startTime:a}=e,o=await(async()=>{if(e.options.stream)return W(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):ae.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const c=t.headers.get("content-type")?.split(";")[0]?.trim();if(c?.includes("application/json")||c?.endsWith("+json")){const u=await t.json();return Nr(u,t)}return await t.text()})();return W(n).debug(`[${s}] response parsed`,ge({retryOfRequestLogID:r,url:t.url,status:t.status,body:o,durationMs:Date.now()-a})),o}function Nr(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Ve;class Wt extends Promise{constructor(e,t,s=Pr){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=s,Ve.set(this,void 0),P(this,Ve,e)}_thenUnwrap(e){return new Wt(p(this,Ve,"f"),this.responsePromise,async(t,s)=>Nr(e(await this.parseResponse(t,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(p(this,Ve,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Ve=new WeakMap;var ot;class Ln{constructor(e,t,s,r){ot.set(this,void 0),P(this,ot,e),this.options=r,this.response=t,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new E("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await p(this,ot,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(ot=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class wl extends Wt{constructor(e,t,s){super(e,t,async(r,a)=>new s(r,a.response,await Pr(r,a),a.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}class Ut extends Ln{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class M extends Ln{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.getPaginatedItems(),t=e[e.length-1]?.id;return t?{...this.options,query:{...wr(this.options.query),after:t}}:null}}class Pt extends Ln{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...wr(this.options.query),after:e}}:null}}const Ir=()=>{if(typeof File>"u"){const{process:n}=globalThis,e=typeof n?.versions?.node=="string"&&parseInt(n.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Qe(n,e,t){return Ir(),new File(n,e??"unknown_file",t)}function gt(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const Fn=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",xn=async(n,e)=>Sn(n.body)?{...n,body:await Or(n.body,e)}:n,ye=async(n,e)=>({...n,body:await Or(n.body,e)}),ks=new WeakMap;function yl(n){const e=typeof n=="function"?n:n.fetch,t=ks.get(e);if(t)return t;const s=(async()=>{try{const r="Response"in e?e.Response:(await e("data:,")).constructor,a=new FormData;return a.toString()!==await new r(a).text()}catch{return!0}})();return ks.set(e,s),s}const Or=async(n,e)=>{if(!await yl(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const t=new FormData;return await Promise.all(Object.entries(n||{}).map(([s,r])=>Cn(t,s,r))),t},Tr=n=>n instanceof Blob&&"name"in n,vl=n=>typeof n=="object"&&n!==null&&(n instanceof Response||Fn(n)||Tr(n)),Sn=n=>{if(vl(n))return!0;if(Array.isArray(n))return n.some(Sn);if(n&&typeof n=="object"){for(const e in n)if(Sn(n[e]))return!0}return!1},Cn=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(t instanceof Response)n.append(e,Qe([await t.blob()],gt(t)));else if(Fn(t))n.append(e,Qe([await new Response(vr(t)).blob()],gt(t)));else if(Tr(t))n.append(e,t,gt(t));else if(Array.isArray(t))await Promise.all(t.map(s=>Cn(n,e+"[]",s)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([s,r])=>Cn(n,`${e}[${s}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}},kr=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",xl=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&kr(n),Sl=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function Cl(n,e,t){if(Ir(),n=await n,xl(n))return n instanceof File?n:Qe([await n.arrayBuffer()],n.name);if(Sl(n)){const r=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Qe(await An(r),e,t)}const s=await An(n);if(e||(e=gt(n)),!t?.type){const r=s.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof r=="string"&&(t={...t,type:r})}return Qe(s,e,t)}async function An(n){let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(kr(n))e.push(n instanceof Blob?n:await n.arrayBuffer());else if(Fn(n))for await(const t of n)e.push(...await An(t));else{const t=n?.constructor?.name;throw new Error(`Unexpected data type: ${typeof n}${t?`; constructor: ${t}`:""}${Al(n)}`)}return e}function Al(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}class A{constructor(e){this._client=e}}function $r(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const $s=Object.freeze(Object.create(null)),El=(n=$r)=>function(t,...s){if(t.length===1)return t[0];let r=!1;const a=[],o=t.reduce((m,u,g)=>{/[?#]/.test(u)&&(r=!0);const f=s[g];let v=(r?encodeURIComponent:n)(""+f);return g!==s.length&&(f==null||typeof f=="object"&&f.toString===Object.getPrototypeOf(Object.getPrototypeOf(f.hasOwnProperty??$s)??$s)?.toString)&&(v=f+"",a.push({start:m.length+u.length,length:v.length,error:`Value of type ${Object.prototype.toString.call(f).slice(8,-1)} is not a valid path parameter`})),m+u+(g===s.length?"":v)},""),i=o.split(/[?#]/,1)[0],c=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let d;for(;(d=c.exec(i))!==null;)a.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(a.sort((m,u)=>m.start-u.start),a.length>0){let m=0;const u=a.reduce((g,f)=>{const v=" ".repeat(f.start-m),_="^".repeat(f.length);return m=f.start+f.length,g+v+_},"");throw new E(`Path parameters result in path with invalid segments:
${a.map(g=>g.error).join(`
`)}
${o}
${u}`)}return o},w=El($r);let Dr=class extends A{list(e,t={},s){return this._client.getAPIList(w`/chat/completions/${e}/messages`,M,{query:t,...s})}};function Nt(n){return n!==void 0&&"function"in n&&n.function!==void 0}function Bn(n){return n?.$brand==="auto-parseable-response-format"}function st(n){return n?.$brand==="auto-parseable-tool"}function Rl(n,e){return!e||!jr(e)?{...n,choices:n.choices.map(t=>(Mr(t.message.tool_calls),{...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:Wn(n,e)}function Wn(n,e){const t=n.choices.map(s=>{if(s.finish_reason==="length")throw new _r;if(s.finish_reason==="content_filter")throw new br;return Mr(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:s.message.tool_calls?.map(r=>Nl(e,r))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?Pl(e,s.message.content):null}}});return{...n,choices:t}}function Pl(n,e){return n.response_format?.type!=="json_schema"?null:n.response_format?.type==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function Nl(n,e){const t=n.tools?.find(s=>Nt(s)&&s.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:st(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function Il(n,e){if(!n||!("tools"in n)||!n.tools)return!1;const t=n.tools?.find(s=>Nt(s)&&s.function?.name===e.function.name);return Nt(t)&&(st(t)||t?.function.strict||!1)}function jr(n){return Bn(n.response_format)?!0:n.tools?.some(e=>st(e)||e.type==="function"&&e.function.strict===!0)??!1}function Mr(n){for(const e of n||[])if(e.type!=="function")throw new E(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function Ol(n){for(const e of n??[]){if(e.type!=="function")throw new E(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new E(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const It=n=>n?.role==="assistant",Lr=n=>n?.role==="tool";var En,_t,bt,ze,Xe,wt,Ke,ce,Je,Ot,Tt,Ie,Fr;class Un{constructor(){En.add(this),this.controller=new AbortController,_t.set(this,void 0),bt.set(this,()=>{}),ze.set(this,()=>{}),Xe.set(this,void 0),wt.set(this,()=>{}),Ke.set(this,()=>{}),ce.set(this,{}),Je.set(this,!1),Ot.set(this,!1),Tt.set(this,!1),Ie.set(this,!1),P(this,_t,new Promise((e,t)=>{P(this,bt,e,"f"),P(this,ze,t,"f")})),P(this,Xe,new Promise((e,t)=>{P(this,wt,e,"f"),P(this,Ke,t,"f")})),p(this,_t,"f").catch(()=>{}),p(this,Xe,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},p(this,En,"m",Fr).bind(this))},0)}_connected(){this.ended||(p(this,bt,"f").call(this),this._emit("connect"))}get ended(){return p(this,Je,"f")}get errored(){return p(this,Ot,"f")}get aborted(){return p(this,Tt,"f")}abort(){this.controller.abort()}on(e,t){return(p(this,ce,"f")[e]||(p(this,ce,"f")[e]=[])).push({listener:t}),this}off(e,t){const s=p(this,ce,"f")[e];if(!s)return this;const r=s.findIndex(a=>a.listener===t);return r>=0&&s.splice(r,1),this}once(e,t){return(p(this,ce,"f")[e]||(p(this,ce,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{P(this,Ie,!0),e!=="error"&&this.once("error",s),this.once(e,t)})}async done(){P(this,Ie,!0),await p(this,Xe,"f")}_emit(e,...t){if(p(this,Je,"f"))return;e==="end"&&(P(this,Je,!0),p(this,wt,"f").call(this));const s=p(this,ce,"f")[e];if(s&&(p(this,ce,"f")[e]=s.filter(r=>!r.once),s.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!p(this,Ie,"f")&&!s?.length&&Promise.reject(r),p(this,ze,"f").call(this,r),p(this,Ke,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!p(this,Ie,"f")&&!s?.length&&Promise.reject(r),p(this,ze,"f").call(this,r),p(this,Ke,"f").call(this,r),this._emit("end")}}_emitFinal(){}}_t=new WeakMap,bt=new WeakMap,ze=new WeakMap,Xe=new WeakMap,wt=new WeakMap,Ke=new WeakMap,ce=new WeakMap,Je=new WeakMap,Ot=new WeakMap,Tt=new WeakMap,Ie=new WeakMap,En=new WeakSet,Fr=function(e){if(P(this,Ot,!0),e instanceof Error&&e.name==="AbortError"&&(e=new Y),e instanceof Y)return P(this,Tt,!0),this._emit("abort",e);if(e instanceof E)return this._emit("error",e);if(e instanceof Error){const t=new E(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new E(String(e)))};function Tl(n){return typeof n.parse=="function"}var H,Rn,kt,Pn,Nn,In,Br,Wr;const kl=10;class Ur extends Un{constructor(){super(...arguments),H.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),Lr(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(It(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new E("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),p(this,H,"m",Rn).call(this)}async finalMessage(){return await this.done(),p(this,H,"m",kt).call(this)}async finalFunctionToolCall(){return await this.done(),p(this,H,"m",Pn).call(this)}async finalFunctionToolCallResult(){return await this.done(),p(this,H,"m",Nn).call(this)}async totalUsage(){return await this.done(),p(this,H,"m",In).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=p(this,H,"m",kt).call(this);t&&this._emit("finalMessage",t);const s=p(this,H,"m",Rn).call(this);s&&this._emit("finalContent",s);const r=p(this,H,"m",Pn).call(this);r&&this._emit("finalFunctionToolCall",r);const a=p(this,H,"m",Nn).call(this);a!=null&&this._emit("finalFunctionToolCallResult",a),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",p(this,H,"m",In).call(this))}async _createChatCompletion(e,t,s){const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),p(this,H,"m",Br).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Wn(a,t))}async _runChatCompletion(e,t,s){for(const r of t.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,t,s)}async _runTools(e,t,s){const r="tool",{tool_choice:a="auto",stream:o,...i}=t,c=typeof a!="string"&&a.type==="function"&&a?.function?.name,{maxChatCompletions:d=kl}=s||{},m=t.tools.map(f=>{if(st(f)){if(!f.$callback)throw new E("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:f.$callback,name:f.function.name,description:f.function.description||"",parameters:f.function.parameters,parse:f.$parseRaw,strict:!0}}}return f}),u={};for(const f of m)f.type==="function"&&(u[f.function.name||f.function.function.name]=f.function);const g="tools"in t?m.map(f=>f.type==="function"?{type:"function",function:{name:f.function.name||f.function.function.name,parameters:f.function.parameters,description:f.function.description,strict:f.function.strict}}:f):void 0;for(const f of t.messages)this._addMessage(f,!1);for(let f=0;f<d;++f){const _=(await this._createChatCompletion(e,{...i,tool_choice:a,tools:g,messages:[...this.messages]},s)).choices[0]?.message;if(!_)throw new E("missing message in ChatCompletion response");if(!_.tool_calls?.length)return;for(const C of _.tool_calls){if(C.type!=="function")continue;const x=C.id,{name:b,arguments:y}=C.function,R=u[b];if(R){if(c&&c!==b){const D=`Invalid tool_call: ${JSON.stringify(b)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:r,tool_call_id:x,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(b)}. Available options are: ${Object.keys(u).map(N=>JSON.stringify(N)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:x,content:D});continue}let O;try{O=Tl(R)?await R.parse(y):y}catch(D){const N=D instanceof Error?D.message:String(D);this._addMessage({role:r,tool_call_id:x,content:N});continue}const k=await R.function(O,this),T=p(this,H,"m",Wr).call(this,k);if(this._addMessage({role:r,tool_call_id:x,content:T}),c)return}}}}H=new WeakSet,Rn=function(){return p(this,H,"m",kt).call(this).content??null},kt=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(It(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new E("stream ended without producing a ChatCompletionMessage with role=assistant")},Pn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(It(t)&&t?.tool_calls?.length)return t.tool_calls.filter(s=>s.type==="function").at(-1)?.function}},Nn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Lr(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(r=>r.type==="function"&&r.id===t.tool_call_id)))return t.content}},In=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Br=function(e){if(e.n!=null&&e.n>1)throw new E("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Wr=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class qn extends Ur{static runTools(e,t,s){const r=new qn,a={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}_addMessage(e,t=!0){super._addMessage(e,t),It(e)&&e.content&&this._emit("content",e.content)}}const qr=1,Hr=2,Vr=4,zr=8,Xr=16,Kr=32,Jr=64,Yr=128,Gr=256,Qr=Yr|Gr,Zr=Xr|Kr|Qr|Jr,ea=qr|Hr|Zr,ta=Vr|zr,$l=ea|ta,B={STR:qr,NUM:Hr,ARR:Vr,OBJ:zr,NULL:Xr,BOOL:Kr,NAN:Jr,INFINITY:Yr,MINUS_INFINITY:Gr,INF:Qr,SPECIAL:Zr,ATOM:ea,COLLECTION:ta,ALL:$l};class Dl extends Error{}class jl extends Error{}function Ml(n,e=B.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return Ll(n.trim(),e)}const Ll=(n,e)=>{const t=n.length;let s=0;const r=g=>{throw new Dl(`${g} at position ${s}`)},a=g=>{throw new jl(`${g} at position ${s}`)},o=()=>(u(),s>=t&&r("Unexpected end of input"),n[s]==='"'?i():n[s]==="{"?c():n[s]==="["?d():n.substring(s,s+4)==="null"||B.NULL&e&&t-s<4&&"null".startsWith(n.substring(s))?(s+=4,null):n.substring(s,s+4)==="true"||B.BOOL&e&&t-s<4&&"true".startsWith(n.substring(s))?(s+=4,!0):n.substring(s,s+5)==="false"||B.BOOL&e&&t-s<5&&"false".startsWith(n.substring(s))?(s+=5,!1):n.substring(s,s+8)==="Infinity"||B.INFINITY&e&&t-s<8&&"Infinity".startsWith(n.substring(s))?(s+=8,1/0):n.substring(s,s+9)==="-Infinity"||B.MINUS_INFINITY&e&&1<t-s&&t-s<9&&"-Infinity".startsWith(n.substring(s))?(s+=9,-1/0):n.substring(s,s+3)==="NaN"||B.NAN&e&&t-s<3&&"NaN".startsWith(n.substring(s))?(s+=3,NaN):m()),i=()=>{const g=s;let f=!1;for(s++;s<t&&(n[s]!=='"'||f&&n[s-1]==="\\");)f=n[s]==="\\"?!f:!1,s++;if(n.charAt(s)=='"')try{return JSON.parse(n.substring(g,++s-Number(f)))}catch(v){a(String(v))}else if(B.STR&e)try{return JSON.parse(n.substring(g,s-Number(f))+'"')}catch{return JSON.parse(n.substring(g,n.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},c=()=>{s++,u();const g={};try{for(;n[s]!=="}";){if(u(),s>=t&&B.OBJ&e)return g;const f=i();u(),s++;try{const v=o();Object.defineProperty(g,f,{value:v,writable:!0,enumerable:!0,configurable:!0})}catch(v){if(B.OBJ&e)return g;throw v}u(),n[s]===","&&s++}}catch{if(B.OBJ&e)return g;r("Expected '}' at end of object")}return s++,g},d=()=>{s++;const g=[];try{for(;n[s]!=="]";)g.push(o()),u(),n[s]===","&&s++}catch{if(B.ARR&e)return g;r("Expected ']' at end of array")}return s++,g},m=()=>{if(s===0){n==="-"&&B.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(n)}catch(f){if(B.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}a(String(f))}}const g=s;for(n[s]==="-"&&s++;n[s]&&!",]}".includes(n[s]);)s++;s==t&&!(B.NUM&e)&&r("Unterminated number literal");try{return JSON.parse(n.substring(g,s))}catch{n.substring(g,s)==="-"&&B.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(n.substring(g,n.lastIndexOf("e")))}catch(v){a(String(v))}}},u=()=>{for(;s<t&&` 
\r	`.includes(n[s]);)s++};return o()},Ds=n=>Ml(n,B.ALL^B.NUM);var L,le,Se,he,an,it,on,ln,cn,lt,un,js;class tt extends Ur{constructor(e){super(),L.add(this),le.set(this,void 0),Se.set(this,void 0),he.set(this,void 0),P(this,le,e),P(this,Se,[])}get currentChatCompletionSnapshot(){return p(this,he,"f")}static fromReadableStream(e){const t=new tt(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,s){const r=new tt(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,s){super._createChatCompletion;const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),p(this,L,"m",an).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const o of a)p(this,L,"m",on).call(this,o);if(a.controller.signal?.aborted)throw new Y;return this._addChatCompletion(p(this,L,"m",lt).call(this))}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),p(this,L,"m",an).call(this),this._connected();const r=ae.fromReadableStream(e,this.controller);let a;for await(const o of r)a&&a!==o.id&&this._addChatCompletion(p(this,L,"m",lt).call(this)),p(this,L,"m",on).call(this,o),a=o.id;if(r.controller.signal?.aborted)throw new Y;return this._addChatCompletion(p(this,L,"m",lt).call(this))}[(le=new WeakMap,Se=new WeakMap,he=new WeakMap,L=new WeakSet,an=function(){this.ended||P(this,he,void 0)},it=function(t){let s=p(this,Se,"f")[t.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},p(this,Se,"f")[t.index]=s,s)},on=function(t){if(this.ended)return;const s=p(this,L,"m",js).call(this,t);this._emit("chunk",t,s);for(const r of t.choices){const a=s.choices[r.index];r.delta.content!=null&&a.message?.role==="assistant"&&a.message?.content&&(this._emit("content",r.delta.content,a.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:a.message.content,parsed:a.message.parsed})),r.delta.refusal!=null&&a.message?.role==="assistant"&&a.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:a.message.refusal}),r.logprobs?.content!=null&&a.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:a.logprobs?.content??[]}),r.logprobs?.refusal!=null&&a.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:a.logprobs?.refusal??[]});const o=p(this,L,"m",it).call(this,a);a.finish_reason&&(p(this,L,"m",cn).call(this,a),o.current_tool_call_index!=null&&p(this,L,"m",ln).call(this,a,o.current_tool_call_index));for(const i of r.delta.tool_calls??[])o.current_tool_call_index!==i.index&&(p(this,L,"m",cn).call(this,a),o.current_tool_call_index!=null&&p(this,L,"m",ln).call(this,a,o.current_tool_call_index)),o.current_tool_call_index=i.index;for(const i of r.delta.tool_calls??[]){const c=a.message.tool_calls?.[i.index];c?.type&&(c?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:c.function?.name,index:i.index,arguments:c.function.arguments,parsed_arguments:c.function.parsed_arguments,arguments_delta:i.function?.arguments??""}):(c?.type,void 0))}}},ln=function(t,s){if(p(this,L,"m",it).call(this,t).done_tool_calls.has(s))return;const a=t.message.tool_calls?.[s];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const o=p(this,le,"f")?.tools?.find(i=>Nt(i)&&i.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:s,arguments:a.function.arguments,parsed_arguments:st(o)?o.$parseRaw(a.function.arguments):o?.function.strict?JSON.parse(a.function.arguments):null})}else a.type},cn=function(t){const s=p(this,L,"m",it).call(this,t);if(t.message.content&&!s.content_done){s.content_done=!0;const r=p(this,L,"m",un).call(this);this._emit("content.done",{content:t.message.content,parsed:r?r.$parseRaw(t.message.content):null})}t.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},lt=function(){if(this.ended)throw new E("stream has ended, this shouldn't happen");const t=p(this,he,"f");if(!t)throw new E("request ended without sending any chunks");return P(this,he,void 0),P(this,Se,[]),Fl(t,p(this,le,"f"))},un=function(){const t=p(this,le,"f")?.response_format;return Bn(t)?t:null},js=function(t){var s,r,a,o;let i=p(this,he,"f");const{choices:c,...d}=t;i?Object.assign(i,d):i=P(this,he,{...d,choices:[]});for(const{delta:m,finish_reason:u,index:g,logprobs:f=null,...v}of t.choices){let _=i.choices[g];if(_||(_=i.choices[g]={finish_reason:u,index:g,message:{},logprobs:f,...v}),f)if(!_.logprobs)_.logprobs=Object.assign({},f);else{const{content:k,refusal:T,...D}=f;Object.assign(_.logprobs,D),k&&((s=_.logprobs).content??(s.content=[]),_.logprobs.content.push(...k)),T&&((r=_.logprobs).refusal??(r.refusal=[]),_.logprobs.refusal.push(...T))}if(u&&(_.finish_reason=u,p(this,le,"f")&&jr(p(this,le,"f")))){if(u==="length")throw new _r;if(u==="content_filter")throw new br}if(Object.assign(_,v),!m)continue;const{content:C,refusal:x,function_call:b,role:y,tool_calls:R,...O}=m;if(Object.assign(_.message,O),x&&(_.message.refusal=(_.message.refusal||"")+x),y&&(_.message.role=y),b&&(_.message.function_call?(b.name&&(_.message.function_call.name=b.name),b.arguments&&((a=_.message.function_call).arguments??(a.arguments=""),_.message.function_call.arguments+=b.arguments)):_.message.function_call=b),C&&(_.message.content=(_.message.content||"")+C,!_.message.refusal&&p(this,L,"m",un).call(this)&&(_.message.parsed=Ds(_.message.content))),R){_.message.tool_calls||(_.message.tool_calls=[]);for(const{index:k,id:T,type:D,function:N,...$}of R){const j=(o=_.message.tool_calls)[k]??(o[k]={});Object.assign(j,$),T&&(j.id=T),D&&(j.type=D),N&&(j.function??(j.function={name:N.name??"",arguments:""})),N?.name&&(j.function.name=N.name),N?.arguments&&(j.function.arguments+=N.arguments,Il(p(this,le,"f"),j)&&(j.function.parsed_arguments=Ds(j.function.arguments)))}}}return i},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("chunk",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{s=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{s=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{s=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ae(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Fl(n,e){const{id:t,choices:s,created:r,model:a,system_fingerprint:o,...i}=n,c={...i,id:t,choices:s.map(({message:d,finish_reason:m,index:u,logprobs:g,...f})=>{if(!m)throw new E(`missing finish_reason for choice ${u}`);const{content:v=null,function_call:_,tool_calls:C,...x}=d,b=d.role;if(!b)throw new E(`missing role for choice ${u}`);if(_){const{arguments:y,name:R}=_;if(y==null)throw new E(`missing function_call.arguments for choice ${u}`);if(!R)throw new E(`missing function_call.name for choice ${u}`);return{...f,message:{content:v,function_call:{arguments:y,name:R},role:b,refusal:d.refusal??null},finish_reason:m,index:u,logprobs:g}}return C?{...f,index:u,finish_reason:m,logprobs:g,message:{...x,role:b,content:v,refusal:d.refusal??null,tool_calls:C.map((y,R)=>{const{function:O,type:k,id:T,...D}=y,{arguments:N,name:$,...j}=O||{};if(T==null)throw new E(`missing choices[${u}].tool_calls[${R}].id
${ct(n)}`);if(k==null)throw new E(`missing choices[${u}].tool_calls[${R}].type
${ct(n)}`);if($==null)throw new E(`missing choices[${u}].tool_calls[${R}].function.name
${ct(n)}`);if(N==null)throw new E(`missing choices[${u}].tool_calls[${R}].function.arguments
${ct(n)}`);return{...D,id:T,type:k,function:{...j,name:$,arguments:N}}})}}:{...f,message:{...x,content:v,role:b,refusal:d.refusal??null},finish_reason:m,index:u,logprobs:g}}),created:r,model:a,object:"chat.completion",...o?{system_fingerprint:o}:{}};return Rl(c,e)}function ct(n){return JSON.stringify(n)}class $t extends tt{static fromReadableStream(e){const t=new $t(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,s){const r=new $t(t),a={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}}let Hn=class extends A{constructor(){super(...arguments),this.messages=new Dr(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(w`/chat/completions/${e}`,t)}update(e,t,s){return this._client.post(w`/chat/completions/${e}`,{body:t,...s})}list(e={},t){return this._client.getAPIList("/chat/completions",M,{query:e,...t})}delete(e,t){return this._client.delete(w`/chat/completions/${e}`,t)}parse(e,t){return Ol(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(s=>Wn(s,e))}runTools(e,t){return e.stream?$t.runTools(this._client,e,t):qn.runTools(this._client,e,t)}stream(e,t){return tt.createChatCompletion(this._client,e,t)}};Hn.Messages=Dr;class Vn extends A{constructor(){super(...arguments),this.completions=new Hn(this._client)}}Vn.Completions=Hn;const na=Symbol("brand.privateNullableHeaders");function*Bl(n){if(!n)return;if(na in n){const{values:s,nulls:r}=n;yield*s.entries();for(const a of r)yield[a,null];return}let e=!1,t;n instanceof Headers?t=n.entries():vs(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let s of t){const r=s[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const a=vs(s[1])?s[1]:[s[1]];let o=!1;for(const i of a)i!==void 0&&(e&&!o&&(o=!0,yield[r,null]),yield[r,i])}}const S=n=>{const e=new Headers,t=new Set;for(const s of n){const r=new Set;for(const[a,o]of Bl(s)){const i=a.toLowerCase();r.has(i)||(e.delete(a),r.add(i)),o===null?(e.delete(a),t.add(i)):(e.append(a,o),t.delete(i))}}return{[na]:!0,values:e,nulls:t}};class sa extends A{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:S([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0})}}class ra extends A{create(e,t){return this._client.post("/audio/transcriptions",ye({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class aa extends A{create(e,t){return this._client.post("/audio/translations",ye({body:e,...t,__metadata:{model:e.model}},this._client))}}class rt extends A{constructor(){super(...arguments),this.transcriptions=new ra(this._client),this.translations=new aa(this._client),this.speech=new sa(this._client)}}rt.Transcriptions=ra;rt.Translations=aa;rt.Speech=sa;class oa extends A{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(w`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",M,{query:e,...t})}cancel(e,t){return this._client.post(w`/batches/${e}/cancel`,t)}}class ia extends A{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(w`/assistants/${e}`,{...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,s){return this._client.post(w`/assistants/${e}`,{body:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},t){return this._client.getAPIList("/assistants",M,{query:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(w`/assistants/${e}`,{...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}let la=class extends A{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}};class ca extends A{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}let qt=class extends A{constructor(){super(...arguments),this.sessions=new la(this._client),this.transcriptionSessions=new ca(this._client)}};qt.Sessions=la;qt.TranscriptionSessions=ca;class ua extends A{create(e,t){return this._client.post("/chatkit/sessions",{body:e,...t,headers:S([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}cancel(e,t){return this._client.post(w`/chatkit/sessions/${e}/cancel`,{...t,headers:S([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}}let da=class extends A{retrieve(e,t){return this._client.get(w`/chatkit/threads/${e}`,{...t,headers:S([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}list(e={},t){return this._client.getAPIList("/chatkit/threads",Pt,{query:e,...t,headers:S([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}delete(e,t){return this._client.delete(w`/chatkit/threads/${e}`,{...t,headers:S([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}listItems(e,t={},s){return this._client.getAPIList(w`/chatkit/threads/${e}/items`,Pt,{query:t,...s,headers:S([{"OpenAI-Beta":"chatkit_beta=v1"},s?.headers])})}};class Ht extends A{constructor(){super(...arguments),this.sessions=new ua(this._client),this.threads=new da(this._client)}uploadFile(e,t){return this._client.post("/chatkit/files",xn({body:e,...t,headers:S([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])},this._client))}}Ht.Sessions=ua;Ht.Threads=da;class fa extends A{create(e,t,s){return this._client.post(w`/threads/${e}/messages`,{body:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,t,s){const{thread_id:r}=t;return this._client.get(w`/threads/${r}/messages/${e}`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,t,s){const{thread_id:r,...a}=t;return this._client.post(w`/threads/${r}/messages/${e}`,{body:a,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t={},s){return this._client.getAPIList(w`/threads/${e}/messages`,M,{query:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,t,s){const{thread_id:r}=t;return this._client.delete(w`/threads/${r}/messages/${e}`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class ha extends A{retrieve(e,t,s){const{thread_id:r,run_id:a,...o}=t;return this._client.get(w`/threads/${r}/runs/${a}/steps/${e}`,{query:o,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t,s){const{thread_id:r,...a}=t;return this._client.getAPIList(w`/threads/${r}/runs/${e}/steps`,M,{query:a,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}const Wl=n=>{if(typeof Buffer<"u"){const e=Buffer.from(n,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(n),t=e.length,s=new Uint8Array(t);for(let r=0;r<t;r++)s[r]=e.charCodeAt(r);return Array.from(new Float32Array(s.buffer))}};var Ul={};const Ce=n=>{if(typeof globalThis.process<"u")return Ul?.[n]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(n)?.trim()};var U,be,On,se,yt,Z,we,Te,_e,Dt,K,vt,xt,Ze,Ye,Ge,Ms,Ls,Fs,Bs,Ws,Us,qs;class et extends Un{constructor(){super(...arguments),U.add(this),On.set(this,[]),se.set(this,{}),yt.set(this,{}),Z.set(this,void 0),we.set(this,void 0),Te.set(this,void 0),_e.set(this,void 0),Dt.set(this,void 0),K.set(this,void 0),vt.set(this,void 0),xt.set(this,void 0),Ze.set(this,void 0)}[(On=new WeakMap,se=new WeakMap,yt=new WeakMap,Z=new WeakMap,we=new WeakMap,Te=new WeakMap,_e=new WeakMap,Dt=new WeakMap,K=new WeakMap,vt=new WeakMap,xt=new WeakMap,Ze=new WeakMap,U=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{s=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{s=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{s=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new be;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=ae.fromReadableStream(e,this.controller);for await(const a of r)p(this,U,"m",Ye).call(this,a);if(r.controller.signal?.aborted)throw new Y;return this._addRun(p(this,U,"m",Ge).call(this))}toReadableStream(){return new ae(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,s,r){const a=new be;return a._run(()=>a._runToolAssistantStream(e,t,s,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,s,r){const a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},i=await e.submitToolOutputs(t,o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)p(this,U,"m",Ye).call(this,c);if(i.controller.signal?.aborted)throw new Y;return this._addRun(p(this,U,"m",Ge).call(this))}static createThreadAssistantStream(e,t,s){const r=new be;return r._run(()=>r._threadAssistantStream(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,s,r){const a=new be;return a._run(()=>a._runAssistantStream(e,t,s,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return p(this,vt,"f")}currentRun(){return p(this,xt,"f")}currentMessageSnapshot(){return p(this,Z,"f")}currentRunStepSnapshot(){return p(this,Ze,"f")}async finalRunSteps(){return await this.done(),Object.values(p(this,se,"f"))}async finalMessages(){return await this.done(),Object.values(p(this,yt,"f"))}async finalRun(){if(await this.done(),!p(this,we,"f"))throw Error("Final run was not received.");return p(this,we,"f")}async _createThreadAssistantStream(e,t,s){const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},o=await e.createAndRun(a,{...s,signal:this.controller.signal});this._connected();for await(const i of o)p(this,U,"m",Ye).call(this,i);if(o.controller.signal?.aborted)throw new Y;return this._addRun(p(this,U,"m",Ge).call(this))}async _createAssistantStream(e,t,s,r){const a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},i=await e.create(t,o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)p(this,U,"m",Ye).call(this,c);if(i.controller.signal?.aborted)throw new Y;return this._addRun(p(this,U,"m",Ge).call(this))}static accumulateDelta(e,t){for(const[s,r]of Object.entries(t)){if(!e.hasOwnProperty(s)){e[s]=r;continue}let a=e[s];if(a==null){e[s]=r;continue}if(s==="index"||s==="type"){e[s]=r;continue}if(typeof a=="string"&&typeof r=="string")a+=r;else if(typeof a=="number"&&typeof r=="number")a+=r;else if(nn(a)&&nn(r))a=this.accumulateDelta(a,r);else if(Array.isArray(a)&&Array.isArray(r)){if(a.every(o=>typeof o=="string"||typeof o=="number")){a.push(...r);continue}for(const o of r){if(!nn(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const i=o.index;if(i==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof i!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${i}`);const c=a[i];c==null?a.push(o):a[i]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${r}, accValue: ${a}`);e[s]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,s){return await this._createThreadAssistantStream(t,e,s)}async _runAssistantStream(e,t,s,r){return await this._createAssistantStream(t,e,s,r)}async _runToolAssistantStream(e,t,s,r){return await this._createToolAssistantStream(t,e,s,r)}}be=et,Ye=function(e){if(!this.ended)switch(P(this,vt,e),p(this,U,"m",Fs).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":p(this,U,"m",qs).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":p(this,U,"m",Ls).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":p(this,U,"m",Ms).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Ge=function(){if(this.ended)throw new E("stream has ended, this shouldn't happen");if(!p(this,we,"f"))throw Error("Final run has not been received");return p(this,we,"f")},Ms=function(e){const[t,s]=p(this,U,"m",Ws).call(this,e,p(this,Z,"f"));P(this,Z,t),p(this,yt,"f")[t.id]=t;for(const r of s){const a=t.content[r.index];a?.type=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=p(this,Te,"f")){if(p(this,_e,"f"))switch(p(this,_e,"f").type){case"text":this._emit("textDone",p(this,_e,"f").text,p(this,Z,"f"));break;case"image_file":this._emit("imageFileDone",p(this,_e,"f").image_file,p(this,Z,"f"));break}P(this,Te,r.index)}P(this,_e,t.content[r.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(p(this,Te,"f")!==void 0){const r=e.data.content[p(this,Te,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,p(this,Z,"f"));break;case"text":this._emit("textDone",r.text,p(this,Z,"f"));break}}p(this,Z,"f")&&this._emit("messageDone",e.data),P(this,Z,void 0)}},Ls=function(e){const t=p(this,U,"m",Bs).call(this,e);switch(P(this,Ze,t),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of s.step_details.tool_calls)a.index==p(this,Dt,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(p(this,K,"f")&&this._emit("toolCallDone",p(this,K,"f")),P(this,Dt,a.index),P(this,K,t.step_details.tool_calls[a.index]),p(this,K,"f")&&this._emit("toolCallCreated",p(this,K,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":P(this,Ze,void 0),e.data.step_details.type=="tool_calls"&&p(this,K,"f")&&(this._emit("toolCallDone",p(this,K,"f")),P(this,K,void 0)),this._emit("runStepDone",e.data,t);break}},Fs=function(e){p(this,On,"f").push(e),this._emit("event",e)},Bs=function(e){switch(e.event){case"thread.run.step.created":return p(this,se,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=p(this,se,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const r=be.accumulateDelta(t,s.delta);p(this,se,"f")[e.data.id]=r}return p(this,se,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":p(this,se,"f")[e.data.id]=e.data;break}if(p(this,se,"f")[e.data.id])return p(this,se,"f")[e.data.id];throw new Error("No snapshot available")},Ws=function(e,t){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=p(this,U,"m",Us).call(this,a,o)}else t.content[a.index]=a,s.push(a);return[t,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Us=function(e,t){return be.accumulateDelta(t,e)},qs=function(e){switch(P(this,xt,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":P(this,we,e.data),p(this,K,"f")&&(this._emit("toolCallDone",p(this,K,"f")),P(this,K,void 0));break}};let zn=class extends A{constructor(){super(...arguments),this.steps=new ha(this._client)}create(e,t,s){const{include:r,...a}=t;return this._client.post(w`/threads/${e}/runs`,{query:{include:r},body:a,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:t.stream??!1})}retrieve(e,t,s){const{thread_id:r}=t;return this._client.get(w`/threads/${r}/runs/${e}`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,t,s){const{thread_id:r,...a}=t;return this._client.post(w`/threads/${r}/runs/${e}`,{body:a,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t={},s){return this._client.getAPIList(w`/threads/${e}/runs`,M,{query:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,t,s){const{thread_id:r}=t;return this._client.post(w`/threads/${r}/runs/${e}/cancel`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,t,s){const r=await this.create(e,t,s);return await this.poll(r.id,{thread_id:e},s)}createAndStream(e,t,s){return et.createAssistantStream(e,this._client.beta.threads.runs,t,s)}async poll(e,t,s){const r=S([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:a,response:o}=await this.retrieve(e,t,{...s,headers:{...s?.headers,...r}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let i=5e3;if(s?.pollIntervalMs)i=s.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const d=parseInt(c);isNaN(d)||(i=d)}}await nt(i);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,s){return et.createAssistantStream(e,this._client.beta.threads.runs,t,s)}submitToolOutputs(e,t,s){const{thread_id:r,...a}=t;return this._client.post(w`/threads/${r}/runs/${e}/submit_tool_outputs`,{body:a,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,s){const r=await this.submitToolOutputs(e,t,s);return await this.poll(r.id,t,s)}submitToolOutputsStream(e,t,s){return et.createToolAssistantStream(e,this._client.beta.threads.runs,t,s)}};zn.Steps=ha;class Vt extends A{constructor(){super(...arguments),this.runs=new zn(this._client),this.messages=new fa(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(w`/threads/${e}`,{...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,s){return this._client.post(w`/threads/${e}`,{body:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,t){return this._client.delete(w`/threads/${e}`,{...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){const s=await this.createAndRun(e,t);return await this.runs.poll(s.id,{thread_id:s.thread_id},t)}createAndRunStream(e,t){return et.createThreadAssistantStream(e,this._client.beta.threads,t)}}Vt.Runs=zn;Vt.Messages=fa;class je extends A{constructor(){super(...arguments),this.realtime=new qt(this._client),this.chatkit=new Ht(this._client),this.assistants=new ia(this._client),this.threads=new Vt(this._client)}}je.Realtime=qt;je.ChatKit=Ht;je.Assistants=ia;je.Threads=Vt;class pa extends A{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}let ma=class extends A{retrieve(e,t,s){const{container_id:r}=t;return this._client.get(w`/containers/${r}/files/${e}/content`,{...s,headers:S([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}},Xn=class extends A{constructor(){super(...arguments),this.content=new ma(this._client)}create(e,t,s){return this._client.post(w`/containers/${e}/files`,ye({body:t,...s},this._client))}retrieve(e,t,s){const{container_id:r}=t;return this._client.get(w`/containers/${r}/files/${e}`,s)}list(e,t={},s){return this._client.getAPIList(w`/containers/${e}/files`,M,{query:t,...s})}delete(e,t,s){const{container_id:r}=t;return this._client.delete(w`/containers/${r}/files/${e}`,{...s,headers:S([{Accept:"*/*"},s?.headers])})}};Xn.Content=ma;class Kn extends A{constructor(){super(...arguments),this.files=new Xn(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(w`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",M,{query:e,...t})}delete(e,t){return this._client.delete(w`/containers/${e}`,{...t,headers:S([{Accept:"*/*"},t?.headers])})}}Kn.Files=Xn;class ga extends A{create(e,t,s){const{include:r,...a}=t;return this._client.post(w`/conversations/${e}/items`,{query:{include:r},body:a,...s})}retrieve(e,t,s){const{conversation_id:r,...a}=t;return this._client.get(w`/conversations/${r}/items/${e}`,{query:a,...s})}list(e,t={},s){return this._client.getAPIList(w`/conversations/${e}/items`,Pt,{query:t,...s})}delete(e,t,s){const{conversation_id:r}=t;return this._client.delete(w`/conversations/${r}/items/${e}`,s)}}class Jn extends A{constructor(){super(...arguments),this.items=new ga(this._client)}create(e={},t){return this._client.post("/conversations",{body:e,...t})}retrieve(e,t){return this._client.get(w`/conversations/${e}`,t)}update(e,t,s){return this._client.post(w`/conversations/${e}`,{body:t,...s})}delete(e,t){return this._client.delete(w`/conversations/${e}`,t)}}Jn.Items=ga;class _a extends A{create(e,t){const s=!!e.encoding_format;let r=s?e.encoding_format:"base64";s&&W(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return s?a:(W(this._client).debug("embeddings/decoding base64 embeddings from base64"),a._thenUnwrap(o=>(o&&o.data&&o.data.forEach(i=>{const c=i.embedding;i.embedding=Wl(c)}),o)))}}class ba extends A{retrieve(e,t,s){const{eval_id:r,run_id:a}=t;return this._client.get(w`/evals/${r}/runs/${a}/output_items/${e}`,s)}list(e,t,s){const{eval_id:r,...a}=t;return this._client.getAPIList(w`/evals/${r}/runs/${e}/output_items`,M,{query:a,...s})}}class Yn extends A{constructor(){super(...arguments),this.outputItems=new ba(this._client)}create(e,t,s){return this._client.post(w`/evals/${e}/runs`,{body:t,...s})}retrieve(e,t,s){const{eval_id:r}=t;return this._client.get(w`/evals/${r}/runs/${e}`,s)}list(e,t={},s){return this._client.getAPIList(w`/evals/${e}/runs`,M,{query:t,...s})}delete(e,t,s){const{eval_id:r}=t;return this._client.delete(w`/evals/${r}/runs/${e}`,s)}cancel(e,t,s){const{eval_id:r}=t;return this._client.post(w`/evals/${r}/runs/${e}`,s)}}Yn.OutputItems=ba;class Gn extends A{constructor(){super(...arguments),this.runs=new Yn(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(w`/evals/${e}`,t)}update(e,t,s){return this._client.post(w`/evals/${e}`,{body:t,...s})}list(e={},t){return this._client.getAPIList("/evals",M,{query:e,...t})}delete(e,t){return this._client.delete(w`/evals/${e}`,t)}}Gn.Runs=Yn;let wa=class extends A{create(e,t){return this._client.post("/files",ye({body:e,...t},this._client))}retrieve(e,t){return this._client.get(w`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",M,{query:e,...t})}delete(e,t){return this._client.delete(w`/files/${e}`,t)}content(e,t){return this._client.get(w`/files/${e}/content`,{...t,headers:S([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:s=30*60*1e3}={}){const r=new Set(["processed","error","deleted"]),a=Date.now();let o=await this.retrieve(e);for(;!o.status||!r.has(o.status);)if(await nt(t),o=await this.retrieve(e),Date.now()-a>s)throw new jn({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return o}};class ya extends A{}let va=class extends A{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class Qn extends A{constructor(){super(...arguments),this.graders=new va(this._client)}}Qn.Graders=va;class xa extends A{create(e,t,s){return this._client.getAPIList(w`/fine_tuning/checkpoints/${e}/permissions`,Ut,{body:t,method:"post",...s})}retrieve(e,t={},s){return this._client.get(w`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...s})}delete(e,t,s){const{fine_tuned_model_checkpoint:r}=t;return this._client.delete(w`/fine_tuning/checkpoints/${r}/permissions/${e}`,s)}}let Zn=class extends A{constructor(){super(...arguments),this.permissions=new xa(this._client)}};Zn.Permissions=xa;class Sa extends A{list(e,t={},s){return this._client.getAPIList(w`/fine_tuning/jobs/${e}/checkpoints`,M,{query:t,...s})}}class es extends A{constructor(){super(...arguments),this.checkpoints=new Sa(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(w`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",M,{query:e,...t})}cancel(e,t){return this._client.post(w`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},s){return this._client.getAPIList(w`/fine_tuning/jobs/${e}/events`,M,{query:t,...s})}pause(e,t){return this._client.post(w`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(w`/fine_tuning/jobs/${e}/resume`,t)}}es.Checkpoints=Sa;class Me extends A{constructor(){super(...arguments),this.methods=new ya(this._client),this.jobs=new es(this._client),this.checkpoints=new Zn(this._client),this.alpha=new Qn(this._client)}}Me.Methods=ya;Me.Jobs=es;Me.Checkpoints=Zn;Me.Alpha=Qn;class Ca extends A{}class ts extends A{constructor(){super(...arguments),this.graderModels=new Ca(this._client)}}ts.GraderModels=Ca;class Aa extends A{createVariation(e,t){return this._client.post("/images/variations",ye({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",ye({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}}class Ea extends A{retrieve(e,t){return this._client.get(w`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Ut,e)}delete(e,t){return this._client.delete(w`/models/${e}`,t)}}class Ra extends A{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class Pa extends A{accept(e,t,s){return this._client.post(w`/realtime/calls/${e}/accept`,{body:t,...s,headers:S([{Accept:"*/*"},s?.headers])})}hangup(e,t){return this._client.post(w`/realtime/calls/${e}/hangup`,{...t,headers:S([{Accept:"*/*"},t?.headers])})}refer(e,t,s){return this._client.post(w`/realtime/calls/${e}/refer`,{body:t,...s,headers:S([{Accept:"*/*"},s?.headers])})}reject(e,t={},s){return this._client.post(w`/realtime/calls/${e}/reject`,{body:t,...s,headers:S([{Accept:"*/*"},s?.headers])})}}class Na extends A{create(e,t){return this._client.post("/realtime/client_secrets",{body:e,...t})}}class zt extends A{constructor(){super(...arguments),this.clientSecrets=new Na(this._client),this.calls=new Pa(this._client)}}zt.ClientSecrets=Na;zt.Calls=Pa;function ql(n,e){return!e||!Vl(e)?{...n,output_parsed:null,output:n.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(s=>({...s,parsed:null}))}:t)}:Ia(n,e)}function Ia(n,e){const t=n.output.map(r=>{if(r.type==="function_call")return{...r,parsed_arguments:Kl(e,r)};if(r.type==="message"){const a=r.content.map(o=>o.type==="output_text"?{...o,parsed:Hl(e,o.text)}:o);return{...r,content:a}}return r}),s=Object.assign({},n,{output:t});return Object.getOwnPropertyDescriptor(n,"output_text")||Tn(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const r of s.output)if(r.type==="message"){for(const a of r.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),s}function Hl(n,e){return n.text?.format?.type!=="json_schema"?null:"$parseRaw"in n.text?.format?(n.text?.format).$parseRaw(e):JSON.parse(e)}function Vl(n){return!!Bn(n.text?.format)}function zl(n){return n?.$brand==="auto-parseable-tool"}function Xl(n,e){return n.find(t=>t.type==="function"&&t.name===e)}function Kl(n,e){const t=Xl(n.tools??[],e.name);return{...e,...e,parsed_arguments:zl(t)?t.$parseRaw(e.arguments):t?.strict?JSON.parse(e.arguments):null}}function Tn(n){const e=[];for(const t of n.output)if(t.type==="message")for(const s of t.content)s.type==="output_text"&&e.push(s.text);n.output_text=e.join("")}var Ae,ut,pe,dt,Hs,Vs,zs,Xs;class ns extends Un{constructor(e){super(),Ae.add(this),ut.set(this,void 0),pe.set(this,void 0),dt.set(this,void 0),P(this,ut,e)}static createResponse(e,t,s){const r=new ns(t);return r._run(()=>r._createOrRetrieveResponse(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(e,t,s){const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),p(this,Ae,"m",Hs).call(this);let a,o=null;"response_id"in t?(a=await e.responses.retrieve(t.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),o=t.starting_after??null):a=await e.responses.create({...t,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const i of a)p(this,Ae,"m",Vs).call(this,i,o);if(a.controller.signal?.aborted)throw new Y;return p(this,Ae,"m",zs).call(this)}[(ut=new WeakMap,pe=new WeakMap,dt=new WeakMap,Ae=new WeakSet,Hs=function(){this.ended||P(this,pe,void 0)},Vs=function(t,s){if(this.ended)return;const r=(o,i)=>{(s==null||i.sequence_number>s)&&this._emit(o,i)},a=p(this,Ae,"m",Xs).call(this,t);switch(r("event",t),t.type){case"response.output_text.delta":{const o=a.output[t.output_index];if(!o)throw new E(`missing output at index ${t.output_index}`);if(o.type==="message"){const i=o.content[t.content_index];if(!i)throw new E(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new E(`expected content to be 'output_text', got ${i.type}`);r("response.output_text.delta",{...t,snapshot:i.text})}break}case"response.function_call_arguments.delta":{const o=a.output[t.output_index];if(!o)throw new E(`missing output at index ${t.output_index}`);o.type==="function_call"&&r("response.function_call_arguments.delta",{...t,snapshot:o.arguments});break}default:r(t.type,t);break}},zs=function(){if(this.ended)throw new E("stream has ended, this shouldn't happen");const t=p(this,pe,"f");if(!t)throw new E("request ended without sending any events");P(this,pe,void 0);const s=Jl(t,p(this,ut,"f"));return P(this,dt,s),s},Xs=function(t){let s=p(this,pe,"f");if(!s){if(t.type!=="response.created")throw new E(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return s=P(this,pe,t.response),s}switch(t.type){case"response.output_item.added":{s.output.push(t.item);break}case"response.content_part.added":{const r=s.output[t.output_index];if(!r)throw new E(`missing output at index ${t.output_index}`);const a=r.type,o=t.part;a==="message"&&o.type!=="reasoning_text"?r.content.push(o):a==="reasoning"&&o.type==="reasoning_text"&&(r.content||(r.content=[]),r.content.push(o));break}case"response.output_text.delta":{const r=s.output[t.output_index];if(!r)throw new E(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new E(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new E(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const r=s.output[t.output_index];if(!r)throw new E(`missing output at index ${t.output_index}`);r.type==="function_call"&&(r.arguments+=t.delta);break}case"response.reasoning_text.delta":{const r=s.output[t.output_index];if(!r)throw new E(`missing output at index ${t.output_index}`);if(r.type==="reasoning"){const a=r.content?.[t.content_index];if(!a)throw new E(`missing content at index ${t.content_index}`);if(a.type!=="reasoning_text")throw new E(`expected content to be 'reasoning_text', got ${a.type}`);a.text+=t.delta}break}case"response.completed":{P(this,pe,t.response);break}}return s},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{s=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{s=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{s=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=p(this,dt,"f");if(!e)throw new E("stream ended without producing a ChatCompletion");return e}}function Jl(n,e){return ql(n,e)}class Oa extends A{list(e,t={},s){return this._client.getAPIList(w`/responses/${e}/input_items`,M,{query:t,...s})}}class ss extends A{constructor(){super(...arguments),this.inputItems=new Oa(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&Tn(s),s))}retrieve(e,t={},s){return this._client.get(w`/responses/${e}`,{query:t,...s,stream:t?.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&Tn(r),r))}delete(e,t){return this._client.delete(w`/responses/${e}`,{...t,headers:S([{Accept:"*/*"},t?.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(s=>Ia(s,e))}stream(e,t){return ns.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(w`/responses/${e}/cancel`,t)}}ss.InputItems=Oa;class Ta extends A{create(e,t,s){return this._client.post(w`/uploads/${e}/parts`,ye({body:t,...s},this._client))}}class rs extends A{constructor(){super(...arguments),this.parts=new Ta(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(w`/uploads/${e}/cancel`,t)}complete(e,t,s){return this._client.post(w`/uploads/${e}/complete`,{body:t,...s})}}rs.Parts=Ta;const Yl=async n=>{const e=await Promise.allSettled(n),t=e.filter(r=>r.status==="rejected");if(t.length){for(const r of t)console.error(r.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const s=[];for(const r of e)r.status==="fulfilled"&&s.push(r.value);return s};class ka extends A{create(e,t,s){return this._client.post(w`/vector_stores/${e}/file_batches`,{body:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,t,s){const{vector_store_id:r}=t;return this._client.get(w`/vector_stores/${r}/file_batches/${e}`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,t,s){const{vector_store_id:r}=t;return this._client.post(w`/vector_stores/${r}/file_batches/${e}/cancel`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,t,s){const r=await this.create(e,t);return await this.poll(e,r.id,s)}listFiles(e,t,s){const{vector_store_id:r,...a}=t;return this._client.getAPIList(w`/vector_stores/${r}/file_batches/${e}/files`,M,{query:a,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async poll(e,t,s){const r=S([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:a,response:o}=await this.retrieve(t,{vector_store_id:e},{...s,headers:r}).withResponse();switch(a.status){case"in_progress":let i=5e3;if(s?.pollIntervalMs)i=s.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const d=parseInt(c);isNaN(d)||(i=d)}}await nt(i);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:s=[]},r){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=r?.maxConcurrency??5,o=Math.min(a,t.length),i=this._client,c=t.values(),d=[...s];async function m(g){for(let f of g){const v=await i.files.create({file:f,purpose:"assistants"},r);d.push(v.id)}}const u=Array(o).fill(c).map(m);return await Yl(u),await this.createAndPoll(e,{file_ids:d})}}class $a extends A{create(e,t,s){return this._client.post(w`/vector_stores/${e}/files`,{body:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,t,s){const{vector_store_id:r}=t;return this._client.get(w`/vector_stores/${r}/files/${e}`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,t,s){const{vector_store_id:r,...a}=t;return this._client.post(w`/vector_stores/${r}/files/${e}`,{body:a,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t={},s){return this._client.getAPIList(w`/vector_stores/${e}/files`,M,{query:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,t,s){const{vector_store_id:r}=t;return this._client.delete(w`/vector_stores/${r}/files/${e}`,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,t,s){const r=await this.create(e,t,s);return await this.poll(e,r.id,s)}async poll(e,t,s){const r=S([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const a=await this.retrieve(t,{vector_store_id:e},{...s,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(s?.pollIntervalMs)i=s.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const d=parseInt(c);isNaN(d)||(i=d)}}await nt(i);break;case"failed":case"completed":return o}}}async upload(e,t,s){const r=await this._client.files.create({file:t,purpose:"assistants"},s);return this.create(e,{file_id:r.id},s)}async uploadAndPoll(e,t,s){const r=await this.upload(e,t,s);return await this.poll(e,r.id,s)}content(e,t,s){const{vector_store_id:r}=t;return this._client.getAPIList(w`/vector_stores/${r}/files/${e}/content`,Ut,{...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class Xt extends A{constructor(){super(...arguments),this.files=new $a(this._client),this.fileBatches=new ka(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(w`/vector_stores/${e}`,{...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,s){return this._client.post(w`/vector_stores/${e}`,{body:t,...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",M,{query:e,...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(w`/vector_stores/${e}`,{...t,headers:S([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}search(e,t,s){return this._client.getAPIList(w`/vector_stores/${e}/search`,Ut,{body:t,method:"post",...s,headers:S([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}Xt.Files=$a;Xt.FileBatches=ka;class Da extends A{create(e,t){return this._client.post("/videos",xn({body:e,...t},this._client))}retrieve(e,t){return this._client.get(w`/videos/${e}`,t)}list(e={},t){return this._client.getAPIList("/videos",Pt,{query:e,...t})}delete(e,t){return this._client.delete(w`/videos/${e}`,t)}downloadContent(e,t={},s){return this._client.get(w`/videos/${e}/content`,{query:t,...s,headers:S([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}remix(e,t,s){return this._client.post(w`/videos/${e}/remix`,xn({body:t,...s},this._client))}}var Oe,ja,St;class Ma extends A{constructor(){super(...arguments),Oe.add(this)}async unwrap(e,t,s=this._client.webhookSecret,r=300){return await this.verifySignature(e,t,s,r),JSON.parse(e)}async verifySignature(e,t,s=this._client.webhookSecret,r=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");p(this,Oe,"m",ja).call(this,s);const a=S([t]).values,o=p(this,Oe,"m",St).call(this,a,"webhook-signature"),i=p(this,Oe,"m",St).call(this,a,"webhook-timestamp"),c=p(this,Oe,"m",St).call(this,a,"webhook-id"),d=parseInt(i,10);if(isNaN(d))throw new qe("Invalid webhook timestamp format");const m=Math.floor(Date.now()/1e3);if(m-d>r)throw new qe("Webhook timestamp is too old");if(d>m+r)throw new qe("Webhook timestamp is too new");const u=o.split(" ").map(_=>_.startsWith("v1,")?_.substring(3):_),g=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),f=c?`${c}.${i}.${e}`:`${i}.${e}`,v=await crypto.subtle.importKey("raw",g,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const _ of u)try{const C=Buffer.from(_,"base64");if(await crypto.subtle.verify("HMAC",v,C,new TextEncoder().encode(f)))return}catch{continue}throw new qe("The given webhook signature does not match the expected signature")}}Oe=new WeakSet,ja=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},St=function(e,t){if(!e)throw new Error("Headers are required");const s=e.get(t);if(s==null)throw new Error(`Missing required header: ${t}`);return s};var kn,as,Ct,La;class I{constructor({baseURL:e=Ce("OPENAI_BASE_URL"),apiKey:t=Ce("OPENAI_API_KEY"),organization:s=Ce("OPENAI_ORG_ID")??null,project:r=Ce("OPENAI_PROJECT_ID")??null,webhookSecret:a=Ce("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(kn.add(this),Ct.set(this,void 0),this.completions=new pa(this),this.chat=new Vn(this),this.embeddings=new _a(this),this.files=new wa(this),this.images=new Aa(this),this.audio=new rt(this),this.moderations=new Ra(this),this.models=new Ea(this),this.fineTuning=new Me(this),this.graders=new ts(this),this.vectorStores=new Xt(this),this.webhooks=new Ma(this),this.beta=new je(this),this.batches=new oa(this),this.uploads=new rs(this),this.responses=new ss(this),this.realtime=new zt(this),this.conversations=new Jn(this),this.evals=new Gn(this),this.containers=new Kn(this),this.videos=new Da(this),t===void 0)throw new E("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const i={apiKey:t,organization:s,project:r,webhookSecret:a,...o,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&Gi())throw new E(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=i.baseURL,this.timeout=i.timeout??as.DEFAULT_TIMEOUT,this.logger=i.logger??console;const c="warn";this.logLevel=c,this.logLevel=Os(i.logLevel,"ClientOptions.logLevel",this)??Os(Ce("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??c,this.fetchOptions=i.fetchOptions,this.maxRetries=i.maxRetries??2,this.fetch=i.fetch??nl(),P(this,Ct,rl),this._options=i,this.apiKey=typeof t=="string"?t:"Missing Key",this.organization=s,this.project=r,this.webhookSecret=a}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return S([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return ul(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Ne}`}defaultIdempotencyKey(){return`stainless-node-retry-${lr()}`}makeStatusError(e,t,s,r){return q.generate(e,t,s,r)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let t;try{t=await e()}catch(s){throw s instanceof E?s:new E(`Failed to get token from 'apiKey' function: ${s.message}`,{cause:s})}if(typeof t!="string"||!t)throw new E(`Expected 'apiKey' function argument to return a string but it returned ${t}`);return this.apiKey=t,!0}buildURL(e,t,s){const r=!p(this,kn,"m",La).call(this)&&s||this.baseURL,a=zi(e)?new URL(e):new URL(r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return Xi(o)||(t={...o,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:t,options:s}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(r=>({method:e,path:t,...r})))}request(e,t=null){return new Wt(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,s){const r=await e,a=r.maxRetries??this.maxRetries;t==null&&(t=a),await this.prepareOptions(r);const{req:o,url:i,timeout:c}=await this.buildRequest(r,{retryCount:a-t});await this.prepareRequest(o,{url:i,options:r});const d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=s===void 0?"":`, retryOf: ${s}`,u=Date.now();if(W(this).debug(`[${d}] sending request`,ge({retryOfRequestLogID:s,method:r.method,url:i,options:r,headers:o.headers})),r.signal?.aborted)throw new Y;const g=new AbortController,f=await this.fetchWithTimeout(i,o,c,g).catch(yn),v=Date.now();if(f instanceof globalThis.Error){const x=`retrying, ${t} attempts remaining`;if(r.signal?.aborted)throw new Y;const b=wn(f)||/timed? ?out/i.test(String(f)+("cause"in f?String(f.cause):""));if(t)return W(this).info(`[${d}] connection ${b?"timed out":"failed"} - ${x}`),W(this).debug(`[${d}] connection ${b?"timed out":"failed"} (${x})`,ge({retryOfRequestLogID:s,url:i,durationMs:v-u,message:f.message})),this.retryRequest(r,t,s??d);throw W(this).info(`[${d}] connection ${b?"timed out":"failed"} - error; no more retries left`),W(this).debug(`[${d}] connection ${b?"timed out":"failed"} (error; no more retries left)`,ge({retryOfRequestLogID:s,url:i,durationMs:v-u,message:f.message})),b?new jn:new Ft({cause:f})}const _=[...f.headers.entries()].filter(([x])=>x==="x-request-id").map(([x,b])=>", "+x+": "+JSON.stringify(b)).join(""),C=`[${d}${m}${_}] ${o.method} ${i} ${f.ok?"succeeded":"failed"} with status ${f.status} in ${v-u}ms`;if(!f.ok){const x=await this.shouldRetry(f);if(t&&x){const T=`retrying, ${t} attempts remaining`;return await sl(f.body),W(this).info(`${C} - ${T}`),W(this).debug(`[${d}] response error (${T})`,ge({retryOfRequestLogID:s,url:f.url,status:f.status,headers:f.headers,durationMs:v-u})),this.retryRequest(r,t,s??d,f.headers)}const b=x?"error; no more retries left":"error; not retryable";W(this).info(`${C} - ${b}`);const y=await f.text().catch(T=>yn(T).message),R=Yi(y),O=R?void 0:y;throw W(this).debug(`[${d}] response error (${b})`,ge({retryOfRequestLogID:s,url:f.url,status:f.status,headers:f.headers,message:O,durationMs:Date.now()-u})),this.makeStatusError(f.status,R,O,f.headers)}return W(this).info(C),W(this).debug(`[${d}] response start`,ge({retryOfRequestLogID:s,url:f.url,status:f.status,headers:f.headers,durationMs:v-u})),{response:f,options:r,controller:g,requestLogID:d,retryOfRequestLogID:s,startTime:u}}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}requestAPIList(e,t){const s=this.makeRequest(t,null,void 0);return new wl(this,s,e)}async fetchWithTimeout(e,t,s,r){const{signal:a,method:o,...i}=t||{};a&&a.addEventListener("abort",()=>r.abort());const c=setTimeout(()=>r.abort(),s),d=globalThis.ReadableStream&&i.body instanceof globalThis.ReadableStream||typeof i.body=="object"&&i.body!==null&&Symbol.asyncIterator in i.body,m={signal:r.signal,...d?{duplex:"half"}:{},method:"GET",...i};o&&(m.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(c)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,s,r){let a;const o=r?.get("retry-after-ms");if(o){const c=parseFloat(o);Number.isNaN(c)||(a=c)}const i=r?.get("retry-after");if(i&&!a){const c=parseFloat(i);Number.isNaN(c)?a=Date.parse(i)-Date.now():a=c*1e3}if(!(a&&0<=a&&a<60*1e3)){const c=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,c)}return await nt(a),this.makeRequest(e,t-1,s)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,o=Math.min(.5*Math.pow(2,a),8),i=1-Math.random()*.25;return o*i*1e3}async buildRequest(e,{retryCount:t=0}={}){const s={...e},{method:r,path:a,query:o,defaultBaseURL:i}=s,c=this.buildURL(a,o,i);"timeout"in s&&Ji("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:d,body:m}=this.buildBody({options:s}),u=await this.buildHeaders({options:e,method:r,bodyHeaders:d,retryCount:t});return{req:{method:r,headers:u,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"},...m&&{body:m},...this.fetchOptions??{},...s.fetchOptions??{}},url:c,timeout:s.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:s,retryCount:r}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const o=S([a,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...tl(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,s,e.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=S([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:vr(e)}:p(this,Ct,"f").call(this,{body:e,headers:s})}}as=I,Ct=new WeakMap,kn=new WeakSet,La=function(){return this.baseURL!=="https://api.openai.com/v1"};I.OpenAI=as;I.DEFAULT_TIMEOUT=6e5;I.OpenAIError=E;I.APIError=q;I.APIConnectionError=Ft;I.APIConnectionTimeoutError=jn;I.APIUserAbortError=Y;I.NotFoundError=fr;I.ConflictError=hr;I.RateLimitError=mr;I.BadRequestError=cr;I.AuthenticationError=ur;I.InternalServerError=gr;I.PermissionDeniedError=dr;I.UnprocessableEntityError=pr;I.InvalidWebhookSignatureError=qe;I.toFile=Cl;I.Completions=pa;I.Chat=Vn;I.Embeddings=_a;I.Files=wa;I.Images=Aa;I.Audio=rt;I.Moderations=Ra;I.Models=Ea;I.FineTuning=Me;I.Graders=ts;I.VectorStores=Xt;I.Webhooks=Ma;I.Beta=je;I.Batches=oa;I.Uploads=rs;I.Responses=ss;I.Realtime=zt;I.Conversations=Jn;I.Evals=Gn;I.Containers=Kn;I.Videos=Da;const Fa="";console.warn("⚠️ VITE_OPENAI_API_KEY não configurada. O assistente usará respostas locais.");new I({apiKey:Fa,dangerouslyAllowBrowser:!0});const Gl=!!Fa;class Ql{constructor(){ps(this,"systemKnowledge",{operations:[{name:"Cadastrar Funcionário",description:"Adicionar um novo funcionário ao sistema",steps:['Acesse a seção "Gestão de Funcionários"','Clique em "Adicionar Funcionário"',"Preencha os dados: nome, cargo, salário, data de admissão","Salve as informações"],examples:["Como adicionar um funcionário?","Quero cadastrar um novo colaborador","Adicionar funcionário no sistema"]},{name:"Registrar Transação",description:"Registrar uma nova transação financeira",steps:['Vá para a seção "Transações"','Clique em "Nova Transação"',"Selecione o tipo: receita ou despesa","Preencha valor, descrição, categoria","Salve a transação"],examples:["Como registrar uma venda?","Quero adicionar uma despesa","Registrar transação de receita"]},{name:"Gerenciar Pagamentos",description:"Visualizar e processar pagamentos",steps:['Acesse "Pagamentos" no menu',"Visualize pagamentos pendentes","Processe pagamentos quando necessário","Acompanhe histórico de pagamentos"],examples:["Como ver meus pagamentos?","Processar pagamento pendente","Histórico de pagamentos"]},{name:"Configurar Metas",description:"Definir metas financeiras mensais",steps:['Vá para "Metas" no dashboard',"Defina valor da meta mensal","Configure período da meta","Salve a configuração"],examples:["Como definir uma meta mensal?","Configurar objetivo financeiro","Definir meta de vendas"]}],entities:[{type:"funcionario",description:"Colaboradores da empresa",fields:["nome","cargo","salario","dataAdmissao","email","telefone"],operations:["cadastrar","editar","remover","visualizar"]},{type:"transacao",description:"Movimentações financeiras",fields:["valor","tipo","descricao","categoria","data","funcionario"],operations:["registrar","editar","excluir","filtrar"]},{type:"plataforma",description:"Plataformas de vendas",fields:["nome","comissao","ativo","descricao"],operations:["adicionar","configurar","ativar","desativar"]},{type:"meta",description:"Objetivos financeiros",fields:["valor","periodo","tipo","status"],operations:["definir","atualizar","acompanhar"]}],commonQuestions:[{question:"Como funciona o sistema Optify?",answer:"O Optify é um sistema de gestão financeira empresarial que permite controlar funcionários, transações, pagamentos, metas e gerar relatórios detalhados. Você pode cadastrar colaboradores, registrar vendas e despesas, acompanhar metas mensais e visualizar relatórios em tempo real.",keywords:["sistema","optify","funcionamento","como usar"]},{question:"Como adicionar um funcionário?",answer:'Para adicionar um funcionário: 1) Acesse "Gestão de Funcionários" no menu, 2) Clique em "Adicionar Funcionário", 3) Preencha nome, cargo, salário e data de admissão, 4) Salve as informações. O funcionário será adicionado ao sistema e poderá ser usado em transações.',keywords:["funcionario","adicionar","cadastrar","colaborador"]},{question:"Como registrar uma venda?",answer:'Para registrar uma venda: 1) Vá para "Transações" no menu, 2) Clique em "Nova Transação", 3) Selecione "Receita" como tipo, 4) Preencha valor, descrição e categoria, 5) Associe ao funcionário responsável, 6) Salve a transação. Ela aparecerá no resumo diário e relatórios.',keywords:["venda","receita","transacao","registrar"]},{question:"Como definir metas mensais?",answer:'Para definir metas: 1) Acesse "Metas" no dashboard, 2) Clique em "Nova Meta", 3) Defina o valor desejado, 4) Selecione o período (mensal), 5) Escolha o tipo de meta, 6) Salve. Você poderá acompanhar o progresso em tempo real no dashboard.',keywords:["meta","objetivo","mensal","definir"]},{question:"Como gerar relatórios?",answer:'Para gerar relatórios: 1) Acesse "Relatórios" no menu, 2) Selecione o tipo de relatório desejado, 3) Defina o período, 4) Escolha filtros se necessário, 5) Clique em "Gerar". Os relatórios podem ser exportados em PDF ou visualizados na tela.',keywords:["relatorio","gerar","exportar","pdf"]}]})}async saveMessage(e,t){try{const s={...t,userId:e,timestamp:new Date},r=await Fi(en(Le,`users/${e}/conversations`),s);return await this.cleanupOldMessages(e),r.id}catch(s){throw console.error("Erro ao salvar mensagem:",s),s}}async getRecentMessages(e,t=10){try{const s=gs(en(Le,`users/${e}/conversations`),_s("timestamp","desc"),Bi(t));return(await bs(s)).docs.map(o=>({id:o.id,...o.data(),timestamp:o.data().timestamp.toDate()})).reverse()}catch(s){return console.error("Erro ao buscar mensagens:",s),[]}}async cleanupOldMessages(e){try{const t=gs(en(Le,`users/${e}/conversations`),_s("timestamp","desc")),r=(await bs(t)).docs;if(r.length>10){const a=r.slice(10);for(const o of a)await ws(ys(Le,`users/${e}/conversations`,o.id))}}catch(t){console.error("Erro ao limpar mensagens antigas:",t)}}async processUserMessage(e,t){try{const s=await this.getRecentMessages(e,10);await this.saveMessage(e,{role:"user",content:t});const r=await this.generateResponseWithGPT(t,s);return await this.saveMessage(e,{role:"assistant",content:r,metadata:{operation:this.extractOperation(t),success:!0}}),r}catch(s){return console.error("Erro ao processar mensagem:",s),"Desculpe, ocorreu um erro ao processar sua mensagem. Tente novamente."}}async generateResponseWithGPT(e,t){return this.generateLocalResponse(e,t)}generateLocalResponse(e,t){const s=e.toLowerCase(),r=this.systemKnowledge.commonQuestions.find(i=>i.keywords.some(c=>s.includes(c)));if(r)return r.answer;const a=this.systemKnowledge.operations.find(i=>i.examples.some(c=>s.includes(c.toLowerCase())));if(a)return`Para ${a.description.toLowerCase()}:${a.steps.map((i,c)=>`
${c+1}. ${i}`).join("")}`;const o=this.systemKnowledge.entities.find(i=>s.includes(i.type.toLowerCase()));return o?`Para trabalhar com ${o.description}: você pode ${o.operations.join(", ")}. Os campos disponíveis são: ${o.fields.join(", ")}.`:t.length>0?"Entendi sua pergunta. Como posso ajudá-lo com operações no sistema? Você pode me perguntar sobre funcionários, transações, pagamentos, metas ou relatórios.":`Olá! Sou seu assistente do Optify. Posso ajudá-lo com:

• Cadastro e gestão de funcionários
• Registro de transações (vendas e despesas)
• Configuração de metas mensais
• Geração de relatórios
• Dúvidas sobre o sistema

Como posso ajudá-lo hoje?`}extractOperation(e){const t=e.toLowerCase();return t.includes("adicionar")||t.includes("cadastrar")?"create":t.includes("editar")||t.includes("alterar")?"update":t.includes("remover")||t.includes("excluir")?"delete":t.includes("visualizar")||t.includes("ver")?"view":"general"}async clearConversationHistory(e){try{const t=await this.getRecentMessages(e,100);for(const s of t)s.id&&await ws(ys(Le,`users/${e}/conversations`,s.id))}catch(t){throw console.error("Erro ao limpar histórico:",t),t}}}const dn=new Ql;function Zl(n,[e,t]){return Math.min(t,Math.max(e,n))}function ec(n,e){return h.useReducer((t,s)=>e[t][s]??t,n)}var os="ScrollArea",[Ba,rd]=Dn(os),[tc,Q]=Ba(os),Wa=h.forwardRef((n,e)=>{const{__scopeScrollArea:t,type:s="hover",dir:r,scrollHideDelay:a=600,...o}=n,[i,c]=h.useState(null),[d,m]=h.useState(null),[u,g]=h.useState(null),[f,v]=h.useState(null),[_,C]=h.useState(null),[x,b]=h.useState(0),[y,R]=h.useState(0),[O,k]=h.useState(!1),[T,D]=h.useState(!1),N=G(e,j=>c(j)),$=Ui(r);return l.jsx(tc,{scope:t,type:s,dir:$,scrollHideDelay:a,scrollArea:i,viewport:d,onViewportChange:m,content:u,onContentChange:g,scrollbarX:f,onScrollbarXChange:v,scrollbarXEnabled:O,onScrollbarXEnabledChange:k,scrollbarY:_,onScrollbarYChange:C,scrollbarYEnabled:T,onScrollbarYEnabledChange:D,onCornerWidthChange:b,onCornerHeightChange:R,children:l.jsx(ee.div,{dir:$,...o,ref:N,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":y+"px",...n.style}})})});Wa.displayName=os;var Ua="ScrollAreaViewport",qa=h.forwardRef((n,e)=>{const{__scopeScrollArea:t,children:s,nonce:r,...a}=n,o=Q(Ua,t),i=h.useRef(null),c=G(e,i,o.onViewportChange);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),l.jsx(ee.div,{"data-radix-scroll-area-viewport":"",...a,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...n.style},children:l.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});qa.displayName=Ua;var ie="ScrollAreaScrollbar",is=h.forwardRef((n,e)=>{const{forceMount:t,...s}=n,r=Q(ie,n.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:o}=r,i=n.orientation==="horizontal";return h.useEffect(()=>(i?a(!0):o(!0),()=>{i?a(!1):o(!1)}),[i,a,o]),r.type==="hover"?l.jsx(nc,{...s,ref:e,forceMount:t}):r.type==="scroll"?l.jsx(sc,{...s,ref:e,forceMount:t}):r.type==="auto"?l.jsx(Ha,{...s,ref:e,forceMount:t}):r.type==="always"?l.jsx(ls,{...s,ref:e}):null});is.displayName=ie;var nc=h.forwardRef((n,e)=>{const{forceMount:t,...s}=n,r=Q(ie,n.__scopeScrollArea),[a,o]=h.useState(!1);return h.useEffect(()=>{const i=r.scrollArea;let c=0;if(i){const d=()=>{window.clearTimeout(c),o(!0)},m=()=>{c=window.setTimeout(()=>o(!1),r.scrollHideDelay)};return i.addEventListener("pointerenter",d),i.addEventListener("pointerleave",m),()=>{window.clearTimeout(c),i.removeEventListener("pointerenter",d),i.removeEventListener("pointerleave",m)}}},[r.scrollArea,r.scrollHideDelay]),l.jsx(xe,{present:t||a,children:l.jsx(Ha,{"data-state":a?"visible":"hidden",...s,ref:e})})}),sc=h.forwardRef((n,e)=>{const{forceMount:t,...s}=n,r=Q(ie,n.__scopeScrollArea),a=n.orientation==="horizontal",o=Jt(()=>c("SCROLL_END"),100),[i,c]=ec("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return h.useEffect(()=>{if(i==="idle"){const d=window.setTimeout(()=>c("HIDE"),r.scrollHideDelay);return()=>window.clearTimeout(d)}},[i,r.scrollHideDelay,c]),h.useEffect(()=>{const d=r.viewport,m=a?"scrollLeft":"scrollTop";if(d){let u=d[m];const g=()=>{const f=d[m];u!==f&&(c("SCROLL"),o()),u=f};return d.addEventListener("scroll",g),()=>d.removeEventListener("scroll",g)}},[r.viewport,a,c,o]),l.jsx(xe,{present:t||i!=="hidden",children:l.jsx(ls,{"data-state":i==="hidden"?"hidden":"visible",...s,ref:e,onPointerEnter:J(n.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:J(n.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Ha=h.forwardRef((n,e)=>{const t=Q(ie,n.__scopeScrollArea),{forceMount:s,...r}=n,[a,o]=h.useState(!1),i=n.orientation==="horizontal",c=Jt(()=>{if(t.viewport){const d=t.viewport.offsetWidth<t.viewport.scrollWidth,m=t.viewport.offsetHeight<t.viewport.scrollHeight;o(i?d:m)}},10);return De(t.viewport,c),De(t.content,c),l.jsx(xe,{present:s||a,children:l.jsx(ls,{"data-state":a?"visible":"hidden",...r,ref:e})})}),ls=h.forwardRef((n,e)=>{const{orientation:t="vertical",...s}=n,r=Q(ie,n.__scopeScrollArea),a=h.useRef(null),o=h.useRef(0),[i,c]=h.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=Ja(i.viewport,i.content),m={...s,sizes:i,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:g=>a.current=g,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:g=>o.current=g};function u(g,f){return cc(g,o.current,i,f)}return t==="horizontal"?l.jsx(rc,{...m,ref:e,onThumbPositionChange:()=>{if(r.viewport&&a.current){const g=r.viewport.scrollLeft,f=Ks(g,i,r.dir);a.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:g=>{r.viewport&&(r.viewport.scrollLeft=g)},onDragScroll:g=>{r.viewport&&(r.viewport.scrollLeft=u(g,r.dir))}}):t==="vertical"?l.jsx(ac,{...m,ref:e,onThumbPositionChange:()=>{if(r.viewport&&a.current){const g=r.viewport.scrollTop,f=Ks(g,i);a.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:g=>{r.viewport&&(r.viewport.scrollTop=g)},onDragScroll:g=>{r.viewport&&(r.viewport.scrollTop=u(g))}}):null}),rc=h.forwardRef((n,e)=>{const{sizes:t,onSizesChange:s,...r}=n,a=Q(ie,n.__scopeScrollArea),[o,i]=h.useState(),c=h.useRef(null),d=G(e,c,a.onScrollbarXChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),l.jsx(za,{"data-orientation":"horizontal",...r,ref:d,sizes:t,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Kt(t)+"px",...n.style},onThumbPointerDown:m=>n.onThumbPointerDown(m.x),onDragScroll:m=>n.onDragScroll(m.x),onWheelScroll:(m,u)=>{if(a.viewport){const g=a.viewport.scrollLeft+m.deltaX;n.onWheelScroll(g),Ga(g,u)&&m.preventDefault()}},onResize:()=>{c.current&&a.viewport&&o&&s({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Mt(o.paddingLeft),paddingEnd:Mt(o.paddingRight)}})}})}),ac=h.forwardRef((n,e)=>{const{sizes:t,onSizesChange:s,...r}=n,a=Q(ie,n.__scopeScrollArea),[o,i]=h.useState(),c=h.useRef(null),d=G(e,c,a.onScrollbarYChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),l.jsx(za,{"data-orientation":"vertical",...r,ref:d,sizes:t,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Kt(t)+"px",...n.style},onThumbPointerDown:m=>n.onThumbPointerDown(m.y),onDragScroll:m=>n.onDragScroll(m.y),onWheelScroll:(m,u)=>{if(a.viewport){const g=a.viewport.scrollTop+m.deltaY;n.onWheelScroll(g),Ga(g,u)&&m.preventDefault()}},onResize:()=>{c.current&&a.viewport&&o&&s({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Mt(o.paddingTop),paddingEnd:Mt(o.paddingBottom)}})}})}),[oc,Va]=Ba(ie),za=h.forwardRef((n,e)=>{const{__scopeScrollArea:t,sizes:s,hasThumb:r,onThumbChange:a,onThumbPointerUp:o,onThumbPointerDown:i,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:m,onResize:u,...g}=n,f=Q(ie,t),[v,_]=h.useState(null),C=G(e,N=>_(N)),x=h.useRef(null),b=h.useRef(""),y=f.viewport,R=s.content-s.viewport,O=ue(m),k=ue(c),T=Jt(u,10);function D(N){if(x.current){const $=N.clientX-x.current.left,j=N.clientY-x.current.top;d({x:$,y:j})}}return h.useEffect(()=>{const N=$=>{const j=$.target;v?.contains(j)&&O($,R)};return document.addEventListener("wheel",N,{passive:!1}),()=>document.removeEventListener("wheel",N,{passive:!1})},[y,v,R,O]),h.useEffect(k,[s,k]),De(v,T),De(f.content,T),l.jsx(oc,{scope:t,scrollbar:v,hasThumb:r,onThumbChange:ue(a),onThumbPointerUp:ue(o),onThumbPositionChange:k,onThumbPointerDown:ue(i),children:l.jsx(ee.div,{...g,ref:C,style:{position:"absolute",...g.style},onPointerDown:J(n.onPointerDown,N=>{N.button===0&&(N.target.setPointerCapture(N.pointerId),x.current=v.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),D(N))}),onPointerMove:J(n.onPointerMove,D),onPointerUp:J(n.onPointerUp,N=>{const $=N.target;$.hasPointerCapture(N.pointerId)&&$.releasePointerCapture(N.pointerId),document.body.style.webkitUserSelect=b.current,f.viewport&&(f.viewport.style.scrollBehavior=""),x.current=null})})})}),jt="ScrollAreaThumb",Xa=h.forwardRef((n,e)=>{const{forceMount:t,...s}=n,r=Va(jt,n.__scopeScrollArea);return l.jsx(xe,{present:t||r.hasThumb,children:l.jsx(ic,{ref:e,...s})})}),ic=h.forwardRef((n,e)=>{const{__scopeScrollArea:t,style:s,...r}=n,a=Q(jt,t),o=Va(jt,t),{onThumbPositionChange:i}=o,c=G(e,u=>o.onThumbChange(u)),d=h.useRef(void 0),m=Jt(()=>{d.current&&(d.current(),d.current=void 0)},100);return h.useEffect(()=>{const u=a.viewport;if(u){const g=()=>{if(m(),!d.current){const f=uc(u,i);d.current=f,i()}};return i(),u.addEventListener("scroll",g),()=>u.removeEventListener("scroll",g)}},[a.viewport,m,i]),l.jsx(ee.div,{"data-state":o.hasThumb?"visible":"hidden",...r,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:J(n.onPointerDownCapture,u=>{const f=u.target.getBoundingClientRect(),v=u.clientX-f.left,_=u.clientY-f.top;o.onThumbPointerDown({x:v,y:_})}),onPointerUp:J(n.onPointerUp,o.onThumbPointerUp)})});Xa.displayName=jt;var cs="ScrollAreaCorner",Ka=h.forwardRef((n,e)=>{const t=Q(cs,n.__scopeScrollArea),s=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&s?l.jsx(lc,{...n,ref:e}):null});Ka.displayName=cs;var lc=h.forwardRef((n,e)=>{const{__scopeScrollArea:t,...s}=n,r=Q(cs,t),[a,o]=h.useState(0),[i,c]=h.useState(0),d=!!(a&&i);return De(r.scrollbarX,()=>{const m=r.scrollbarX?.offsetHeight||0;r.onCornerHeightChange(m),c(m)}),De(r.scrollbarY,()=>{const m=r.scrollbarY?.offsetWidth||0;r.onCornerWidthChange(m),o(m)}),d?l.jsx(ee.div,{...s,ref:e,style:{width:a,height:i,position:"absolute",right:r.dir==="ltr"?0:void 0,left:r.dir==="rtl"?0:void 0,bottom:0,...n.style}}):null});function Mt(n){return n?parseInt(n,10):0}function Ja(n,e){const t=n/e;return isNaN(t)?0:t}function Kt(n){const e=Ja(n.viewport,n.content),t=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,s=(n.scrollbar.size-t)*e;return Math.max(s,18)}function cc(n,e,t,s="ltr"){const r=Kt(t),a=r/2,o=e||a,i=r-o,c=t.scrollbar.paddingStart+o,d=t.scrollbar.size-t.scrollbar.paddingEnd-i,m=t.content-t.viewport,u=s==="ltr"?[0,m]:[m*-1,0];return Ya([c,d],u)(n)}function Ks(n,e,t="ltr"){const s=Kt(e),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,a=e.scrollbar.size-r,o=e.content-e.viewport,i=a-s,c=t==="ltr"?[0,o]:[o*-1,0],d=Zl(n,c);return Ya([0,o],[0,i])(d)}function Ya(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const s=(e[1]-e[0])/(n[1]-n[0]);return e[0]+s*(t-n[0])}}function Ga(n,e){return n>0&&n<e}var uc=(n,e=()=>{})=>{let t={left:n.scrollLeft,top:n.scrollTop},s=0;return function r(){const a={left:n.scrollLeft,top:n.scrollTop},o=t.left!==a.left,i=t.top!==a.top;(o||i)&&e(),t=a,s=window.requestAnimationFrame(r)}(),()=>window.cancelAnimationFrame(s)};function Jt(n,e){const t=ue(n),s=h.useRef(0);return h.useEffect(()=>()=>window.clearTimeout(s.current),[]),h.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(t,e)},[t,e])}function De(n,e){const t=ue(e);Ei(()=>{let s=0;if(n){const r=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(t)});return r.observe(n),()=>{window.cancelAnimationFrame(s),r.unobserve(n)}}},[n,t])}var Qa=Wa,dc=qa,fc=Ka;const Za=h.forwardRef(({className:n,children:e,...t},s)=>l.jsxs(Qa,{ref:s,className:oe("relative overflow-hidden",n),...t,children:[l.jsx(dc,{className:"h-full w-full rounded-[inherit]",children:e}),l.jsx(eo,{}),l.jsx(fc,{})]}));Za.displayName=Qa.displayName;const eo=h.forwardRef(({className:n,orientation:e="vertical",...t},s)=>l.jsx(is,{ref:s,orientation:e,className:oe("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",n),...t,children:l.jsx(Xa,{className:"relative flex-1 rounded-full bg-border"})}));eo.displayName=is.displayName;const hc=({className:n})=>{const{user:e}=or(),[t,s]=h.useState(!1),[r,a]=h.useState([]),[o,i]=h.useState(""),[c,d]=h.useState(!1),m=h.useRef(null),u=h.useRef(null);h.useEffect(()=>{t&&e?.uid&&g()},[t,e?.uid]),h.useEffect(()=>{f()},[r]),h.useEffect(()=>{t&&u.current&&setTimeout(()=>u.current?.focus(),100)},[t]);const g=async()=>{if(e?.uid)try{const b=await dn.getRecentMessages(e.uid);a(b)}catch(b){console.error("Erro ao carregar mensagens:",b),Be.error("Erro ao carregar histórico de conversas")}},f=()=>{m.current?.scrollIntoView({behavior:"smooth"})},v=async()=>{if(!o.trim()||!e?.uid||c)return;const b=o.trim();i(""),d(!0);try{const y={id:`temp-${Date.now()}`,role:"user",content:b,timestamp:new Date,userId:e.uid};a(k=>[...k,y]);const R=await dn.processUserMessage(e.uid,b),O={id:`temp-assistant-${Date.now()}`,role:"assistant",content:R,timestamp:new Date,userId:e.uid};a(k=>[...k,O])}catch(y){console.error("Erro ao enviar mensagem:",y),Be.error("Erro ao enviar mensagem. Tente novamente.")}finally{d(!1)}},_=b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),v())},C=async()=>{if(e?.uid)try{await dn.clearConversationHistory(e.uid),a([]),Be.success("Histórico de conversas limpo")}catch(b){console.error("Erro ao limpar histórico:",b),Be.error("Erro ao limpar histórico")}},x=b=>b.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});return e?l.jsxs(l.Fragment,{children:[!t&&l.jsx(Ue,{onClick:()=>s(!0),className:"fixed bottom-6 right-6 z-50 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-200",size:"icon",children:l.jsx(ii,{className:"h-6 w-6"})}),t&&l.jsxs(Ri,{className:`fixed bottom-6 right-6 z-50 w-96 h-[500px] shadow-2xl ${n}`,children:[l.jsxs(Pi,{className:"pb-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(We,{className:"h-5 w-5 text-primary"}),l.jsx(Ni,{className:"text-lg",children:"Assistente Optify"}),Gl]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Ue,{variant:"ghost",size:"sm",onClick:C,className:"h-8 w-8 p-0",title:"Limpar histórico",children:l.jsx(li,{className:"h-4 w-4"})}),l.jsx(Ue,{variant:"ghost",size:"sm",onClick:()=>s(!1),className:"h-8 w-8 p-0",children:l.jsx(ar,{className:"h-4 w-4"})})]})]}),l.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"💡 Usando respostas locais • Configure OpenAI para respostas mais inteligentes"})]}),l.jsxs(Ii,{className:"flex flex-col h-[400px] p-0",children:[l.jsx(Za,{className:"flex-1 px-4",children:l.jsxs("div",{className:"space-y-4 py-4",children:[r.length===0&&l.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[l.jsx(We,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground/50"}),l.jsx("p",{className:"text-sm",children:"Olá! Como posso ajudá-lo hoje?"}),l.jsx("p",{className:"text-xs mt-1",children:"Pergunte sobre funcionários, transações, metas ou relatórios"})]}),r.map(b=>l.jsxs("div",{className:`flex gap-3 ${b.role==="user"?"justify-end":"justify-start"}`,children:[b.role==="assistant"&&l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:l.jsx(We,{className:"h-4 w-4 text-primary"})})}),l.jsxs("div",{className:`max-w-[80%] ${b.role==="user"?"order-first":""}`,children:[l.jsx("div",{className:`rounded-lg px-3 py-2 text-sm ${b.role==="user"?"bg-primary text-primary-foreground ml-auto":"bg-muted"}`,children:l.jsx("div",{className:"whitespace-pre-wrap",children:b.content})}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("span",{className:"text-xs text-muted-foreground",children:x(b.timestamp)}),b.role==="user"&&l.jsx(ms,{className:"h-3 w-3 text-muted-foreground"}),b.metadata?.operation&&l.jsx(Oi,{variant:"secondary",className:"text-xs",children:b.metadata.operation})]})]}),b.role==="user"&&l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center",children:l.jsx(ms,{className:"h-4 w-4 text-primary-foreground"})})})]},b.id)),c&&l.jsxs("div",{className:"flex gap-3 justify-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:l.jsx(We,{className:"h-4 w-4 text-primary"})})}),l.jsx("div",{className:"bg-muted rounded-lg px-3 py-2",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex gap-1",children:[l.jsx("div",{className:"w-2 h-2 bg-muted-foreground/50 rounded-full animate-bounce"}),l.jsx("div",{className:"w-2 h-2 bg-muted-foreground/50 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l.jsx("div",{className:"w-2 h-2 bg-muted-foreground/50 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),l.jsx("span",{className:"text-xs text-muted-foreground",children:"Digitando..."})]})})]}),l.jsx("div",{ref:m})]})}),l.jsxs("div",{className:"border-t p-4",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Wi,{ref:u,value:o,onChange:b=>i(b.target.value),onKeyPress:_,placeholder:"Digite sua mensagem...",disabled:c,className:"flex-1"}),l.jsx(Ue,{onClick:v,disabled:!o.trim()||c,size:"icon",className:"h-10 w-10",children:l.jsx(ci,{className:"h-4 w-4"})})]}),l.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Pressione Enter para enviar • Shift+Enter para nova linha"})]})]})]})]}):null};var fn="focusScope.autoFocusOnMount",hn="focusScope.autoFocusOnUnmount",Js={bubbles:!1,cancelable:!0},pc="FocusScope",to=h.forwardRef((n,e)=>{const{loop:t=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:a,...o}=n,[i,c]=h.useState(null),d=ue(r),m=ue(a),u=h.useRef(null),g=G(e,_=>c(_)),f=h.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;h.useEffect(()=>{if(s){let _=function(y){if(f.paused||!i)return;const R=y.target;i.contains(R)?u.current=R:me(u.current,{select:!0})},C=function(y){if(f.paused||!i)return;const R=y.relatedTarget;R!==null&&(i.contains(R)||me(u.current,{select:!0}))},x=function(y){if(document.activeElement===document.body)for(const O of y)O.removedNodes.length>0&&me(i)};document.addEventListener("focusin",_),document.addEventListener("focusout",C);const b=new MutationObserver(x);return i&&b.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",_),document.removeEventListener("focusout",C),b.disconnect()}}},[s,i,f.paused]),h.useEffect(()=>{if(i){Gs.add(f);const _=document.activeElement;if(!i.contains(_)){const x=new CustomEvent(fn,Js);i.addEventListener(fn,d),i.dispatchEvent(x),x.defaultPrevented||(mc(yc(no(i)),{select:!0}),document.activeElement===_&&me(i))}return()=>{i.removeEventListener(fn,d),setTimeout(()=>{const x=new CustomEvent(hn,Js);i.addEventListener(hn,m),i.dispatchEvent(x),x.defaultPrevented||me(_??document.body,{select:!0}),i.removeEventListener(hn,m),Gs.remove(f)},0)}}},[i,d,m,f]);const v=h.useCallback(_=>{if(!t&&!s||f.paused)return;const C=_.key==="Tab"&&!_.altKey&&!_.ctrlKey&&!_.metaKey,x=document.activeElement;if(C&&x){const b=_.currentTarget,[y,R]=gc(b);y&&R?!_.shiftKey&&x===R?(_.preventDefault(),t&&me(y,{select:!0})):_.shiftKey&&x===y&&(_.preventDefault(),t&&me(R,{select:!0})):x===b&&_.preventDefault()}},[t,s,f.paused]);return l.jsx(ee.div,{tabIndex:-1,...o,ref:g,onKeyDown:v})});to.displayName=pc;function mc(n,{select:e=!1}={}){const t=document.activeElement;for(const s of n)if(me(s,{select:e}),document.activeElement!==t)return}function gc(n){const e=no(n),t=Ys(e,n),s=Ys(e.reverse(),n);return[t,s]}function no(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function Ys(n,e){for(const t of n)if(!_c(t,{upTo:e}))return t}function _c(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function bc(n){return n instanceof HTMLInputElement&&"select"in n}function me(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&bc(n)&&e&&n.select()}}var Gs=wc();function wc(){let n=[];return{add(e){const t=n[0];e!==t&&t?.pause(),n=Qs(n,e),n.unshift(e)},remove(e){n=Qs(n,e),n[0]?.resume()}}}function Qs(n,e){const t=[...n],s=t.indexOf(e);return s!==-1&&t.splice(s,1),t}function yc(n){return n.filter(e=>e.tagName!=="A")}var pn=0;function vc(){h.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??Zs()),document.body.insertAdjacentElement("beforeend",n[1]??Zs()),pn++,()=>{pn===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),pn--}},[])}function Zs(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var re=function(){return re=Object.assign||function(e){for(var t,s=1,r=arguments.length;s<r;s++){t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},re.apply(this,arguments)};function so(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t}function xc(n,e,t){if(t||arguments.length===2)for(var s=0,r=e.length,a;s<r;s++)(a||!(s in e))&&(a||(a=Array.prototype.slice.call(e,0,s)),a[s]=e[s]);return n.concat(a||Array.prototype.slice.call(e))}var At="right-scroll-bar-position",Et="width-before-scroll-bar",Sc="with-scroll-bars-hidden",Cc="--removed-body-scroll-bar-size";function mn(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function Ac(n,e){var t=h.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(s){var r=t.value;r!==s&&(t.value=s,t.callback(s,r))}}}})[0];return t.callback=e,t.facade}var Ec=typeof window<"u"?h.useLayoutEffect:h.useEffect,er=new WeakMap;function Rc(n,e){var t=Ac(null,function(s){return n.forEach(function(r){return mn(r,s)})});return Ec(function(){var s=er.get(t);if(s){var r=new Set(s),a=new Set(n),o=t.current;r.forEach(function(i){a.has(i)||mn(i,null)}),a.forEach(function(i){r.has(i)||mn(i,o)})}er.set(t,n)},[n]),t}function Pc(n){return n}function Nc(n,e){e===void 0&&(e=Pc);var t=[],s=!1,r={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(a){var o=e(a,s);return t.push(o),function(){t=t.filter(function(i){return i!==o})}},assignSyncMedium:function(a){for(s=!0;t.length;){var o=t;t=[],o.forEach(a)}t={push:function(i){return a(i)},filter:function(){return t}}},assignMedium:function(a){s=!0;var o=[];if(t.length){var i=t;t=[],i.forEach(a),o=t}var c=function(){var m=o;o=[],m.forEach(a)},d=function(){return Promise.resolve().then(c)};d(),t={push:function(m){o.push(m),d()},filter:function(m){return o=o.filter(m),t}}}};return r}function Ic(n){n===void 0&&(n={});var e=Nc(null);return e.options=re({async:!0,ssr:!1},n),e}var ro=function(n){var e=n.sideCar,t=so(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return h.createElement(s,re({},t))};ro.isSideCarExport=!0;function Oc(n,e){return n.useMedium(e),ro}var ao=Ic(),gn=function(){},Yt=h.forwardRef(function(n,e){var t=h.useRef(null),s=h.useState({onScrollCapture:gn,onWheelCapture:gn,onTouchMoveCapture:gn}),r=s[0],a=s[1],o=n.forwardProps,i=n.children,c=n.className,d=n.removeScrollBar,m=n.enabled,u=n.shards,g=n.sideCar,f=n.noRelative,v=n.noIsolation,_=n.inert,C=n.allowPinchZoom,x=n.as,b=x===void 0?"div":x,y=n.gapMode,R=so(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),O=g,k=Rc([t,e]),T=re(re({},R),r);return h.createElement(h.Fragment,null,m&&h.createElement(O,{sideCar:ao,removeScrollBar:d,shards:u,noRelative:f,noIsolation:v,inert:_,setCallbacks:a,allowPinchZoom:!!C,lockRef:t,gapMode:y}),o?h.cloneElement(h.Children.only(i),re(re({},T),{ref:k})):h.createElement(b,re({},T,{className:c,ref:k}),i))});Yt.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Yt.classNames={fullWidth:Et,zeroRight:At};var Tc=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function kc(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=Tc();return e&&n.setAttribute("nonce",e),n}function $c(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function Dc(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var jc=function(){var n=0,e=null;return{add:function(t){n==0&&(e=kc())&&($c(e,t),Dc(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Mc=function(){var n=jc();return function(e,t){h.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},oo=function(){var n=Mc(),e=function(t){var s=t.styles,r=t.dynamic;return n(s,r),null};return e},Lc={left:0,top:0,right:0,gap:0},_n=function(n){return parseInt(n||"",10)||0},Fc=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],s=e[n==="padding"?"paddingTop":"marginTop"],r=e[n==="padding"?"paddingRight":"marginRight"];return[_n(t),_n(s),_n(r)]},Bc=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return Lc;var e=Fc(n),t=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-t+e[2]-e[0])}},Wc=oo(),ke="data-scroll-locked",Uc=function(n,e,t,s){var r=n.left,a=n.top,o=n.right,i=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(Sc,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(i,"px ").concat(s,`;
  }
  body[`).concat(ke,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),t==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(s,`;
    `),t==="padding"&&"padding-right: ".concat(i,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(At,` {
    right: `).concat(i,"px ").concat(s,`;
  }
  
  .`).concat(Et,` {
    margin-right: `).concat(i,"px ").concat(s,`;
  }
  
  .`).concat(At," .").concat(At,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Et," .").concat(Et,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(ke,`] {
    `).concat(Cc,": ").concat(i,`px;
  }
`)},tr=function(){var n=parseInt(document.body.getAttribute(ke)||"0",10);return isFinite(n)?n:0},qc=function(){h.useEffect(function(){return document.body.setAttribute(ke,(tr()+1).toString()),function(){var n=tr()-1;n<=0?document.body.removeAttribute(ke):document.body.setAttribute(ke,n.toString())}},[])},Hc=function(n){var e=n.noRelative,t=n.noImportant,s=n.gapMode,r=s===void 0?"margin":s;qc();var a=h.useMemo(function(){return Bc(r)},[r]);return h.createElement(Wc,{styles:Uc(a,!e,r,t?"":"!important")})},$n=!1;if(typeof window<"u")try{var ft=Object.defineProperty({},"passive",{get:function(){return $n=!0,!0}});window.addEventListener("test",ft,ft),window.removeEventListener("test",ft,ft)}catch{$n=!1}var Ee=$n?{passive:!1}:!1,Vc=function(n){return n.tagName==="TEXTAREA"},io=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!Vc(n)&&t[e]==="visible")},zc=function(n){return io(n,"overflowY")},Xc=function(n){return io(n,"overflowX")},nr=function(n,e){var t=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var r=lo(n,s);if(r){var a=co(n,s),o=a[1],i=a[2];if(o>i)return!0}s=s.parentNode}while(s&&s!==t.body);return!1},Kc=function(n){var e=n.scrollTop,t=n.scrollHeight,s=n.clientHeight;return[e,t,s]},Jc=function(n){var e=n.scrollLeft,t=n.scrollWidth,s=n.clientWidth;return[e,t,s]},lo=function(n,e){return n==="v"?zc(e):Xc(e)},co=function(n,e){return n==="v"?Kc(e):Jc(e)},Yc=function(n,e){return n==="h"&&e==="rtl"?-1:1},Gc=function(n,e,t,s,r){var a=Yc(n,window.getComputedStyle(e).direction),o=a*s,i=t.target,c=e.contains(i),d=!1,m=o>0,u=0,g=0;do{if(!i)break;var f=co(n,i),v=f[0],_=f[1],C=f[2],x=_-C-a*v;(v||x)&&lo(n,i)&&(u+=x,g+=v);var b=i.parentNode;i=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&i!==document.body||c&&(e.contains(i)||e===i));return(m&&(Math.abs(u)<1||!r)||!m&&(Math.abs(g)<1||!r))&&(d=!0),d},ht=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},sr=function(n){return[n.deltaX,n.deltaY]},rr=function(n){return n&&"current"in n?n.current:n},Qc=function(n,e){return n[0]===e[0]&&n[1]===e[1]},Zc=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},eu=0,Re=[];function tu(n){var e=h.useRef([]),t=h.useRef([0,0]),s=h.useRef(),r=h.useState(eu++)[0],a=h.useState(oo)[0],o=h.useRef(n);h.useEffect(function(){o.current=n},[n]),h.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(r));var _=xc([n.lockRef.current],(n.shards||[]).map(rr),!0).filter(Boolean);return _.forEach(function(C){return C.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),_.forEach(function(C){return C.classList.remove("allow-interactivity-".concat(r))})}}},[n.inert,n.lockRef.current,n.shards]);var i=h.useCallback(function(_,C){if("touches"in _&&_.touches.length===2||_.type==="wheel"&&_.ctrlKey)return!o.current.allowPinchZoom;var x=ht(_),b=t.current,y="deltaX"in _?_.deltaX:b[0]-x[0],R="deltaY"in _?_.deltaY:b[1]-x[1],O,k=_.target,T=Math.abs(y)>Math.abs(R)?"h":"v";if("touches"in _&&T==="h"&&k.type==="range")return!1;var D=nr(T,k);if(!D)return!0;if(D?O=T:(O=T==="v"?"h":"v",D=nr(T,k)),!D)return!1;if(!s.current&&"changedTouches"in _&&(y||R)&&(s.current=O),!O)return!0;var N=s.current||O;return Gc(N,C,_,N==="h"?y:R,!0)},[]),c=h.useCallback(function(_){var C=_;if(!(!Re.length||Re[Re.length-1]!==a)){var x="deltaY"in C?sr(C):ht(C),b=e.current.filter(function(O){return O.name===C.type&&(O.target===C.target||C.target===O.shadowParent)&&Qc(O.delta,x)})[0];if(b&&b.should){C.cancelable&&C.preventDefault();return}if(!b){var y=(o.current.shards||[]).map(rr).filter(Boolean).filter(function(O){return O.contains(C.target)}),R=y.length>0?i(C,y[0]):!o.current.noIsolation;R&&C.cancelable&&C.preventDefault()}}},[]),d=h.useCallback(function(_,C,x,b){var y={name:_,delta:C,target:x,should:b,shadowParent:nu(x)};e.current.push(y),setTimeout(function(){e.current=e.current.filter(function(R){return R!==y})},1)},[]),m=h.useCallback(function(_){t.current=ht(_),s.current=void 0},[]),u=h.useCallback(function(_){d(_.type,sr(_),_.target,i(_,n.lockRef.current))},[]),g=h.useCallback(function(_){d(_.type,ht(_),_.target,i(_,n.lockRef.current))},[]);h.useEffect(function(){return Re.push(a),n.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:g}),document.addEventListener("wheel",c,Ee),document.addEventListener("touchmove",c,Ee),document.addEventListener("touchstart",m,Ee),function(){Re=Re.filter(function(_){return _!==a}),document.removeEventListener("wheel",c,Ee),document.removeEventListener("touchmove",c,Ee),document.removeEventListener("touchstart",m,Ee)}},[]);var f=n.removeScrollBar,v=n.inert;return h.createElement(h.Fragment,null,v?h.createElement(a,{styles:Zc(r)}):null,f?h.createElement(Hc,{noRelative:n.noRelative,gapMode:n.gapMode}):null)}function nu(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const su=Oc(ao,tu);var uo=h.forwardRef(function(n,e){return h.createElement(Yt,re({},n,{ref:e,sideCar:su}))});uo.classNames=Yt.classNames;var ru=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},Pe=new WeakMap,pt=new WeakMap,mt={},bn=0,fo=function(n){return n&&(n.host||fo(n.parentNode))},au=function(n,e){return e.map(function(t){if(n.contains(t))return t;var s=fo(t);return s&&n.contains(s)?s:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},ou=function(n,e,t,s){var r=au(e,Array.isArray(n)?n:[n]);mt[t]||(mt[t]=new WeakMap);var a=mt[t],o=[],i=new Set,c=new Set(r),d=function(u){!u||i.has(u)||(i.add(u),d(u.parentNode))};r.forEach(d);var m=function(u){!u||c.has(u)||Array.prototype.forEach.call(u.children,function(g){if(i.has(g))m(g);else try{var f=g.getAttribute(s),v=f!==null&&f!=="false",_=(Pe.get(g)||0)+1,C=(a.get(g)||0)+1;Pe.set(g,_),a.set(g,C),o.push(g),_===1&&v&&pt.set(g,!0),C===1&&g.setAttribute(t,"true"),v||g.setAttribute(s,"true")}catch(x){console.error("aria-hidden: cannot operate on ",g,x)}})};return m(e),i.clear(),bn++,function(){o.forEach(function(u){var g=Pe.get(u)-1,f=a.get(u)-1;Pe.set(u,g),a.set(u,f),g||(pt.has(u)||u.removeAttribute(s),pt.delete(u)),f||u.removeAttribute(t)}),bn--,bn||(Pe=new WeakMap,Pe=new WeakMap,pt=new WeakMap,mt={})}},iu=function(n,e,t){t===void 0&&(t="data-aria-hidden");var s=Array.from(Array.isArray(n)?n:[n]),r=ru(n);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live]"))),ou(s,r,t,"aria-hidden")):function(){return null}},Gt="Dialog",[ho,po]=Dn(Gt),[lu,te]=ho(Gt),mo=n=>{const{__scopeDialog:e,children:t,open:s,defaultOpen:r,onOpenChange:a,modal:o=!0}=n,i=h.useRef(null),c=h.useRef(null),[d,m]=$i({prop:s,defaultProp:r??!1,onChange:a,caller:Gt});return l.jsx(lu,{scope:e,triggerRef:i,contentRef:c,contentId:tn(),titleId:tn(),descriptionId:tn(),open:d,onOpenChange:m,onOpenToggle:h.useCallback(()=>m(u=>!u),[m]),modal:o,children:t})};mo.displayName=Gt;var go="DialogTrigger",_o=h.forwardRef((n,e)=>{const{__scopeDialog:t,...s}=n,r=te(go,t),a=G(e,r.triggerRef);return l.jsx(ee.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":fs(r.open),...s,ref:a,onClick:J(n.onClick,r.onOpenToggle)})});_o.displayName=go;var us="DialogPortal",[cu,bo]=ho(us,{forceMount:void 0}),wo=n=>{const{__scopeDialog:e,forceMount:t,children:s,container:r}=n,a=te(us,e);return l.jsx(cu,{scope:e,forceMount:t,children:h.Children.map(s,o=>l.jsx(xe,{present:t||a.open,children:l.jsx(Di,{asChild:!0,container:r,children:o})}))})};wo.displayName=us;var Lt="DialogOverlay",yo=h.forwardRef((n,e)=>{const t=bo(Lt,n.__scopeDialog),{forceMount:s=t.forceMount,...r}=n,a=te(Lt,n.__scopeDialog);return a.modal?l.jsx(xe,{present:s||a.open,children:l.jsx(du,{...r,ref:e})}):null});yo.displayName=Lt;var uu=ji("DialogOverlay.RemoveScroll"),du=h.forwardRef((n,e)=>{const{__scopeDialog:t,...s}=n,r=te(Lt,t);return l.jsx(uo,{as:uu,allowPinchZoom:!0,shards:[r.contentRef],children:l.jsx(ee.div,{"data-state":fs(r.open),...s,ref:e,style:{pointerEvents:"auto",...s.style}})})}),ve="DialogContent",vo=h.forwardRef((n,e)=>{const t=bo(ve,n.__scopeDialog),{forceMount:s=t.forceMount,...r}=n,a=te(ve,n.__scopeDialog);return l.jsx(xe,{present:s||a.open,children:a.modal?l.jsx(fu,{...r,ref:e}):l.jsx(hu,{...r,ref:e})})});vo.displayName=ve;var fu=h.forwardRef((n,e)=>{const t=te(ve,n.__scopeDialog),s=h.useRef(null),r=G(e,t.contentRef,s);return h.useEffect(()=>{const a=s.current;if(a)return iu(a)},[]),l.jsx(xo,{...n,ref:r,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:J(n.onCloseAutoFocus,a=>{a.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:J(n.onPointerDownOutside,a=>{const o=a.detail.originalEvent,i=o.button===0&&o.ctrlKey===!0;(o.button===2||i)&&a.preventDefault()}),onFocusOutside:J(n.onFocusOutside,a=>a.preventDefault())})}),hu=h.forwardRef((n,e)=>{const t=te(ve,n.__scopeDialog),s=h.useRef(!1),r=h.useRef(!1);return l.jsx(xo,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{n.onCloseAutoFocus?.(a),a.defaultPrevented||(s.current||t.triggerRef.current?.focus(),a.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:a=>{n.onInteractOutside?.(a),a.defaultPrevented||(s.current=!0,a.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=a.target;t.triggerRef.current?.contains(o)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&r.current&&a.preventDefault()}})}),xo=h.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:a,...o}=n,i=te(ve,t),c=h.useRef(null),d=G(e,c);return vc(),l.jsxs(l.Fragment,{children:[l.jsx(to,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:a,children:l.jsx(Ti,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":fs(i.open),...o,ref:d,onDismiss:()=>i.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(mu,{titleId:i.titleId}),l.jsx(_u,{contentRef:c,descriptionId:i.descriptionId})]})]})}),ds="DialogTitle",So=h.forwardRef((n,e)=>{const{__scopeDialog:t,...s}=n,r=te(ds,t);return l.jsx(ee.h2,{id:r.titleId,...s,ref:e})});So.displayName=ds;var Co="DialogDescription",Ao=h.forwardRef((n,e)=>{const{__scopeDialog:t,...s}=n,r=te(Co,t);return l.jsx(ee.p,{id:r.descriptionId,...s,ref:e})});Ao.displayName=Co;var Eo="DialogClose",Ro=h.forwardRef((n,e)=>{const{__scopeDialog:t,...s}=n,r=te(Eo,t);return l.jsx(ee.button,{type:"button",...s,ref:e,onClick:J(n.onClick,()=>r.onOpenChange(!1))})});Ro.displayName=Eo;function fs(n){return n?"open":"closed"}var Po="DialogTitleWarning",[pu,No]=ki(Po,{contentName:ve,titleName:ds,docsSlug:"dialog"}),mu=({titleId:n})=>{const e=No(Po),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return h.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},gu="DialogDescriptionWarning",_u=({contentRef:n,descriptionId:e})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${No(gu).contentName}}.`;return h.useEffect(()=>{const r=n.current?.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(s))},[s,n,e]),null},bu=mo,wu=_o,yu=wo,vu=yo,xu=vo,Su=So,Cu=Ao,Io=Ro,Oo="AlertDialog",[Au,ad]=Dn(Oo,[po]),de=po(),To=n=>{const{__scopeAlertDialog:e,...t}=n,s=de(e);return l.jsx(bu,{...s,...t,modal:!0})};To.displayName=Oo;var Eu="AlertDialogTrigger",ko=h.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...s}=n,r=de(t);return l.jsx(wu,{...r,...s,ref:e})});ko.displayName=Eu;var Ru="AlertDialogPortal",$o=n=>{const{__scopeAlertDialog:e,...t}=n,s=de(e);return l.jsx(yu,{...s,...t})};$o.displayName=Ru;var Pu="AlertDialogOverlay",Do=h.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...s}=n,r=de(t);return l.jsx(vu,{...r,...s,ref:e})});Do.displayName=Pu;var $e="AlertDialogContent",[Nu,Iu]=Au($e),Ou=Mi("AlertDialogContent"),jo=h.forwardRef((n,e)=>{const{__scopeAlertDialog:t,children:s,...r}=n,a=de(t),o=h.useRef(null),i=G(e,o),c=h.useRef(null);return l.jsx(pu,{contentName:$e,titleName:Mo,docsSlug:"alert-dialog",children:l.jsx(Nu,{scope:t,cancelRef:c,children:l.jsxs(xu,{role:"alertdialog",...a,...r,ref:i,onOpenAutoFocus:J(r.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[l.jsx(Ou,{children:s}),l.jsx(ku,{contentRef:o})]})})})});jo.displayName=$e;var Mo="AlertDialogTitle",Lo=h.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...s}=n,r=de(t);return l.jsx(Su,{...r,...s,ref:e})});Lo.displayName=Mo;var Fo="AlertDialogDescription",Bo=h.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...s}=n,r=de(t);return l.jsx(Cu,{...r,...s,ref:e})});Bo.displayName=Fo;var Tu="AlertDialogAction",Wo=h.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...s}=n,r=de(t);return l.jsx(Io,{...r,...s,ref:e})});Wo.displayName=Tu;var Uo="AlertDialogCancel",qo=h.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...s}=n,{cancelRef:r}=Iu(Uo,t),a=de(t),o=G(e,r);return l.jsx(Io,{...a,...s,ref:o})});qo.displayName=Uo;var ku=({contentRef:n})=>{const e=`\`${$e}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${$e}\` by passing a \`${Fo}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${$e}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return h.useEffect(()=>{document.getElementById(n.current?.getAttribute("aria-describedby"))||console.warn(e)},[e,n]),null},$u=To,Du=ko,ju=$o,Ho=Do,Vo=jo,zo=Wo,Xo=qo,Ko=Lo,Jo=Bo;const Mu=$u,Lu=Du,Fu=ju,Yo=h.forwardRef(({className:n,...e},t)=>l.jsx(Ho,{className:oe("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e,ref:t}));Yo.displayName=Ho.displayName;const Go=h.forwardRef(({className:n,...e},t)=>l.jsxs(Fu,{children:[l.jsx(Yo,{}),l.jsx(Vo,{ref:t,className:oe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...e})]}));Go.displayName=Vo.displayName;const Qo=({className:n,...e})=>l.jsx("div",{className:oe("flex flex-col space-y-2 text-center sm:text-left",n),...e});Qo.displayName="AlertDialogHeader";const Zo=({className:n,...e})=>l.jsx("div",{className:oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",n),...e});Zo.displayName="AlertDialogFooter";const ei=h.forwardRef(({className:n,...e},t)=>l.jsx(Ko,{ref:t,className:oe("text-lg font-semibold",n),...e}));ei.displayName=Ko.displayName;const ti=h.forwardRef(({className:n,...e},t)=>l.jsx(Jo,{ref:t,className:oe("text-sm text-muted-foreground",n),...e}));ti.displayName=Jo.displayName;const ni=h.forwardRef(({className:n,...e},t)=>l.jsx(zo,{ref:t,className:oe(ir(),n),...e}));ni.displayName=zo.displayName;const si=h.forwardRef(({className:n,...e},t)=>l.jsx(Xo,{ref:t,className:oe(ir({variant:"outline"}),"mt-2 sm:mt-0",n),...e}));si.displayName=Xo.displayName;const od=({children:n})=>{const e=Ci(),t=Ai(),{user:s,isAdmin:r,logout:a}=or(),{canAccess:o,currentPlan:i}=Li(),{preloadOnHover:c,preloadOnIdle:d}=Hi(),[m,u]=h.useState(!1),g=qi();h.useEffect(()=>{g||u(!1)},[g]),h.useEffect(()=>(g&&m?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[g,m]),h.useEffect(()=>{d()},[d]);const f=y=>{e(y),g&&u(!1)},v=()=>{u(!1)},_=[{icon:ui,label:"Dashboard",path:"/dashboard",requiredFeature:"dashboard"},{icon:di,label:"Funcionários",path:"/gestao-funcionarios",requiredFeature:"dashboard"},{icon:fi,label:"Pagamentos",path:"/pagamentos",requiredFeature:"payments"},{icon:hi,label:"Resumo do Dia",path:"/resumo-dia",requiredFeature:"dailySummary"},{icon:pi,label:"Saldos",path:"/saldos",requiredFeature:"balances"},{icon:mi,label:"Relatórios",path:"/relatorios",requiredFeature:"reports"},{icon:gi,label:"Histórico",path:"/historico",requiredFeature:"history"},{icon:We,label:"Assistente AI",path:"/assistente",requiredFeature:"dashboard"},{icon:_i,label:"Planos",path:"/planos",requiredFeature:"dashboard"},...r||s?.email==="diegkamor@gmail.com"?[{icon:bi,label:"Afiliados",path:"/afiliados",requiredFeature:"dashboard"}]:[]].filter(y=>o(y.requiredFeature)),C=[{icon:wi,label:"Perfil",path:"/perfil"},{icon:yi,label:"Configurações",path:"/settings"},...r||s?.email==="diegkamor@gmail.com"?[{icon:vi,label:"Admin",path:"/admin",requiredFeature:"advancedPanel"}]:[]],x=y=>t.pathname===y,b=()=>{a(),e("/"),Be.success("Logout realizado com sucesso!")};return l.jsxs("div",{className:"min-h-screen flex w-full bg-background overflow-hidden",children:[g&&l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-sidebar border-b border-sidebar-border/50 z-50 lg:hidden shadow-lg",children:l.jsxs("div",{className:"flex items-center justify-between p-4",children:[l.jsx("button",{onClick:()=>u(!0),className:"p-2 rounded-lg hover:bg-sidebar-accent transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"Abrir menu",children:l.jsx(xi,{className:"h-6 w-6 text-foreground"})}),l.jsxs("button",{onClick:()=>f("/dashboard"),className:"flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-primary/50 rounded-lg p-1","aria-label":"Ir para Dashboard",children:[l.jsxs("svg",{className:"w-8 h-8 text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M6 3h12l4 6-10 13L2 9l4-6z"}),l.jsx("path",{d:"M11 3 8 9l4 13 4-13-3-6"}),l.jsx("path",{d:"M2 9h20"})]}),l.jsx("h1",{className:"text-xl font-black text-foreground",children:"Optify"})]}),l.jsx("div",{className:"w-10"})," "]})}),g&&m&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden transition-opacity duration-300",onClick:v,"aria-hidden":"true"}),l.jsxs("aside",{className:`
        w-64 sm:w-72 lg:w-80 bg-sidebar border-r border-sidebar-border flex flex-col shadow-xl 
        fixed left-0 top-0 h-screen z-50 overflow-y-auto
        transition-transform duration-300 ease-in-out
        ${g?m?"translate-x-0":"-translate-x-full":"translate-x-0"}
      `,children:[l.jsxs("div",{className:"p-8 border-b border-sidebar-border/50",children:[g&&l.jsx("div",{className:"flex justify-end mb-4",children:l.jsx("button",{onClick:()=>u(!1),className:"p-2 rounded-lg hover:bg-sidebar-accent transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"Fechar menu",children:l.jsx(ar,{className:"h-5 w-5 text-foreground"})})}),l.jsxs("button",{onClick:()=>f("/dashboard"),className:"flex items-center gap-3 mb-4",children:[l.jsxs("svg",{className:"w-10 h-10 text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M6 3h12l4 6-10 13L2 9l4-6z"}),l.jsx("path",{d:"M11 3 8 9l4 13 4-13-3-6"}),l.jsx("path",{d:"M2 9h20"})]}),l.jsx("h1",{className:"text-2xl font-black text-foreground",children:"Optify"})]}),l.jsxs("div",{className:"px-4 py-2 rounded-xl bg-primary/10 border border-primary/20",children:[l.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Plano Atual"}),l.jsx("p",{className:"text-sm font-bold text-primary capitalize",children:i})]})]}),l.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:_.map(y=>l.jsxs("button",{onClick:()=>f(y.path),onMouseEnter:()=>c(y.path),className:`w-full flex items-center gap-4 px-5 py-4 rounded-2xl transition-all group ${x(y.path)?"bg-gradient-primary text-primary-foreground shadow-glow scale-105":"hover:bg-sidebar-accent text-muted-foreground hover:text-foreground hover:scale-105"}`,children:[l.jsx(y.icon,{className:`h-5 w-5 ${x(y.path)?"":"group-hover:scale-110 transition-transform"}`}),l.jsx("span",{className:"text-sm font-semibold",children:y.label})]},y.path))}),l.jsxs("div",{className:"p-3 border-t border-sidebar-border/50 space-y-1",children:[C.map(y=>l.jsxs("button",{onClick:()=>f(y.path),onMouseEnter:()=>c(y.path),className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all ${x(y.path)?"bg-gradient-primary text-primary-foreground shadow-glow":"hover:bg-sidebar-accent text-muted-foreground hover:text-foreground"}`,children:[l.jsx(y.icon,{className:"h-4 w-4"}),l.jsx("span",{className:"text-sm font-semibold",children:y.label})]},y.path)),l.jsxs(Mu,{children:[l.jsx(Lu,{asChild:!0,children:l.jsxs(Ue,{variant:"ghost",className:"w-full justify-start gap-3 px-4 py-2.5 text-destructive hover:text-destructive hover:bg-destructive/10 rounded-xl",children:[l.jsx(Si,{className:"h-4 w-4"}),l.jsx("span",{className:"text-sm font-semibold",children:"Sair"})]})}),l.jsxs(Go,{className:"bg-card border-border",children:[l.jsxs(Qo,{children:[l.jsx(ei,{className:"text-foreground",children:"Confirmar Logout"}),l.jsx(ti,{className:"text-muted-foreground",children:"Tem certeza que deseja sair da sua conta? Você precisará fazer login novamente para acessar o sistema."})]}),l.jsxs(Zo,{children:[l.jsx(si,{className:"bg-muted hover:bg-muted/80 text-foreground border-border",children:"Cancelar"}),l.jsx(ni,{onClick:b,className:"bg-destructive hover:bg-destructive/90 text-destructive-foreground",children:"Sair da Conta"})]})]})]})]})]}),l.jsx("main",{className:`
        flex-1 overflow-y-auto bg-gradient-to-br from-background to-background/95 
        ${g?"ml-0 pt-16":"ml-64 sm:ml-72 lg:ml-80"}
      `,children:l.jsx("div",{className:"p-4 sm:p-6 lg:p-8 max-w-[1600px] mx-auto w-full",children:n})}),l.jsx(hc,{})]})};export{Mu as A,xu as C,od as D,to as F,vu as O,yu as P,uo as R,Za as S,Su as T,Go as a,Qo as b,ei as c,ti as d,Zo as e,si as f,ni as g,iu as h,Lu as i,Io as j,Cu as k,bu as l,wu as m,Zl as n,dn as o,Gl as p,vc as u};
