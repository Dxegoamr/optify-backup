import{Y as A,j as e,T as k,a as y,i as f,m as s,U as p,e as g,C,S as R,_ as D,Z as v}from"./ui-vendor-BKTCjC1N.js";import{r as m}from"./react-vendor-a_rYd-gI.js";import{D as S}from"./DashboardLayout-q6rxeK_Q.js";import{B as P,i as E,j as w,k as j,C as L}from"./index-SqI1anxU.js";import{S as B}from"./switch-94Pl6eVQ.js";import{e as h}from"./env-14fk--Ss.js";import{A as U,b as I,a as H}from"./alert-YkppbXb9.js";import"./firebase-vendor-DKIO36wX.js";import"./input-D95wG3bR.js";import"./index-DIdW4MCp.js";import"./chart-vendor-2xH8hKrZ.js";import"./index-CdAzXW5_.js";function T(){return A({mutationFn:async a=>{console.log("🔍 Hook - URL da API:",h.API_URL),console.log("🔍 Hook - Payload:",a);try{const r=await fetch(`${h.API_URL}/createPaymentPreference`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(console.log("🔍 Hook - Status da resposta:",r.status),!r.ok){let n;try{n=await r.json()}catch{n={error:r.statusText}}throw console.error("❌ Hook - Erro da API:",n),new Error(n.error||`Erro HTTP ${r.status}: ${r.statusText}`)}const i=await r.json();return console.log("✅ Hook - Resposta da API:",i),i}catch(r){throw console.error("❌ Hook - Erro na fetch:",r),r}},onError:a=>{console.error("❌ Hook - Erro na mutation:",a)},onSuccess:a=>{console.log("✅ Hook - Mutation bem-sucedida:",a)}})}const M=({onClose:a})=>{const[r,i]=m.useState(!1),[n,c]=m.useState(!1);m.useEffect(()=>{(async()=>{try{const b=await fetch("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",{method:"HEAD",mode:"no-cors"});i(!1)}catch{i(!0)}})()},[]),m.useEffect(()=>{localStorage.getItem("adBlockerWarningDismissed")&&c(!0)},[]);const x=()=>{c(!0),localStorage.setItem("adBlockerWarningDismissed","true"),a?.()};return n||!r?null:e.jsxs(U,{className:"border-amber-500 bg-amber-500/10 mb-4",children:[e.jsx(k,{className:"h-4 w-4 text-amber-500"}),e.jsx(I,{className:"text-amber-500 font-semibold",children:"Aviso: Bloqueador de Anúncios Detectado"}),e.jsxs(H,{className:"mt-2 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"Seu bloqueador de anúncios pode interferir com o processo de pagamento do Mercado Pago."}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Para resolver:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Desabilite temporariamente o bloqueador de anúncios"}),e.jsx("li",{children:"Ou adicione o Mercado Pago à lista de exceções"}),e.jsx("li",{children:"Ou use o modo de navegação anônima"})]})]}),e.jsx("div",{className:"flex gap-2 mt-3",children:e.jsx(P,{variant:"outline",size:"sm",onClick:x,className:"h-8",children:"Entendi"})})]})]})},J=()=>{const{user:a}=E(),{currentPlan:r}=w(),[i,n]=m.useState(!1),c=T(),x={free:0,standard:1,medium:2,ultimate:3},d=t=>{const o=x[r]||0;return(x[t]||0)<o},u={free:[{text:"Dashboard básico",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de 1 funcionário",icon:p},{text:"Registro de transações do dia atual",icon:s},{text:"Depósitos e saques básicos",icon:s},{text:"Visualização do calendário (mês atual)",icon:s},{text:"Calendário Anterior",icon:s,blocked:!0},{text:"Pagamentos",icon:s,blocked:!0},{text:"Relatórios",icon:s,blocked:!0},{text:"Saldo de Contas",icon:s,blocked:!0},{text:"Histórico",icon:s,blocked:!0}],standard:[{text:"Dashboard básico",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de até 5 funcionários",icon:p},{text:"Registro de transações do dia atual",icon:s},{text:"Depósitos e saques",icon:s},{text:"Relatórios básicos",icon:g},{text:"Visualização do calendário (mês atual)",icon:s},{text:"Suporte por email",icon:s},{text:"Calendário Anterior",icon:s,blocked:!0},{text:"Pagamentos",icon:s,blocked:!0},{text:"Saldo de Contas",icon:s,blocked:!0},{text:"Histórico",icon:s,blocked:!0}],medium:[{text:"Dashboard completo",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de até 10 funcionários",icon:p},{text:"Registro de transações",icon:s},{text:"Depósitos e saques",icon:s},{text:"Calendário Anterior",icon:s},{text:"Pagamentos",icon:s},{text:"Relatórios avançados",icon:g},{text:"Saldo de Contas",icon:s},{text:"Histórico completo",icon:s}],ultimate:[{text:"Dashboard completo e avançado",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de até 50 funcionários",icon:p},{text:"Registro de transações ilimitadas",icon:s},{text:"Depósitos e saques",icon:s},{text:"Calendário Anterior",icon:s},{text:"Pagamentos",icon:s},{text:"Relatórios avançados",icon:g},{text:"Saldo de Contas",icon:s},{text:"Histórico completo",icon:s},{text:"CPA Chinesa",icon:C,exclusive:!0},{text:"Painel Avançado",icon:R,exclusive:!0},{text:"Dutchuing Bot",icon:D,exclusive:!0},{text:"Integrações avançadas",icon:v,exclusive:!0},{text:"API personalizada",icon:v,exclusive:!0},{text:"Suporte prioritário",icon:s,exclusive:!0},{text:"Suporte dedicado",icon:s,exclusive:!0}]},b=async t=>{if(!a){f.error("Você precisa estar logado para assinar um plano");return}if(t==="free"){f.error("O plano Free já está ativo");return}try{console.log("🔍 Debug - Variáveis de ambiente:",{API_URL:h.API_URL,PUBLIC_KEY:h.MERCADO_PAGO_PUBLIC_KEY}),console.log("🔍 Debug - Dados do payload:",{userId:a.uid,userEmail:a.email||"",userName:a.displayName||a.email?.split("@")[0]||"Usuário",planId:t,billingType:i?"annual":"monthly"});const o=await c.mutateAsync({userId:a.uid,userEmail:a.email||"",userName:a.displayName||a.email?.split("@")[0]||"Usuário",planId:t,billingType:i?"annual":"monthly"});console.log("✅ Preferência criada:",o);const l=o.checkout_url||o.init_point||o.sandbox_init_point;if(!l)throw console.error("❌ Nenhuma URL de checkout disponível:",o),new Error("URL de checkout não retornada pelo Mercado Pago");console.log("🔗 Redirecionando para:",l),c.reset(),window.location.href=l}catch(o){console.error("❌ Erro ao criar preferência:",o);const l=o instanceof Error?o.message:"Erro desconhecido";f.error(`Erro ao processar pagamento: ${l}`),c.reset()}},N=[{name:"Free",value:"free",price:0,period:"Grátis",annualPrice:0,features:u.free,current:r==="free",popular:!1,description:"Testar o sistema"},{name:"Standard",value:"standard",price:34.9,period:"mês",annualPrice:356.76,features:u.standard,current:r==="standard",popular:!1,description:"Pequenos negócios"},{name:"Medium",value:"medium",price:49.9,period:"mês",annualPrice:509.16,features:u.medium,current:r==="medium",popular:!0,description:"Médias empresas"},{name:"Ultimate",value:"ultimate",price:74.9,period:"mês",annualPrice:764.76,features:u.ultimate,current:r==="ultimate",popular:!1,description:"Grandes empresas"}];return e.jsx(S,{children:e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsx(M,{}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Escolha seu Plano"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Selecione o plano ideal para o seu negócio"}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("span",{className:i?"text-muted-foreground":"font-semibold",children:"Mensal"}),e.jsx(B,{checked:i,onCheckedChange:n}),e.jsxs("span",{className:i?"font-semibold":"text-muted-foreground",children:["Anual",e.jsx(j,{variant:"default",className:"ml-2",children:"15% OFF"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:N.map(t=>e.jsxs(L,{className:`
                p-6 relative shadow-card card-hover flex flex-col h-full
                ${t.popular?"border-primary border-2":""}
                ${d(t.value)?"opacity-60":""}
              `,children:[t.popular&&e.jsx(j,{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:"Mais Popular"}),t.current&&e.jsx(j,{variant:"outline",className:"absolute -top-3 left-1/2 -translate-x-1/2",children:"Plano Atual"}),e.jsxs("div",{className:"flex flex-col h-full space-y-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:t.description}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-4xl font-bold",children:["R$ ",(i?t.annualPrice/12:t.price).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),t.price>0&&e.jsxs("span",{className:"text-muted-foreground",children:["/",t.period]})]}),i&&t.price>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Valor anual: R$ ",t.annualPrice.toLocaleString("pt-BR",{minimumFractionDigits:2}),e.jsx("br",{}),"Economia de R$ ",(t.price*12-t.annualPrice).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsx("div",{className:"flex-grow space-y-3",children:t.features.map((o,l)=>e.jsxs("div",{className:"flex items-start gap-2",children:[o.blocked?e.jsx("div",{className:"h-5 w-5 shrink-0 mt-0.5 rounded-full border-2 border-muted-foreground/30 flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 rounded-full bg-muted-foreground/30"})}):e.jsx(o.icon,{className:`h-5 w-5 shrink-0 mt-0.5 ${o.exclusive?"text-primary":"text-success"}`}),e.jsxs("span",{className:`text-sm ${o.blocked?"text-muted-foreground/60":""} ${o.exclusive?"text-primary font-medium":""}`,children:[o.text,o.exclusive&&e.jsx("span",{className:"ml-1 text-xs",children:"(exclusivo)"})]})]},l))}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(P,{className:"w-full",variant:t.current?"outline":"default",disabled:t.current||c.isPending||d(t.value),onClick:()=>!t.current&&!d(t.value)&&b(t.value),children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4 animate-spin"}),"Redirecionando..."]}):t.current?"Plano Atual":d(t.value)?"Plano Menor":"Assinar"})})]})]},t.name))}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"Todos os planos incluem 7 dias de teste grátis"}),e.jsx("p",{children:"Cancele a qualquer momento, sem taxas adicionais"})]})]})})};export{J as default};
