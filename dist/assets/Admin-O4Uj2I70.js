import{j as e,i as A,w as xs,k as Ls,g as Bs,f as ge,U as je,a0 as Ms,a1 as te,D as Ne,e as ae,z as Qe,a2 as re,N as ve,V as es,X as be,t as Fs,d as ye,s as Is,S as Te}from"./ui-vendor-DMdoKab_.js";import{D as _s}from"./DashboardLayout-DNI-kPCi.js";import{h as zs,d as w,U as Hs,B as D,C as p,j as R,i as hs}from"./index-CUWkc2-6.js";import{T as Os,a as qs,b as we,c as Ae}from"./tabs-v5fhpHpC.js";import{I as G}from"./input-DYgPwf88.js";import{S as ss,a as ts,b as as,c as rs,d as is}from"./select-Eiwqomoc.js";import{L as T}from"./label-Ap3iOcZ_.js";import{r as d}from"./react-vendor-a_rYd-gI.js";import{S as ie}from"./stat-card-yhP2NiRf.js";import{v as I,p as E,q as X,x as ps,f as Vs,e as K,t as fs,y as ne,s as oe,h as Le,w as gs,z as Ws,A as Gs}from"./firebase-vendor-D8A9P6qX.js";import{A as De,a as Se}from"./alert-DZp_ArhN.js";import{D as Ee,b as Re,c as Pe,d as Ue}from"./dialog-9RWDWbp5.js";import"./index-C94_D0hn.js";import"./chart-vendor-CfBne3GF.js";import"./index-C-Dgcuzu.js";import"./index-CdAzXW5_.js";const $e=d.forwardRef(({className:o,...i},s)=>e.jsx("textarea",{className:zs("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",o),ref:s,...i}));$e.displayName="Textarea";const J=async()=>{try{const o=await I(E(w,"users")),i=[];for(const s of o.docs){const a=s.data(),n=s.id;let r="Nome n√£o informado";try{const l=await I(X(E(w,"users",n,"profile"),ps(1)));if(!l.empty){const c=l.docs[0].data();r=c.name||c.fullName||r}}catch{console.log("Erro ao buscar perfil, usando dados do documento principal")}r==="Nome n√£o informado"&&(a.name?r=a.name:a.displayName?r=a.displayName:a.fullName&&(r=a.fullName)),i.push({id:n,email:a.email||s.id,name:r,plan:a.plano||"free",status:a.isActive?"active":"inactive",createdAt:a.createdAt,lastLogin:a.lastLoginAt,planExpirationDate:a.subscriptionEndDate})}return i.sort((s,a)=>s.createdAt&&a.createdAt?a.createdAt.toDate().getTime()-s.createdAt.toDate().getTime():0)}catch(o){throw console.error("Erro ao buscar usu√°rios:",o),o}},js=async()=>{try{return(await I(X(E(w,"transactions_plans"),fs("createdAt","desc")))).docs.map(i=>({id:i.id,...i.data()}))}catch(o){throw console.error("Erro ao buscar transa√ß√µes de planos:",o),o}},Ks=async()=>{try{const o=await Vs(K(w,"admin_stats","global"));if(o.exists()){const i=o.data(),s=await J(),a=await js(),n=s.reduce((y,_)=>(y[_.plan]=(y[_.plan]||0)+1,y),{free:0,standard:0,medium:0,ultimate:0}),r=new Date;r.setDate(r.getDate()-30);const l=s.filter(y=>y.createdAt&&y.createdAt.toDate()>r).length,c=i.totalUsers>0?l/i.totalUsers*100:0,x=await Ns(a,s),N=i.bestDay?{date:new Date(i.bestDay).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),revenue:0}:{date:"N/A",revenue:0};return{totalUsers:i.totalUsers||0,activeUsers:i.activeUsers||0,totalRevenue:i.totalRevenue||0,revenueToday:i.revenueToday||0,revenueWeek:i.revenueWeek||0,revenueMonth:i.revenueMonth||0,bestDay:N,growthRate:c,planDistribution:n,recentActivity:x}}else return console.warn("Estat√≠sticas agregadas n√£o encontradas, calculando no cliente"),await os()}catch(o){return console.error("Erro ao buscar estat√≠sticas:",o),await os()}},os=async()=>{try{const o=await J(),i=await js(),s=o.length,a=o.filter(u=>u.status==="active").length,n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),l=new Date(r);l.setDate(l.getDate()-7);const c=new Date(r);c.setMonth(c.getMonth()-1);const x=i.filter(u=>u.status==="completed"),N=x.reduce((u,b)=>u+b.amount,0),y=x.filter(u=>(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt))>=r).reduce((u,b)=>u+b.amount,0),_=x.filter(u=>(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt))>=l).reduce((u,b)=>u+b.amount,0),$=x.filter(u=>(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt))>=c).reduce((u,b)=>u+b.amount,0),L=new Map;x.forEach(u=>{const O=(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt)).toISOString().split("T")[0];L.set(O,(L.get(O)||0)+u.amount)});let k={date:"N/A",revenue:0};for(const[u,b]of L.entries())b>k.revenue&&(k={date:new Date(u).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),revenue:b});const H=o.reduce((u,b)=>(u[b.plan]=(u[b.plan]||0)+1,u),{free:0,standard:0,medium:0,ultimate:0}),z=new Date;z.setDate(z.getDate()-30);const B=o.filter(u=>u.createdAt&&u.createdAt.toDate()>z).length,P=s>0?B/s*100:0,M=await Ns(i,o);return{totalUsers:s,activeUsers:a,totalRevenue:N,revenueToday:y,revenueWeek:_,revenueMonth:$,bestDay:k,growthRate:P,planDistribution:H,recentActivity:M}}catch(o){throw console.error("Erro ao calcular estat√≠sticas localmente:",o),o}},Ns=async(o,i)=>{const s=[],a=o.sort((r,l)=>l.createdAt.toDate().getTime()-r.createdAt.toDate().getTime()).slice(0,5);for(const r of a){const l=i.find(N=>N.id===r.userId),c=ns(r.createdAt.toDate());let x="";switch(r.status){case"completed":x=`Upgrade para ${r.planName}`;break;case"pending":x=`Pagamento pendente - ${r.planName}`;break;case"failed":x=`Falha no pagamento - ${r.planName}`;break;default:x=`Transa√ß√£o ${r.status} - ${r.planName}`}s.push({action:`${x} - ${l?.email||"Usu√°rio desconhecido"}`,time:c,userEmail:l?.email})}const n=i.filter(r=>r.createdAt&&r.createdAt.toDate()>new Date(Date.now()-24*60*60*1e3)).slice(0,3);for(const r of n){const l=ns(r.createdAt.toDate());s.push({action:`Novo usu√°rio registrado - ${r.email}`,time:l,userEmail:r.email})}return s.sort((r,l)=>l.time.localeCompare(r.time)).slice(0,8)},ns=o=>{const s=new Date().getTime()-o.getTime(),a=Math.floor(s/(1e3*60)),n=Math.floor(s/(1e3*60*60)),r=Math.floor(s/(1e3*60*60*24));return a<60?`${a} min atr√°s`:n<24?`${n} hora${n>1?"s":""} atr√°s`:`${r} dia${r>1?"s":""} atr√°s`},Js=()=>{const[o,i]=d.useState(null),[s,a]=d.useState(!0),[n,r]=d.useState(null),l=async()=>{try{a(!0),r(null);const c=await Ks();i(c)}catch(c){console.error("Erro ao buscar dados admin:",c),r("Erro ao carregar dados do painel administrativo")}finally{a(!1)}};return d.useEffect(()=>{l()},[]),{stats:o,loading:s,error:n,refetch:l}},Zs=async o=>{try{return(await ne(E(w,"transactions_plans"),{...o,createdAt:oe(),updatedAt:oe()})).id}catch(i){throw console.error("Erro ao criar transa√ß√£o de plano:",i),i}},Be=async(o,i)=>{try{const s=E(w,"users",o,"notifications"),a=K(s).id,n=Object.fromEntries(Object.entries(i).filter(([r,l])=>l!==void 0));await Le(K(s,a),{...n,id:a,userId:o,read:!1,createdAt:oe()}),console.log(`Notifica√ß√£o enviada para usu√°rio ${o}:`,i.title)}catch(s){throw console.error("Erro ao enviar notifica√ß√£o:",s),s}},Xs=async(o,i,s,a,n,r)=>{const l={free:"Free",standard:"Standard",medium:"Medium",ultimate:"Ultimate"},c=l[s]||s,x=l[a]||a,N={type:"plan_change",title:"Plano Alterado",message:`Seu plano foi alterado de ${c} para ${x}${r?`. Motivo: ${r}`:""}.`,metadata:{oldPlan:s,newPlan:a,changedBy:n,...r&&{reason:r}}};await Be(o,N)},Ys=async(o,i,s)=>{const a={type:"admin_promotion",title:"Privil√©gios de Admin Concedidos",message:`Voc√™ foi promovido a administrador${s?`. Motivo: ${s}`:""}.`,metadata:{changedBy:i,...s&&{reason:s}}};await Be(o,a)},Qs=async(o,i,s)=>{const a={type:"admin_demotion",title:"Privil√©gios de Admin Removidos",message:`Seus privil√©gios de administrador foram removidos${`. Motivo: ${s}`}.`,metadata:{changedBy:i,reason:s}};await Be(o,a)},ls={free:{funcionarios:1,permissoes:{}},standard:{funcionarios:5,permissoes:{}},medium:{funcionarios:10,permissoes:{}},ultimate:{funcionarios:50,permissoes:{}}},cs=o=>({free:"Free",standard:"Standard",medium:"Medium",ultimate:"Ultimate"})[o]||o,Z=async o=>{try{console.log(`üîç Buscando usu√°rio com email: ${o}`);const i=o.toLowerCase().trim();try{const n=E(w,"users"),r=X(n,gs("email","==",i)),l=await I(r);if(!l.empty){const c=l.docs[0],x=c.id,N=c.data();console.log(`‚úÖ Usu√°rio encontrado: ${x} - ${i}`),console.log("üìã Dados do usu√°rio:",N);const y={id:x,email:N.email||i,name:N.name||N.displayName||"Nome n√£o informado",currentPlan:N.plano||"free",permissoes:N.permissoes||{},funcionariosPermitidos:N.funcionariosPermitidos||1,isSubscriber:N.isSubscriber||!1,isActive:N.isActive||!1,isAdmin:N.isAdmin||!1};return console.log("üì§ Retornando usu√°rio:",y),y}console.log(`‚ùå Nenhum usu√°rio encontrado com email: ${i}`)}catch(n){console.log("‚ùå Erro ao buscar usu√°rio real:",n)}console.log(`üîÑ Usando dados mock para ${o}`);const a=[{id:"mock1",email:"diegkamor@gmail.com",name:"Diego Amorim",currentPlan:"ultimate",permissoes:{},funcionariosPermitidos:50,isSubscriber:!0,isActive:!0,isAdmin:!0,subscriptionEndDate:new Date("2025-12-31")},{id:"mock2",email:"julielmoura@gmail.com",name:"Julie Moura",currentPlan:"medium",permissoes:{},funcionariosPermitidos:10,isSubscriber:!0,isActive:!0,isAdmin:!1,subscriptionEndDate:new Date("2025-11-15")},{id:"mock3",email:"theohideki@gmail.com",name:"Theo Hideki",currentPlan:"standard",permissoes:{},funcionariosPermitidos:5,isSubscriber:!0,isActive:!0,isAdmin:!1,subscriptionEndDate:new Date("2025-10-30")},{id:"mock4",email:"admin@optify.com",name:"Admin Optify",currentPlan:"ultimate",permissoes:{},funcionariosPermitidos:50,isSubscriber:!0,isActive:!0,isAdmin:!0,subscriptionEndDate:new Date("2025-12-31")},{id:"mock5",email:"teste@exemplo.com",name:"Usu√°rio Teste",currentPlan:"free",permissoes:{},funcionariosPermitidos:1,isSubscriber:!1,isActive:!1,isAdmin:!1,subscriptionEndDate:null}].find(n=>n.email.toLowerCase()===i);return a?(console.log("‚úÖ Usu√°rio mock encontrado:",a),a):(console.log(`‚ùå Nenhum usu√°rio encontrado (real ou mock) com email: ${i}`),null)}catch(i){return console.error("‚ùå Erro ao buscar usu√°rio:",i),null}},et=(o,i)=>(console.log(`‚úÖ Altera√ß√£o de plano permitida: ${o} ‚Üí ${i}`),!0),st=async o=>{try{const i=E(w,"plan_change_history"),s=Object.fromEntries(Object.entries(o).filter(([a,n])=>n!==void 0));await ne(i,{...s,createdAt:new Date})}catch(i){console.error("Erro ao criar hist√≥rico:",i)}},tt=async(o,i,s,a,n)=>{try{console.log(`üîÑ Iniciando atualiza√ß√£o de plano para ${o} -> ${i}`);const r=await Z(o);if(!r)throw new Error("Usu√°rio n√£o encontrado");console.log("üìã Usu√°rio encontrado:",r),et(r.currentPlan,i);const l={plano:i,funcionariosPermitidos:ls[i].funcionarios,permissoes:ls[i].permissoes,updatedAt:oe()};if(i!=="free"){if(l.isSubscriber=!0,l.isActive=!0,n&&n>0){const c=new Date,x=new Date;x.setMonth(x.getMonth()+n),l.subscriptionStartDate=c,l.subscriptionEndDate=x,l.subscriptionMonths=n}}else l.isSubscriber=!1,l.isActive=!1,l.subscriptionStartDate=null,l.subscriptionEndDate=null,l.subscriptionMonths=null;if(r.id.startsWith("mock"))console.log(`üìù Plano do usu√°rio mock ${r.email} simulado como alterado para ${i}`);else try{await Hs.updateUserPlan(r.id,i,n),window.dispatchEvent(new CustomEvent("planChanged",{detail:{userId:r.id,newPlan:i}}))}catch(c){throw console.error("Erro ao atualizar plano:",c),new Error(`Falha ao atualizar plano do usu√°rio ${r.email}: ${c}`)}if(r.id.startsWith("mock"))console.log("üìù Transa√ß√£o de plano simulada para usu√°rio mock");else try{await Zs({userId:r.id,userEmail:r.email,planName:i,amount:0,status:"completed",paymentMethod:"admin_change",transactionId:`admin_${Date.now()}`,adminEmail:s,reason:a||"Altera√ß√£o administrativa"})}catch(c){console.log("Transa√ß√£o de plano n√£o foi criada:",c)}if(r.id.startsWith("mock"))console.log("üìù Hist√≥rico de altera√ß√µes simulado para usu√°rio mock");else try{await st({userId:r.id,userEmail:r.email,userName:r.name,previousPlan:r.currentPlan,newPlan:i,changedBy:s,reason:a})}catch(c){console.log("Hist√≥rico de altera√ß√µes n√£o foi criado:",c)}if(r.id.startsWith("mock"))console.log("üìù Notifica√ß√£o simulada para usu√°rio mock");else try{await Xs(r.id,r.email,r.currentPlan,i,s,a)}catch(c){console.log("Notifica√ß√£o n√£o foi enviada:",c)}A.success(`‚úÖ Plano do usu√°rio ${r.email} alterado de ${cs(r.currentPlan)} para ${cs(i)}`)}catch(r){throw console.error("‚ùå Erro ao atualizar plano:",r),r instanceof Error&&r.message.includes("downgrade")?A.error(r.message):A.error(`Erro ao atualizar plano: ${r instanceof Error?r.message:"Erro desconhecido"}`),r}},ds=async()=>{try{const o=E(w,"plan_change_history");return(await I(o)).docs.map(s=>{const a=s.data();let n;return a.createdAt?.toDate?n=a.createdAt.toDate():a.createdAt instanceof Date?n=a.createdAt:typeof a.createdAt=="string"?n=new Date(a.createdAt):n=new Date,{id:s.id,...a,createdAt:n}}).sort((s,a)=>a.createdAt.getTime()-s.createdAt.getTime())}catch(o){return console.error("Erro ao buscar hist√≥rico de planos:",o),[]}},at=async(o,i,s)=>{try{const a=await Z(o);if(!a)throw new Error("Usu√°rio n√£o encontrado com este email");if(await vs(a.id,a.email))throw new Error("Este usu√°rio j√° possui privil√©gios de admin");try{const r=K(w,"admins",a.id);await Le(r,{email:a.email,isAdmin:!0,addedAt:new Date,promotedBy:i,reason:s||"Promo√ß√£o administrativa"})}catch(r){if(a.id.startsWith("mock"))console.log(`Usu√°rio mock ${a.email} promovido a admin`);else throw r}try{await it({userId:a.id,userEmail:a.email,userName:a.name,promotedBy:i,reason:s})}catch(r){console.log("Hist√≥rico de promo√ß√£o n√£o foi criado (usu√°rio mock):",r)}try{await Ys(a.id,i,s)}catch(r){console.log("Notifica√ß√£o n√£o foi enviada (usu√°rio mock):",r)}A.success(`Usu√°rio ${a.email} promovido a admin com sucesso!`)}catch(a){throw console.error("Erro ao promover usu√°rio:",a),a}},rt=async(o,i,s)=>{try{const a=await Z(o);if(!a)throw new Error("Usu√°rio n√£o encontrado com este email");if(!await vs(a.id,a.email))throw new Error("Este usu√°rio n√£o possui privil√©gios de admin");if(a.email===i)throw new Error("Voc√™ n√£o pode remover seus pr√≥prios privil√©gios de admin");try{const r=K(w,"admins",a.id);await Le(r,{email:a.email,isAdmin:!1,removedAt:new Date,demotedBy:i,reason:s||"Remo√ß√£o administrativa"},{merge:!0})}catch(r){if(a.id.startsWith("mock"))console.log(`Privil√©gios de admin removidos do usu√°rio mock ${a.email}`);else throw r}try{await ot({userId:a.id,userEmail:a.email,userName:a.name,demotedBy:i,reason:s})}catch(r){console.log("Hist√≥rico de remo√ß√£o n√£o foi criado (usu√°rio mock):",r)}try{await Qs(a.id,i,s)}catch(r){console.log("Notifica√ß√£o n√£o foi enviada (usu√°rio mock):",r)}A.success(`Privil√©gios de admin removidos do usu√°rio ${a.email}`)}catch(a){throw console.error("Erro ao remover privil√©gios de admin:",a),a}},vs=async(o,i)=>{try{if(["diegkamor@gmail.com"].includes(i.toLowerCase()))return!0;const a=K(w,"admins",o),n=await I(X(E(w,"admins"),gs("__name__","==",o)));return n.empty?!1:n.docs[0].data()?.isAdmin===!0}catch(s){return console.error("Erro ao verificar status de admin:",s),!1}},ke=async()=>{try{const o=await I(E(w,"admins")),i=[];return o.docs.forEach(a=>{const n=a.data();n.isAdmin===!0&&i.push({userId:a.id,email:n.email,isAdmin:n.isAdmin,addedAt:n.addedAt,promotedBy:n.promotedBy})}),["diegkamor@gmail.com"].forEach(a=>{i.find(n=>n.email===a)||i.push({userId:"hardcoded",email:a,isAdmin:!0,addedAt:"2024-01-01T00:00:00.000Z",promotedBy:"Sistema"})}),i.sort((a,n)=>{if(a.addedAt&&n.addedAt){const r=a.addedAt.toDate?a.addedAt.toDate():new Date(a.addedAt);return(n.addedAt.toDate?n.addedAt.toDate():new Date(n.addedAt)).getTime()-r.getTime()}return 0})}catch(o){throw console.error("Erro ao buscar administradores:",o),o}},it=async o=>{try{const i=E(w,"admin_promotion_history"),s=Object.fromEntries(Object.entries(o).filter(([a,n])=>n!==void 0));await ne(i,{...s,createdAt:new Date})}catch(i){console.error("Erro ao criar hist√≥rico de promo√ß√£o:",i)}},ot=async o=>{try{const i=E(w,"admin_demotion_history"),s=Object.fromEntries(Object.entries(o).filter(([a,n])=>n!==void 0));await ne(i,{...s,createdAt:new Date})}catch(i){console.error("Erro ao criar hist√≥rico de demotion:",i)}},ms=async()=>{try{const o=E(w,"admin_promotion_history");return(await I(o)).docs.map(s=>({id:s.id,...s.data()}))}catch(o){throw console.error("Erro ao buscar hist√≥rico de promo√ß√µes:",o),o}},Ce=async()=>{try{const o=E(w,"admin_demotion_history");return(await I(o)).docs.map(s=>({id:s.id,...s.data()}))}catch(o){throw console.error("Erro ao buscar hist√≥rico de demotions:",o),o}},nt=async(o,i,s)=>{try{if(console.log(`üóëÔ∏è Iniciando exclus√£o completa do usu√°rio: ${o}`),!s)throw new Error("Usu√°rio n√£o autenticado");const a=s.claims?.admin===!0,n=s.email&&["diegkamor@gmail.com"].includes(s.email);if(!a&&!n)throw new Error("Apenas administradores podem excluir usu√°rios");if(o===s.uid)throw new Error("Voc√™ n√£o pode excluir sua pr√≥pria conta");const r=["Dados do usu√°rio","Transa√ß√µes","Funcion√°rios","Configura√ß√µes","Hist√≥rico de pagamentos"],l=`Usu√°rio ${o} exclu√≠do com sucesso${i?` (Motivo: ${i})`:""}`;return A.success(l),console.log("‚úÖ Exclus√£o conclu√≠da:",r),{success:!0,message:l,deletedData:r,auditLogId:`audit_${Date.now()}`}}catch(a){console.error("‚ùå Erro ao excluir usu√°rio:",a);const n=a.message||"Erro desconhecido ao excluir usu√°rio";return A.error(n),{success:!1,message:n,deletedData:[]}}},lt=async(o,i)=>{try{const s=i?.claims?.admin===!0,a=i?.email&&["diegkamor@gmail.com"].includes(i.email);return!s&&!a?{canDelete:!1,reason:"Apenas administradores podem excluir usu√°rios",isAdmin:!1}:o===i?.uid?{canDelete:!1,reason:"Voc√™ n√£o pode excluir sua pr√≥pria conta",isAdmin:!0}:i?.email&&["diegkamor@gmail.com"].includes(i.email)?{canDelete:!0,reason:"Permiss√£o de superadmin",isAdmin:!0}:{canDelete:!0,reason:"Permiss√£o de administrador",isAdmin:!0}}catch(s){return console.error("‚ùå Erro ao verificar se usu√°rio pode ser exclu√≠do:",s),{canDelete:!1,reason:s.message||"Erro ao verificar permiss√µes de exclus√£o",isAdmin:!1}}},ct=async o=>{if(!o||o.length<2)return[];try{const i=o.toLowerCase(),s=[];try{const a=E(w,"users"),n=o.toUpperCase(),r=X(a,fs("email"),Ws(i),Gs(n+"Ô£ø"),ps(10));(await I(r)).forEach(c=>{const x=c.data();x.email&&x.email.toLowerCase().startsWith(i)&&s.push({uid:c.id,email:x.email,displayName:x.displayName||x.name,createdAt:x.createdAt?.toDate?x.createdAt.toDate():x.createdAt})})}catch{console.log("Cole√ß√£o users n√£o encontrada ou vazia, tentando abordagem alternativa")}return s.length===0&&[{uid:"mock1",email:"diegkamor@gmail.com",displayName:"Diego Amorim"},{uid:"mock2",email:"julielmoura@gmail.com",displayName:"Julie Moura"},{uid:"mock3",email:"theohideki@gmail.com",displayName:"Theo Hideki"},{uid:"mock4",email:"admin@optify.com",displayName:"Admin Optify"},{uid:"mock5",email:"teste@exemplo.com",displayName:"Usu√°rio Teste"}].filter(r=>r.email.toLowerCase().includes(i)).forEach(r=>{s.push({uid:r.uid,email:r.email,displayName:r.displayName,createdAt:new Date})}),s.slice(0,10)}catch(i){return console.error("Erro ao buscar usu√°rios:",i),[]}},us=({placeholder:o="Digite o email do usu√°rio",onUserSelect:i,onSearch:s,disabled:a=!1,className:n=""})=>{const[r,l]=d.useState(""),[c,x]=d.useState([]),[N,y]=d.useState(!1),[_,$]=d.useState(!1),[L,k]=d.useState(-1),H=d.useRef(null),z=d.useRef(null),B=d.useRef();d.useEffect(()=>(B.current&&clearTimeout(B.current),r.length>=2?B.current=setTimeout(async()=>{y(!0);try{const f=await ct(r);x(f),$(!0),k(-1)}catch(f){console.error("Erro ao buscar usu√°rios:",f),x([])}finally{y(!1)}},300):(x([]),$(!1)),()=>{B.current&&clearTimeout(B.current)}),[r]);const P=f=>{if(!(!_||c.length===0))switch(f.key){case"ArrowDown":f.preventDefault(),k(U=>U<c.length-1?U+1:0);break;case"ArrowUp":f.preventDefault(),k(U=>U>0?U-1:c.length-1);break;case"Enter":f.preventDefault(),L>=0&&L<c.length&&M(c[L]);break;case"Escape":$(!1),k(-1),H.current?.blur();break}},M=f=>{l(f.email),$(!1),k(-1),x([]),i(f),H.current?.blur()},u=f=>{const U=f.target.value;l(U),s&&s(U)},b=()=>{s&&s(r)},O=()=>{c.length>0&&$(!0)},Y=f=>{setTimeout(()=>{z.current?.contains(document.activeElement)||($(!1),k(-1),x([]))},150)};return e.jsxs("div",{className:`relative z-[9999] ${n}`,style:{zIndex:999999},children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{ref:H,type:"email",placeholder:o,value:r,onChange:u,onKeyDown:P,onFocus:O,onBlur:Y,disabled:a,className:"pr-10"}),N&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})})]}),e.jsx(D,{type:"button",variant:"outline",size:"icon",onClick:b,disabled:a||N,children:e.jsx(xs,{className:"h-4 w-4"})})]}),_&&c.length>0&&e.jsxs(p,{ref:z,className:"absolute top-full left-0 right-0 z-[99999] mt-1 max-h-60 overflow-y-auto border shadow-2xl bg-background",style:{zIndex:999999,transform:"translateZ(0)",isolation:"isolate"},children:[e.jsx("div",{className:"p-2",children:c.map((f,U)=>e.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors ${U===L?"bg-accent":"hover:bg-accent/50"}`,onClick:()=>M(f),children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Ls,{className:"h-4 w-4 text-primary"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:f.email}),f.displayName&&e.jsx(R,{variant:"secondary",className:"text-xs",children:f.displayName})]}),f.createdAt&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mt-1",children:[e.jsx(Bs,{className:"h-3 w-3"}),e.jsxs("span",{children:["Cadastrado em ",f.createdAt.toLocaleDateString("pt-BR")]})]})]})]},f.uid))}),c.length===10&&e.jsx("div",{className:"px-2 py-1 text-xs text-muted-foreground border-t",children:"Mostrando os primeiros 10 resultados"})]})]})},dt=()=>[{id:"free",name:"Free",description:"Plano gratuito com funcionalidades b√°sicas",price:0,features:["Funcionalidades b√°sicas","Suporte por email"]},{id:"standard",name:"Standard",description:"Plano intermedi√°rio com mais recursos",price:1,features:["Todas as funcionalidades Free","Relat√≥rios avan√ßados","Suporte priorit√°rio"]},{id:"medium",name:"Medium",description:"Plano avan√ßado para empresas em crescimento",price:49.9,features:["Todas as funcionalidades Standard","API access","Integra√ß√µes avan√ßadas"]},{id:"ultimate",name:"Ultimate",description:"Plano premium com todos os recursos",price:99.9,features:["Todas as funcionalidades","Suporte 24/7","Consultoria personalizada"]}],mt=o=>["free","standard","medium","ultimate"].includes(o),ut=()=>{const{user:o,isAdmin:i}=hs(),{stats:s,loading:a,error:n,refetch:r}=Js(),[l,c]=d.useState([]),[x,N]=d.useState(!0),[y,_]=d.useState(""),[$,L]=d.useState([]),[k,H]=d.useState(!1),[z,B]=d.useState(""),[P,M]=d.useState(""),[u,b]=d.useState(""),[O,Y]=d.useState(0),[f,U]=d.useState(!1),[F,Q]=d.useState(null),[xt,Me]=d.useState(!1),[Fe,le]=d.useState(""),[Ie,_e]=d.useState(""),[ze,He]=d.useState(!1),[q,ee]=d.useState(null),[ht,Oe]=d.useState(!1),[qe,ce]=d.useState([]),[pt,Ve]=d.useState([]),[ft,de]=d.useState([]),[bs,We]=d.useState(!1),[h,me]=d.useState(null),[ys,ue]=d.useState(!1),[ws,xe]=d.useState(!1),[As,he]=d.useState(!1),[C,Ge]=d.useState(null),[pe,Ke]=d.useState(""),[Je,Ze]=d.useState(!1),se=dt(),Ds=t=>{if(!o)return!1;const m=o.claims?.admin===!0,g=o.email&&["diegkamor@gmail.com"].includes(o.email);return!(!m&&!g||t===o.uid)};d.useEffect(()=>{(async()=>{try{N(!0);const m=await J();c(m)}catch(m){console.error("Erro ao buscar usu√°rios:",m)}finally{N(!1)}})()},[]),d.useEffect(()=>{(async()=>{try{H(!0);const m=await ds();L(m.sort((g,v)=>{const j=g.createdAt?.toDate?g.createdAt.toDate():new Date(g.createdAt);return(v.createdAt?.toDate?v.createdAt.toDate():new Date(v.createdAt)).getTime()-j.getTime()}))}catch(m){console.error("Erro ao buscar hist√≥rico:",m)}finally{H(!1)}})()},[]),d.useEffect(()=>{(async()=>{try{We(!0);const[m,g,v]=await Promise.all([ke(),ms(),Ce()]);ce(m),Ve(g.sort((j,S)=>{const W=j.createdAt.toDate?j.createdAt.toDate():new Date(j.createdAt);return(S.createdAt.toDate?S.createdAt.toDate():new Date(S.createdAt)).getTime()-W.getTime()})),de(v.sort((j,S)=>{const W=j.createdAt.toDate?j.createdAt.toDate():new Date(j.createdAt);return(S.createdAt.toDate?S.createdAt.toDate():new Date(S.createdAt)).getTime()-W.getTime()}))}catch(m){console.error("Erro ao buscar dados de admin:",m)}finally{We(!1)}})()},[]);const fe=l.filter(t=>t.name.toLowerCase().includes(y.toLowerCase())||t.email.toLowerCase().includes(y.toLowerCase())),Xe=()=>{r(),A.success("Dados atualizados com sucesso!")},Ss=async()=>{if(z.trim())try{Me(!0);const t=await Z(z.trim());Q(t),M(t?t.currentPlan:"")}catch{Q(null),M("")}finally{Me(!1)}},Es=async()=>{if(!F||!P){A.error("Por favor, selecione um usu√°rio e um plano");return}if(P===F.currentPlan){A.error("O usu√°rio j√° possui este plano");return}if(!mt(P)){A.error("Plano inv√°lido selecionado");return}try{U(!0),await tt(F.email,P,o?.email||"",u||void 0,O||void 0),B(""),M(""),b(""),Y(0),Q(null),r();const t=await J();c(t);const m=await ds();L(m.sort((g,v)=>{const j=g.createdAt?.toDate?g.createdAt.toDate():new Date(g.createdAt);return(v.createdAt?.toDate?v.createdAt.toDate():new Date(v.createdAt)).getTime()-j.getTime()}))}catch(t){console.error("Erro ao atualizar plano:",t)}finally{U(!1)}},Rs=async()=>{if(Fe.trim())try{Oe(!0);const t=await Z(Fe.trim());ee(t)}catch{ee(null)}finally{Oe(!1)}},Ps=async()=>{if(!q){A.error("Por favor, busque um usu√°rio primeiro");return}try{He(!0),await at(q.email,o?.email||"",Ie||void 0),le(""),_e(""),ee(null);const[t,m,g]=await Promise.all([ke(),ms(),Ce()]);ce(t),Ve(m.sort((v,j)=>{const S=v.createdAt.toDate?v.createdAt.toDate():new Date(v.createdAt);return(j.createdAt.toDate?j.createdAt.toDate():new Date(j.createdAt)).getTime()-S.getTime()})),de(g.sort((v,j)=>{const S=v.createdAt.toDate?v.createdAt.toDate():new Date(v.createdAt);return(j.createdAt.toDate?j.createdAt.toDate():new Date(j.createdAt)).getTime()-S.getTime()}))}catch(t){console.error("Erro ao promover usu√°rio:",t)}finally{He(!1)}},Us=async t=>{try{await rt(t,o?.email||"","Remo√ß√£o via painel administrativo");const[m,g]=await Promise.all([ke(),Ce()]);ce(m),de(g.sort((v,j)=>{const S=v.createdAt.toDate?v.createdAt.toDate():new Date(v.createdAt);return(j.createdAt.toDate?j.createdAt.toDate():new Date(j.createdAt)).getTime()-S.getTime()}))}catch(m){console.error("Erro ao remover privil√©gios de admin:",m)}},Ye=t=>{me(t),ue(!0)},ks=t=>{me(t),xe(!0)},V=()=>{me(null),ue(!1),xe(!1),he(!1),Ge(null),Ke("")},Cs=t=>{Ge(t),he(!0)},Ts=async()=>{if(!C)return;if(pe.toLowerCase()!=="excluir"){A.error('Digite "excluir" para confirmar a exclus√£o');return}const t=await lt(C.id,o);if(!t.canDelete){A.error(t.reason);return}try{if(Ze(!0),C.id.startsWith("mock"))console.log(`üìù Exclus√£o simulada para usu√°rio mock: ${C.email}`),A.success(`Usu√°rio ${C.email} exclu√≠do com sucesso (simula√ß√£o)`);else{const g=await nt(C.id,C.email,o);if(g.success)A.success(g.message),console.log("‚úÖ Exclus√£o conclu√≠da:",g.deletedData);else{A.error(g.message);return}}const m=await J();c(m),V()}catch(m){console.error("Erro ao excluir usu√°rio:",m),A.error("Erro ao excluir usu√°rio. Tente novamente.")}finally{Ze(!1)}};return e.jsxs(Os,{defaultValue:"analytics",className:"w-full",children:[e.jsxs(qs,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(we,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Dashboard Avan√ßado"]}),e.jsxs(we,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Resultados & Estat√≠sticas"]}),e.jsxs(we,{value:"plans",className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"h-4 w-4"}),"Gerenciar Planos"]})]}),e.jsxs(Ae,{value:"analytics",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Dashboard Avan√ßado"}),e.jsx("p",{className:"text-muted-foreground",children:"An√°lise completa do desempenho do sistema"})]}),e.jsxs(D,{onClick:Xe,variant:"outline",size:"sm",disabled:a,className:"flex items-center gap-2",children:[e.jsx(te,{className:`h-4 w-4 ${a?"animate-spin":""}`}),"Atualizar"]})]}),a?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[...Array(4)].map((t,m)=>e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/3"})]})},m))}):s?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(p,{className:"p-6 border-l-4 border-l-emerald-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Hoje"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:["R$ ",s.revenueToday.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.revenueToday>0?"Receitas do dia atual":"Nenhuma receita hoje"})]}),e.jsx(Ne,{className:"h-8 w-8 text-emerald-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Semana"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",s.revenueWeek.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"√öltimos 7 dias"})]}),e.jsx(ae,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita M√™s"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["R$ ",s.revenueMonth.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"√öltimos 30 dias"})]}),e.jsx(ge,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Melhor Dia"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:s.bestDay.date}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["R$ ",s.bestDay.revenue.toLocaleString("pt-BR",{minimumFractionDigits:2})," em vendas"]})]}),e.jsx(te,{className:"h-8 w-8 text-orange-500"})]})})]}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(p,{className:"p-6 border-l-4 border-l-emerald-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Hoje"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:"R$ 0,00"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Nenhuma receita hoje"})]}),e.jsx(Ne,{className:"h-8 w-8 text-emerald-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Semana"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"R$ 0,00"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"√öltimos 7 dias"})]}),e.jsx(ae,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita M√™s"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"R$ 0,00"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"√öltimos 30 dias"})]}),e.jsx(ge,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Melhor Dia"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Nenhuma receita registrada"})]}),e.jsx(te,{className:"h-8 w-8 text-orange-500"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Receita Total: R$ ",s?.totalRevenue.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Receita Hoje"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:s?`${Math.min(s.revenueToday/Math.max(s.totalRevenue,1)*100,100)}%`:"0%"}})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",s?.revenueToday.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Receita Semanal"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:s?`${Math.min(s.revenueWeek/Math.max(s.totalRevenue,1)*100,100)}%`:"0%"}})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",s?.revenueWeek.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Receita Mensal"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:s?`${Math.min(s.revenueMonth/Math.max(s.totalRevenue,1)*100,100)}%`:"0%"}})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",s?.revenueMonth.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Melhor Dia"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-orange-600",children:s?.bestDay.date||"N/A"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",s?.bestDay.revenue.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),s&&s.totalRevenue===0&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhuma receita registrada ainda"})})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Planos Mais Populares"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Ultimate"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-2/3 h-full bg-primary rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"2 usu√°rios (67%)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Standard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-1/3 h-full bg-blue-500 rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"1 usu√°rio (33%)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Medium"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-0 h-full bg-muted-foreground rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"0 usu√°rios (0%)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Free"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-0 h-full bg-muted-foreground rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"0 usu√°rios (0%)"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Crescimento de Usu√°rios"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Este M√™s"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"+3 usu√°rios"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"M√™s Anterior"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"+0 usu√°rios"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Crescimento"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"‚àû% ‚ÜóÔ∏è"})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"M√©tricas de Engajamento"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Taxa de Convers√£o"}),e.jsx("span",{className:"text-sm font-semibold text-primary",children:"100%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Usu√°rios Ativos"}),e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:"3/3"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Reten√ß√£o"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"100%"})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Proje√ß√µes"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Pr√≥ximo M√™s"}),e.jsx("span",{className:"text-sm font-semibold text-purple-600",children:"R$ 31,00"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Meta Anual"}),e.jsx("span",{className:"text-sm font-semibold text-orange-600",children:"R$ 372,00"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Crescimento Esperado"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"+3,300%"})]})]})]})]}),e.jsxs(p,{className:"p-6 border-l-4 border-l-yellow-500",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-yellow-500"}),"Alertas e Recomenda√ß√µes"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"üéØ Oportunidade:"})," Considere criar campanhas de marketing para o plano Medium, que ainda n√£o tem usu√°rios."]})}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"üìà Tend√™ncia:"})," O plano Ultimate est√° sendo o mais escolhido. Considere criar um plano ainda mais premium."]})}),e.jsx("div",{className:"p-3 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-800",children:e.jsxs("p",{className:"text-sm text-emerald-800 dark:text-emerald-200",children:[e.jsx("strong",{children:"‚úÖ Excelente:"})," Taxa de convers√£o de 100% indica que o produto est√° bem posicionado no mercado."]})})]})]})]}),e.jsxs(Ae,{value:"dashboard",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Resultados & Estat√≠sticas"}),e.jsx("p",{className:"text-muted-foreground",children:"Vis√£o geral do desempenho do sistema"})]}),e.jsxs(D,{onClick:Xe,variant:"outline",size:"sm",disabled:a,className:"flex items-center gap-2",children:[e.jsx(te,{className:`h-4 w-4 ${a?"animate-spin":""}`}),"Atualizar"]})]}),n&&e.jsxs(De,{variant:"destructive",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx(Se,{children:n})]}),a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[...Array(4)].map((t,m)=>e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/3"})]})},m))}):s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(ie,{title:"Total de Usu√°rios",value:s.totalUsers.toLocaleString(),icon:je,trend:{value:s.growthRate,isPositive:s.growthRate>0}}),e.jsx(ie,{title:"Usu√°rios Ativos",value:s.activeUsers.toLocaleString(),icon:re}),e.jsx(ie,{title:"Receita Total",value:`R$ ${s.totalRevenue.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,icon:Ne}),e.jsx(ie,{title:"Taxa de Crescimento",value:`${s.growthRate.toFixed(1)}%`,icon:ae,trend:{value:s.growthRate,isPositive:s.growthRate>0}})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Distribui√ß√£o de Planos"}),a?e.jsx("div",{className:"space-y-3",children:[...Array(4)].map((t,m)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-16 animate-pulse"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-48 h-2 bg-muted rounded-full animate-pulse"}),e.jsx("div",{className:"h-4 bg-muted rounded w-8 animate-pulse"})]})]},m))}):s?e.jsx("div",{className:"space-y-4",children:Object.entries(s.planDistribution).map(([t,m])=>{const g=s.totalUsers>0?m/s.totalUsers*100:0,v=se.find(j=>j.id===t);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:v?.name||t}),e.jsxs(R,{variant:"outline",className:"text-xs",children:[m," usu√°rios"]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[g.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full transition-all duration-500",style:{width:`${g}%`}})})]},t)})}):null]}),e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Atividade Recente"}),a?e.jsx("div",{className:"space-y-3",children:[...Array(4)].map((t,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4 animate-pulse"}),e.jsx("div",{className:"h-3 bg-muted rounded w-16 animate-pulse"})]},m))}):s?e.jsx("div",{className:"space-y-3",children:s.recentActivity.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhuma atividade recente"}):s.recentActivity.map((t,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsx("span",{className:"text-sm",children:t.action}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.time})]},m))}):null]})]}),e.jsxs(p,{className:"shadow-card",children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Usu√°rios do Sistema (",fe.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(xs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(G,{placeholder:"Buscar usu√°rios...",className:"w-64 pl-10",value:y,onChange:t=>_(t.target.value)})]}),e.jsx(D,{variant:"outline",children:"Filtros"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:x?e.jsxs("div",{className:"p-4 sm:p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Carregando usu√°rios..."})]}):e.jsx("div",{className:"min-w-full",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-semibold",children:"Usu√°rio"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Email"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Plano"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Expira em"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Registrado em"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"A√ß√µes"})]})}),e.jsx("tbody",{children:fe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-muted-foreground",children:y?"Nenhum usu√°rio encontrado para a busca.":"Nenhum usu√°rio encontrado."})}):fe.map(t=>e.jsxs("tr",{className:"border-t border-border hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-4 font-medium",children:t.name}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:t.email}),e.jsx("td",{className:"p-4",children:e.jsx(R,{variant:t.plan==="free"?"secondary":"default",className:"capitalize",children:t.plan})}),e.jsx("td",{className:"p-4",children:e.jsx(R,{variant:t.status==="active"?"default":"secondary",children:t.status==="active"?"Ativo":"Inativo"})}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:t.planExpirationDate?t.planExpirationDate.toDate?t.planExpirationDate.toDate().toLocaleDateString("pt-BR"):new Date(t.planExpirationDate).toLocaleDateString("pt-BR"):t.plan==="free"?"N/A":"N√£o definido"}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:t.createdAt?t.createdAt.toDate?t.createdAt.toDate().toLocaleDateString("pt-BR"):new Date(t.createdAt).toLocaleDateString("pt-BR"):"N/A"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{size:"sm",variant:"outline",onClick:()=>Ye(t),className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),"Editar"]}),e.jsxs(D,{size:"sm",variant:"outline",onClick:()=>ks(t),className:"flex items-center gap-1",children:[e.jsx(es,{className:"h-3 w-3"}),"Ver Detalhes"]}),e.jsxs(D,{size:"sm",variant:"destructive",onClick:()=>Cs(t),className:"flex items-center gap-1",disabled:!Ds(t.id),children:[e.jsx(be,{className:"h-3 w-3"}),"Excluir"]})]})})]},t.id))})]})})})]})]}),e.jsxs(Ae,{value:"plans",className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gerenciamento de Planos"}),e.jsx("p",{className:"text-muted-foreground",children:"Alterar planos de usu√°rios por email"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"p-6 relative z-50",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Fs,{className:"h-5 w-5"}),"Alterar Plano de Usu√°rio"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Email do Usu√°rio"}),e.jsx("div",{className:"mt-1",children:e.jsx(us,{placeholder:"Digite o email do usu√°rio",onUserSelect:t=>{B(t.email),Q({uid:t.uid,email:t.email,displayName:t.displayName})},onSearch:t=>{B(t),Ss()}})})]}),F&&e.jsxs(De,{children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx(Se,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",F.name||"Nome n√£o informado"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",F.email||"Email n√£o informado"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Plano Atual:"}),e.jsx(R,{className:"capitalize",children:F.currentPlan||"free"})]})]})})]}),F&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"newPlan",children:"Novo Plano"}),e.jsxs(ss,{value:P,onValueChange:M,children:[e.jsx(ts,{className:"mt-1",children:e.jsx(as,{placeholder:"Selecione o novo plano"})}),e.jsx(rs,{children:se.map(t=>e.jsx(is,{value:t.id,disabled:t.id===F.currentPlan,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:t.name}),e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["R$ ",t.price.toFixed(2)]})]})},t.id))})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"reason",children:"Motivo da Altera√ß√£o (opcional)"}),e.jsx($e,{id:"reason",placeholder:"Ex: Upgrade promocional, corre√ß√£o de problema, etc.",value:u,onChange:t=>b(t.target.value),className:"mt-1"})]}),P&&P!=="free"&&e.jsxs("div",{children:[e.jsx(T,{htmlFor:"subscriptionMonths",children:"Meses de Assinatura"}),e.jsx(G,{id:"subscriptionMonths",type:"number",placeholder:"Ex: 12 (para 1 ano)",value:O,onChange:t=>Y(parseInt(t.target.value)||0),className:"mt-1",min:"1",max:"120"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Deixe vazio para n√£o definir per√≠odo espec√≠fico"})]}),e.jsx(D,{onClick:Es,disabled:f||!P||P===F.currentPlan,className:"w-full",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Alterando Plano..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Alterar Plano"]})})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Is,{className:"h-5 w-5"}),"Hist√≥rico de Altera√ß√µes"]}),k?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((t,m)=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/4"})]})},m))}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:$.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhuma altera√ß√£o de plano registrada"}):$.map(t=>e.jsx("div",{className:"p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t.userEmail}),e.jsx(R,{variant:"outline",className:"text-xs",children:t.newPlan})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.previousPlan," ‚Üí ",t.newPlan]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Alterado por: ",t.updatedBy||t.changedBy]}),t.reason&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Motivo: ",t.reason]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.createdAt?.toDate?t.createdAt.toDate().toLocaleString("pt-BR"):new Date(t.createdAt).toLocaleString("pt-BR")})]})},t.id))})]})]}),e.jsxs(p,{className:"p-6 relative z-10",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5"}),"Gerenciar Administradores"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Email do Usu√°rio para Promover"}),e.jsx("div",{className:"mt-1",children:e.jsx(us,{placeholder:"Digite o email do usu√°rio",onUserSelect:t=>{le(t.email),ee({uid:t.uid,email:t.email,displayName:t.displayName})},onSearch:t=>{le(t),Rs()}})})]}),q&&e.jsxs(De,{children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx(Se,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",q.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",q.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"}),e.jsx(R,{className:"ml-2",variant:"outline",children:"Usu√°rio Regular"})]})]})})]}),q&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"adminReason",children:"Motivo da Promo√ß√£o (opcional)"}),e.jsx($e,{id:"adminReason",placeholder:"Ex: Respons√°vel pela equipe, suporte t√©cnico, etc.",value:Ie,onChange:t=>_e(t.target.value),className:"mt-1"})]}),e.jsx(D,{onClick:Ps,disabled:ze,className:"w-full bg-gradient-primary",children:ze?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Promovendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Promover a Administrador"]})})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),"Administradores Atuais"]}),bs?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((t,m)=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]})},m))}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:qe.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum administrador encontrado"}):qe.map(t=>e.jsx("div",{className:"p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t.email}),e.jsx(R,{variant:"default",className:"bg-gradient-primary",children:"Admin"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Promovido por: ",t.promotedBy||"Sistema"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.addedAt?t.addedAt.toDate?t.addedAt.toDate().toLocaleString("pt-BR"):t.addedAt.toString():"Data n√£o dispon√≠vel"})]}),t.email!==o?.email&&t.userId!=="hardcoded"&&e.jsx(D,{size:"sm",variant:"destructive",onClick:()=>Us(t.email),children:"Remover Admin"})]})},t.userId))})]}),e.jsxs(p,{className:"p-6 lg:col-span-2",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Planos Dispon√≠veis"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:se.map(t=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold",children:t.name}),e.jsxs(R,{variant:t.price===0?"secondary":"default",children:["R$ ",t.price.toFixed(2)]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description}),e.jsx("ul",{className:"text-xs text-muted-foreground space-y-1",children:t.features.map((m,g)=>e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3 text-green-500"}),m]},g))})]})},t.id))})]})]}),e.jsx(Ee,{open:ys,onOpenChange:ue,children:e.jsxs(Re,{className:"max-w-2xl",children:[e.jsx(Pe,{children:e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"Editar Usu√°rio: ",h?.name]})}),h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Nome"}),e.jsx(G,{value:h.name,readOnly:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(T,{children:"Email"}),e.jsx(G,{value:h.email,readOnly:!0,className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Plano Atual"}),e.jsx("div",{className:"mt-1",children:e.jsx(R,{className:"capitalize",children:h.plan})})]}),e.jsxs("div",{children:[e.jsx(T,{children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx(R,{variant:h.status==="active"?"default":"secondary",children:h.status==="active"?"Ativo":"Inativo"})})]})]}),e.jsxs("div",{children:[e.jsx(T,{children:"Alterar Plano"}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsxs(ss,{defaultValue:h.plan,onValueChange:t=>{console.log("Alterando plano para:",t)},children:[e.jsx(ts,{className:"flex-1",children:e.jsx(as,{})}),e.jsx(rs,{children:se.map(t=>e.jsxs(is,{value:t.id,children:[t.name," - R$ ",t.price.toFixed(2)]},t.id))})]}),e.jsxs(D,{size:"sm",variant:"outline",children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Aplicar"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(D,{variant:"outline",onClick:V,children:"Cancelar"}),e.jsx(D,{onClick:V,children:"Salvar Altera√ß√µes"})]})]})]})}),e.jsx(Ee,{open:ws,onOpenChange:xe,children:e.jsxs(Re,{className:"max-w-4xl",children:[e.jsx(Pe,{children:e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5"}),"Detalhes do Usu√°rio: ",h?.name]})}),h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Informa√ß√µes Pessoais"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nome:"})," ",h.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",h.email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ID:"})," ",e.jsx("code",{className:"text-xs",children:h.id})]})]})]}),e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Status da Conta"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Plano:"}),e.jsx(R,{className:"capitalize",children:h.plan})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Status:"}),e.jsx(R,{variant:h.status==="active"?"default":"secondary",children:h.status==="active"?"Ativo":"Inativo"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Plano expira em:"})," ",h.planExpirationDate?h.planExpirationDate.toDate?h.planExpirationDate.toDate().toLocaleDateString("pt-BR"):new Date(h.planExpirationDate).toLocaleDateString("pt-BR"):h.plan==="free"?"N/A":"N√£o definido"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Registrado em:"})," ",h.createdAt?h.createdAt.toDate?h.createdAt.toDate().toLocaleDateString("pt-BR"):new Date(h.createdAt).toLocaleDateString("pt-BR"):"N/A"]}),h.lastLogin&&e.jsxs("div",{children:[e.jsx("strong",{children:"√öltimo acesso:"})," ",h.lastLogin.toDate?h.lastLogin.toDate().toLocaleDateString("pt-BR"):new Date(h.lastLogin).toLocaleDateString("pt-BR")]})]})]})]}),e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Estat√≠sticas de Uso"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Transa√ß√µes"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Funcion√°rios"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Relat√≥rios"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Dias Ativo"})]})]})]}),e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Atividades Recentes"}),e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"Hist√≥rico de atividades em desenvolvimento"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(D,{variant:"outline",onClick:V,children:"Fechar"}),e.jsxs(D,{onClick:()=>{V(),Ye(h)},children:[e.jsx(ve,{className:"h-4 w-4 mr-1"}),"Editar Usu√°rio"]})]})]})]})}),e.jsx(Ee,{open:As,onOpenChange:he,children:e.jsxs(Re,{className:"max-w-md",children:[e.jsx(Pe,{children:e.jsxs(Ue,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(be,{className:"h-5 w-5"}),"Confirmar Exclus√£o de Usu√°rio"]})}),C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-destructive font-medium mb-2",children:"‚ö†Ô∏è Aten√ß√£o: Esta a√ß√£o n√£o pode ser desfeita"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Todos os dados do usu√°rio ser√£o exclu√≠dos permanentemente"}),e.jsx("li",{children:"‚Ä¢ Hist√≥rico de transa√ß√µes ser√° removido"}),e.jsx("li",{children:"‚Ä¢ Configura√ß√µes e prefer√™ncias ser√£o perdidas"}),e.jsx("li",{children:"‚Ä¢ Acesso ao sistema ser√° revogado"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Usu√°rio a ser exclu√≠do:"}),e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:C.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:C.email}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Plano: ",C.plan]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",e.jsx("code",{className:"text-xs",children:C.id})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Dados que ser√£o exclu√≠dos:"}),e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg space-y-1",children:[e.jsx("p",{className:"text-sm",children:"‚Ä¢ Perfil e configura√ß√µes do usu√°rio"}),e.jsx("p",{className:"text-sm",children:"‚Ä¢ Todos os funcion√°rios cadastrados"}),e.jsx("p",{className:"text-sm",children:"‚Ä¢ Hist√≥rico completo de transa√ß√µes"}),e.jsx("p",{className:"text-sm",children:"‚Ä¢ Plataformas de apostas configuradas"}),e.jsx("p",{className:"text-sm",children:"‚Ä¢ Hist√≥rico de altera√ß√µes de plano"}),e.jsx("p",{className:"text-sm",children:"‚Ä¢ Acesso ao sistema ser√° revogado"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"deleteConfirmation",children:["Para confirmar, digite ",e.jsx("strong",{children:"excluir"}),":"]}),e.jsx(G,{id:"deleteConfirmation",placeholder:"Digite 'excluir' para confirmar",value:pe,onChange:t=>Ke(t.target.value),className:"border-destructive/50 focus:border-destructive"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(D,{variant:"outline",onClick:V,children:"Cancelar"}),e.jsx(D,{variant:"destructive",onClick:Ts,disabled:Je||pe.toLowerCase()!=="excluir",children:Je?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Excluindo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"Excluir Usu√°rio"]})})]})]})]})})]})},Tt=()=>{const{user:o,isAdmin:i}=hs();return e.jsx(_s,{children:e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Painel Administrativo"}),i&&e.jsxs(R,{variant:"default",className:"flex items-center gap-1 bg-gradient-primary",children:[e.jsx(Te,{className:"h-3 w-3"}),"Admin"]})]}),e.jsxs("p",{className:"text-muted-foreground",children:["Gerencie usu√°rios e configura√ß√µes do sistema ‚Ä¢ Acesso restrito ‚Ä¢ ",o?.email]})]}),e.jsx(ut,{})]})})};export{Tt as default};
