import{j as e,i as y,w as hs,k as Ms,g as Fs,f as ge,U as je,a0 as Is,a1 as te,D as Ne,e as ae,z as Qe,a2 as re,N as ve,V as es,X as be,t as _s,d as ye,s as zs,S as Te}from"./ui-vendor-DMdoKab_.js";import{D as Hs}from"./DashboardLayout-BNnpgSfq.js";import{h as Os,d as w,U as qs,t as ps,B as D,C as p,j as R,i as fs}from"./index-MMaOp97q.js";import{T as Ws,a as Vs,b as we,c as Ae}from"./tabs-CLdhBkt5.js";import{I as G}from"./input-D6b4lu7-.js";import{S as ss,a as ts,b as as,c as rs,d as is}from"./select-C54CQDgK.js";import{L as T}from"./label-q-UNE6UY.js";import{r as d}from"./react-vendor-a_rYd-gI.js";import{S as ie}from"./stat-card-4xcZwZCz.js";import{x as I,q as E,t as X,y as gs,f as Gs,e as K,v as js,z as ne,s as oe,h as Le,w as Ns,p as vs,A as Ks,B as Js}from"./firebase-vendor-DEAn5-oL.js";import{A as De,a as Se}from"./alert-bN4T_1HH.js";import{D as Ee,b as Re,c as Ue,d as Pe}from"./dialog-qq9rBAXf.js";import"./index-Xg25hJTs.js";import"./chart-vendor-CfBne3GF.js";import"./index-C-Dgcuzu.js";import"./index-CdAzXW5_.js";const $e=d.forwardRef(({className:o,...i},t)=>e.jsx("textarea",{className:Os("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",o),ref:t,...i}));$e.displayName="Textarea";const J=async()=>{try{const o=await I(E(w,"users")),i=[];for(const t of o.docs){const a=t.data(),n=t.id;let r="Nome não informado";try{const l=await I(X(E(w,"users",n,"profile"),gs(1)));if(!l.empty){const c=l.docs[0].data();r=c.name||c.fullName||r}}catch{console.log("Erro ao buscar perfil, usando dados do documento principal")}r==="Nome não informado"&&(a.name?r=a.name:a.displayName?r=a.displayName:a.fullName&&(r=a.fullName)),i.push({id:n,email:a.email||t.id,name:r,plan:a.plano||"free",status:a.isActive?"active":"inactive",createdAt:a.createdAt,lastLogin:a.lastLoginAt,planExpirationDate:a.subscriptionEndDate})}return i.sort((t,a)=>t.createdAt&&a.createdAt?a.createdAt.toDate().getTime()-t.createdAt.toDate().getTime():0)}catch(o){throw console.error("Erro ao buscar usuários:",o),o}},bs=async()=>{try{return(await I(X(E(w,"transactions_plans"),js("createdAt","desc")))).docs.map(i=>({id:i.id,...i.data()}))}catch(o){throw console.error("Erro ao buscar transações de planos:",o),o}},Zs=async()=>{try{const o=await Gs(K(w,"admin_stats","global"));if(o.exists()){const i=o.data(),t=await J(),a=await bs(),n=t.reduce((b,_)=>(b[_.plan]=(b[_.plan]||0)+1,b),{free:0,standard:0,medium:0,ultimate:0}),r=new Date;r.setDate(r.getDate()-30);const l=t.filter(b=>b.createdAt&&b.createdAt.toDate()>r).length,c=i.totalUsers>0?l/i.totalUsers*100:0,x=await ys(a,t),j=i.bestDay?{date:new Date(i.bestDay).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),revenue:0}:{date:"N/A",revenue:0};return{totalUsers:i.totalUsers||0,activeUsers:i.activeUsers||0,totalRevenue:i.totalRevenue||0,revenueToday:i.revenueToday||0,revenueWeek:i.revenueWeek||0,revenueMonth:i.revenueMonth||0,bestDay:j,growthRate:c,planDistribution:n,recentActivity:x}}else return console.warn("Estatísticas agregadas não encontradas, calculando no cliente"),await os()}catch(o){return console.error("Erro ao buscar estatísticas:",o),await os()}},os=async()=>{try{const o=await J(),i=await bs(),t=o.length,a=o.filter(u=>u.status==="active").length,n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),l=new Date(r);l.setDate(l.getDate()-7);const c=new Date(r);c.setMonth(c.getMonth()-1);const x=i.filter(u=>u.status==="completed"),j=x.reduce((u,v)=>u+v.amount,0),b=x.filter(u=>(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt))>=r).reduce((u,v)=>u+v.amount,0),_=x.filter(u=>(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt))>=l).reduce((u,v)=>u+v.amount,0),$=x.filter(u=>(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt))>=c).reduce((u,v)=>u+v.amount,0),L=new Map;x.forEach(u=>{const O=(u.createdAt?.toDate?u.createdAt.toDate():new Date(u.createdAt)).toISOString().split("T")[0];L.set(O,(L.get(O)||0)+u.amount)});let k={date:"N/A",revenue:0};for(const[u,v]of L.entries())v>k.revenue&&(k={date:new Date(u).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),revenue:v});const H=o.reduce((u,v)=>(u[v.plan]=(u[v.plan]||0)+1,u),{free:0,standard:0,medium:0,ultimate:0}),z=new Date;z.setDate(z.getDate()-30);const B=o.filter(u=>u.createdAt&&u.createdAt.toDate()>z).length,U=t>0?B/t*100:0,M=await ys(i,o);return{totalUsers:t,activeUsers:a,totalRevenue:j,revenueToday:b,revenueWeek:_,revenueMonth:$,bestDay:k,growthRate:U,planDistribution:H,recentActivity:M}}catch(o){throw console.error("Erro ao calcular estatísticas localmente:",o),o}},ys=async(o,i)=>{const t=[],a=o.sort((r,l)=>l.createdAt.toDate().getTime()-r.createdAt.toDate().getTime()).slice(0,5);for(const r of a){const l=i.find(j=>j.id===r.userId),c=ns(r.createdAt.toDate());let x="";switch(r.status){case"completed":x=`Upgrade para ${r.planName}`;break;case"pending":x=`Pagamento pendente - ${r.planName}`;break;case"failed":x=`Falha no pagamento - ${r.planName}`;break;default:x=`Transação ${r.status} - ${r.planName}`}t.push({action:`${x} - ${l?.email||"Usuário desconhecido"}`,time:c,userEmail:l?.email})}const n=i.filter(r=>r.createdAt&&r.createdAt.toDate()>new Date(Date.now()-24*60*60*1e3)).slice(0,3);for(const r of n){const l=ns(r.createdAt.toDate());t.push({action:`Novo usuário registrado - ${r.email}`,time:l,userEmail:r.email})}return t.sort((r,l)=>l.time.localeCompare(r.time)).slice(0,8)},ns=o=>{const t=new Date().getTime()-o.getTime(),a=Math.floor(t/(1e3*60)),n=Math.floor(t/(1e3*60*60)),r=Math.floor(t/(1e3*60*60*24));return a<60?`${a} min atrás`:n<24?`${n} hora${n>1?"s":""} atrás`:`${r} dia${r>1?"s":""} atrás`},Xs=()=>{const[o,i]=d.useState(null),[t,a]=d.useState(!0),[n,r]=d.useState(null),l=async()=>{try{a(!0),r(null);const c=await Zs();i(c)}catch(c){console.error("Erro ao buscar dados admin:",c),r("Erro ao carregar dados do painel administrativo")}finally{a(!1)}};return d.useEffect(()=>{l()},[]),{stats:o,loading:t,error:n,refetch:l}},Ys=async o=>{try{return(await ne(E(w,"transactions_plans"),{...o,createdAt:oe(),updatedAt:oe()})).id}catch(i){throw console.error("Erro ao criar transação de plano:",i),i}},Be=async(o,i)=>{try{const t=E(w,"users",o,"notifications"),a=K(t).id,n=Object.fromEntries(Object.entries(i).filter(([r,l])=>l!==void 0));await Le(K(t,a),{...n,id:a,userId:o,read:!1,createdAt:oe()}),console.log(`Notificação enviada para usuário ${o}:`,i.title)}catch(t){throw console.error("Erro ao enviar notificação:",t),t}},Qs=async(o,i,t,a,n,r)=>{const l={free:"Free",standard:"Standard",medium:"Medium",ultimate:"Ultimate"},c=l[t]||t,x=l[a]||a,j={type:"plan_change",title:"Plano Alterado",message:`Seu plano foi alterado de ${c} para ${x}${r?`. Motivo: ${r}`:""}.`,metadata:{oldPlan:t,newPlan:a,changedBy:n,...r&&{reason:r}}};await Be(o,j)},et=async(o,i,t)=>{const a={type:"admin_promotion",title:"Privilégios de Admin Concedidos",message:`Você foi promovido a administrador${t?`. Motivo: ${t}`:""}.`,metadata:{changedBy:i,...t&&{reason:t}}};await Be(o,a)},st=async(o,i,t)=>{const a={type:"admin_demotion",title:"Privilégios de Admin Removidos",message:`Seus privilégios de administrador foram removidos${`. Motivo: ${t}`}.`,metadata:{changedBy:i,reason:t}};await Be(o,a)},ls={free:{funcionarios:1,permissoes:{}},standard:{funcionarios:5,permissoes:{}},medium:{funcionarios:10,permissoes:{}},ultimate:{funcionarios:50,permissoes:{}}},cs=o=>({free:"Free",standard:"Standard",medium:"Medium",ultimate:"Ultimate"})[o]||o,Z=async o=>{try{console.log(`🔍 Buscando usuário com email: ${o}`);const i=o.toLowerCase().trim();try{const n=E(w,"users"),r=X(n,Ns("email","==",i)),l=await I(r);if(!l.empty){const c=l.docs[0],x=c.id,j=c.data();console.log(`✅ Usuário encontrado: ${x} - ${i}`),console.log("📋 Dados do usuário:",j);const b={id:x,email:j.email||i,name:j.name||j.displayName||"Nome não informado",currentPlan:j.plano||"free",permissoes:j.permissoes||{},funcionariosPermitidos:j.funcionariosPermitidos||1,isSubscriber:j.isSubscriber||!1,isActive:j.isActive||!1,isAdmin:j.isAdmin||!1};return console.log("📤 Retornando usuário:",b),b}console.log(`❌ Nenhum usuário encontrado com email: ${i}`)}catch(n){console.log("❌ Erro ao buscar usuário real:",n)}console.log(`🔄 Usando dados mock para ${o}`);const a=[{id:"mock1",email:"diegkamor@gmail.com",name:"Diego Amorim",currentPlan:"ultimate",permissoes:{},funcionariosPermitidos:50,isSubscriber:!0,isActive:!0,isAdmin:!0,subscriptionEndDate:new Date("2025-12-31")},{id:"mock2",email:"julielmoura@gmail.com",name:"Julie Moura",currentPlan:"medium",permissoes:{},funcionariosPermitidos:10,isSubscriber:!0,isActive:!0,isAdmin:!1,subscriptionEndDate:new Date("2025-11-15")},{id:"mock3",email:"theohideki@gmail.com",name:"Theo Hideki",currentPlan:"standard",permissoes:{},funcionariosPermitidos:5,isSubscriber:!0,isActive:!0,isAdmin:!1,subscriptionEndDate:new Date("2025-10-30")},{id:"mock4",email:"admin@optify.com",name:"Admin Optify",currentPlan:"ultimate",permissoes:{},funcionariosPermitidos:50,isSubscriber:!0,isActive:!0,isAdmin:!0,subscriptionEndDate:new Date("2025-12-31")},{id:"mock5",email:"teste@exemplo.com",name:"Usuário Teste",currentPlan:"free",permissoes:{},funcionariosPermitidos:1,isSubscriber:!1,isActive:!1,isAdmin:!1,subscriptionEndDate:null}].find(n=>n.email.toLowerCase()===i);return a?(console.log("✅ Usuário mock encontrado:",a),a):(console.log(`❌ Nenhum usuário encontrado (real ou mock) com email: ${i}`),null)}catch(i){return console.error("❌ Erro ao buscar usuário:",i),null}},tt=(o,i)=>(console.log(`✅ Alteração de plano permitida: ${o} → ${i}`),!0),at=async o=>{try{const i=E(w,"plan_change_history"),t=Object.fromEntries(Object.entries(o).filter(([a,n])=>n!==void 0));await ne(i,{...t,createdAt:new Date})}catch(i){console.error("Erro ao criar histórico:",i)}},rt=async(o,i,t,a,n)=>{try{console.log(`🔄 Iniciando atualização de plano para ${o} -> ${i}`);const r=await Z(o);if(!r)throw new Error("Usuário não encontrado");console.log("📋 Usuário encontrado:",r),tt(r.currentPlan,i);const l={plano:i,funcionariosPermitidos:ls[i].funcionarios,permissoes:ls[i].permissoes,updatedAt:oe()};if(i!=="free"){if(l.isSubscriber=!0,l.isActive=!0,n&&n>0){const c=new Date,x=new Date;x.setMonth(x.getMonth()+n),l.subscriptionStartDate=c,l.subscriptionEndDate=x,l.subscriptionMonths=n}}else l.isSubscriber=!1,l.isActive=!1,l.subscriptionStartDate=null,l.subscriptionEndDate=null,l.subscriptionMonths=null;if(r.id.startsWith("mock"))console.log(`📝 Plano do usuário mock ${r.email} simulado como alterado para ${i}`);else try{await qs.updateUserPlan(r.id,i,n),window.dispatchEvent(new CustomEvent("planChanged",{detail:{userId:r.id,newPlan:i}}))}catch(c){throw console.error("Erro ao atualizar plano:",c),new Error(`Falha ao atualizar plano do usuário ${r.email}: ${c}`)}if(r.id.startsWith("mock"))console.log("📝 Transação de plano simulada para usuário mock");else try{await Ys({userId:r.id,userEmail:r.email,planName:i,amount:0,status:"completed",paymentMethod:"admin_change",transactionId:`admin_${Date.now()}`,adminEmail:t,reason:a||"Alteração administrativa"})}catch(c){console.log("Transação de plano não foi criada:",c)}if(r.id.startsWith("mock"))console.log("📝 Histórico de alterações simulado para usuário mock");else try{await at({userId:r.id,userEmail:r.email,userName:r.name,previousPlan:r.currentPlan,newPlan:i,changedBy:t,reason:a})}catch(c){console.log("Histórico de alterações não foi criado:",c)}if(r.id.startsWith("mock"))console.log("📝 Notificação simulada para usuário mock");else try{await Qs(r.id,r.email,r.currentPlan,i,t,a)}catch(c){console.log("Notificação não foi enviada:",c)}y.success(`✅ Plano do usuário ${r.email} alterado de ${cs(r.currentPlan)} para ${cs(i)}`)}catch(r){throw console.error("❌ Erro ao atualizar plano:",r),r instanceof Error&&r.message.includes("downgrade")?y.error(r.message):y.error(`Erro ao atualizar plano: ${r instanceof Error?r.message:"Erro desconhecido"}`),r}},ds=async()=>{try{const o=E(w,"plan_change_history");return(await I(o)).docs.map(t=>{const a=t.data();let n;return a.createdAt?.toDate?n=a.createdAt.toDate():a.createdAt instanceof Date?n=a.createdAt:typeof a.createdAt=="string"?n=new Date(a.createdAt):n=new Date,{id:t.id,...a,createdAt:n}}).sort((t,a)=>a.createdAt.getTime()-t.createdAt.getTime())}catch(o){return console.error("Erro ao buscar histórico de planos:",o),[]}},it=async(o,i,t)=>{try{const a=await Z(o);if(!a)throw new Error("Usuário não encontrado com este email");if(await ws(a.id,a.email))throw new Error("Este usuário já possui privilégios de admin");try{const r=K(w,"admins",a.id);await Le(r,{email:a.email,isAdmin:!0,addedAt:new Date,promotedBy:i,reason:t||"Promoção administrativa"})}catch(r){if(a.id.startsWith("mock"))console.log(`Usuário mock ${a.email} promovido a admin`);else throw r}try{await nt({userId:a.id,userEmail:a.email,userName:a.name,promotedBy:i,reason:t})}catch(r){console.log("Histórico de promoção não foi criado (usuário mock):",r)}try{await et(a.id,i,t)}catch(r){console.log("Notificação não foi enviada (usuário mock):",r)}y.success(`Usuário ${a.email} promovido a admin com sucesso!`)}catch(a){throw console.error("Erro ao promover usuário:",a),a}},ot=async(o,i,t)=>{try{const a=await Z(o);if(!a)throw new Error("Usuário não encontrado com este email");if(!await ws(a.id,a.email))throw new Error("Este usuário não possui privilégios de admin");if(a.email===i)throw new Error("Você não pode remover seus próprios privilégios de admin");try{const r=K(w,"admins",a.id);await Le(r,{email:a.email,isAdmin:!1,removedAt:new Date,demotedBy:i,reason:t||"Remoção administrativa"},{merge:!0})}catch(r){if(a.id.startsWith("mock"))console.log(`Privilégios de admin removidos do usuário mock ${a.email}`);else throw r}try{await lt({userId:a.id,userEmail:a.email,userName:a.name,demotedBy:i,reason:t})}catch(r){console.log("Histórico de remoção não foi criado (usuário mock):",r)}try{await st(a.id,i,t)}catch(r){console.log("Notificação não foi enviada (usuário mock):",r)}y.success(`Privilégios de admin removidos do usuário ${a.email}`)}catch(a){throw console.error("Erro ao remover privilégios de admin:",a),a}},ws=async(o,i)=>{try{if(["diegkamor@gmail.com"].includes(i.toLowerCase()))return!0;const a=K(w,"admins",o),n=await I(X(E(w,"admins"),Ns("__name__","==",o)));return n.empty?!1:n.docs[0].data()?.isAdmin===!0}catch(t){return console.error("Erro ao verificar status de admin:",t),!1}},ke=async()=>{try{const o=await I(E(w,"admins")),i=[];return o.docs.forEach(a=>{const n=a.data();n.isAdmin===!0&&i.push({userId:a.id,email:n.email,isAdmin:n.isAdmin,addedAt:n.addedAt,promotedBy:n.promotedBy})}),["diegkamor@gmail.com"].forEach(a=>{i.find(n=>n.email===a)||i.push({userId:"hardcoded",email:a,isAdmin:!0,addedAt:"2024-01-01T00:00:00.000Z",promotedBy:"Sistema"})}),i.sort((a,n)=>{if(a.addedAt&&n.addedAt){const r=a.addedAt.toDate?a.addedAt.toDate():new Date(a.addedAt);return(n.addedAt.toDate?n.addedAt.toDate():new Date(n.addedAt)).getTime()-r.getTime()}return 0})}catch(o){throw console.error("Erro ao buscar administradores:",o),o}},nt=async o=>{try{const i=E(w,"admin_promotion_history"),t=Object.fromEntries(Object.entries(o).filter(([a,n])=>n!==void 0));await ne(i,{...t,createdAt:new Date})}catch(i){console.error("Erro ao criar histórico de promoção:",i)}},lt=async o=>{try{const i=E(w,"admin_demotion_history"),t=Object.fromEntries(Object.entries(o).filter(([a,n])=>n!==void 0));await ne(i,{...t,createdAt:new Date})}catch(i){console.error("Erro ao criar histórico de demotion:",i)}},ms=async()=>{try{const o=E(w,"admin_promotion_history");return(await I(o)).docs.map(t=>({id:t.id,...t.data()}))}catch(o){throw console.error("Erro ao buscar histórico de promoções:",o),o}},Ce=async()=>{try{const o=E(w,"admin_demotion_history");return(await I(o)).docs.map(t=>({id:t.id,...t.data()}))}catch(o){throw console.error("Erro ao buscar histórico de demotions:",o),o}},ct=async(o,i)=>{try{console.log(`🗑️ Iniciando exclusão completa do usuário: ${o}`);const n=(await vs(ps,"deleteUserCompletely")({targetUserId:o,reason:i})).data;return n.success?(y.success(n.message),console.log("✅ Exclusão concluída:",n.deletedData)):y.error(n.message),{success:n.success,message:n.message,deletedData:n.deletedData,auditLogId:n.auditLogId}}catch(t){console.error("❌ Erro ao excluir usuário:",t);const a=t.message||"Erro desconhecido ao excluir usuário";return y.error(a),{success:!1,message:a,deletedData:[]}}},us=async o=>{try{return(await vs(ps,"canDeleteUser")({targetUserId:o})).data}catch(i){return console.error("❌ Erro ao verificar se usuário pode ser excluído:",i),{canDelete:!1,reason:i.message||"Erro ao verificar permissões de exclusão"}}},dt=async o=>{if(!o||o.length<2)return[];try{const i=o.toLowerCase(),t=[];try{const a=E(w,"users"),n=o.toUpperCase(),r=X(a,js("email"),Ks(i),Js(n+""),gs(10));(await I(r)).forEach(c=>{const x=c.data();x.email&&x.email.toLowerCase().startsWith(i)&&t.push({uid:c.id,email:x.email,displayName:x.displayName||x.name,createdAt:x.createdAt?.toDate?x.createdAt.toDate():x.createdAt})})}catch{console.log("Coleção users não encontrada ou vazia, tentando abordagem alternativa")}return t.length===0&&[{uid:"mock1",email:"diegkamor@gmail.com",displayName:"Diego Amorim"},{uid:"mock2",email:"julielmoura@gmail.com",displayName:"Julie Moura"},{uid:"mock3",email:"theohideki@gmail.com",displayName:"Theo Hideki"},{uid:"mock4",email:"admin@optify.com",displayName:"Admin Optify"},{uid:"mock5",email:"teste@exemplo.com",displayName:"Usuário Teste"}].filter(r=>r.email.toLowerCase().includes(i)).forEach(r=>{t.push({uid:r.uid,email:r.email,displayName:r.displayName,createdAt:new Date})}),t.slice(0,10)}catch(i){return console.error("Erro ao buscar usuários:",i),[]}},xs=({placeholder:o="Digite o email do usuário",onUserSelect:i,onSearch:t,disabled:a=!1,className:n=""})=>{const[r,l]=d.useState(""),[c,x]=d.useState([]),[j,b]=d.useState(!1),[_,$]=d.useState(!1),[L,k]=d.useState(-1),H=d.useRef(null),z=d.useRef(null),B=d.useRef();d.useEffect(()=>(B.current&&clearTimeout(B.current),r.length>=2?B.current=setTimeout(async()=>{b(!0);try{const f=await dt(r);x(f),$(!0),k(-1)}catch(f){console.error("Erro ao buscar usuários:",f),x([])}finally{b(!1)}},300):(x([]),$(!1)),()=>{B.current&&clearTimeout(B.current)}),[r]);const U=f=>{if(!(!_||c.length===0))switch(f.key){case"ArrowDown":f.preventDefault(),k(P=>P<c.length-1?P+1:0);break;case"ArrowUp":f.preventDefault(),k(P=>P>0?P-1:c.length-1);break;case"Enter":f.preventDefault(),L>=0&&L<c.length&&M(c[L]);break;case"Escape":$(!1),k(-1),H.current?.blur();break}},M=f=>{l(f.email),$(!1),k(-1),x([]),i(f),H.current?.blur()},u=f=>{const P=f.target.value;l(P),t&&t(P)},v=()=>{t&&t(r)},O=()=>{c.length>0&&$(!0)},Y=f=>{setTimeout(()=>{z.current?.contains(document.activeElement)||($(!1),k(-1),x([]))},150)};return e.jsxs("div",{className:`relative z-[9999] ${n}`,style:{zIndex:999999},children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{ref:H,type:"email",placeholder:o,value:r,onChange:u,onKeyDown:U,onFocus:O,onBlur:Y,disabled:a,className:"pr-10"}),j&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})})]}),e.jsx(D,{type:"button",variant:"outline",size:"icon",onClick:v,disabled:a||j,children:e.jsx(hs,{className:"h-4 w-4"})})]}),_&&c.length>0&&e.jsxs(p,{ref:z,className:"absolute top-full left-0 right-0 z-[99999] mt-1 max-h-60 overflow-y-auto border shadow-2xl bg-background",style:{zIndex:999999,transform:"translateZ(0)",isolation:"isolate"},children:[e.jsx("div",{className:"p-2",children:c.map((f,P)=>e.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors ${P===L?"bg-accent":"hover:bg-accent/50"}`,onClick:()=>M(f),children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Ms,{className:"h-4 w-4 text-primary"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:f.email}),f.displayName&&e.jsx(R,{variant:"secondary",className:"text-xs",children:f.displayName})]}),f.createdAt&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mt-1",children:[e.jsx(Fs,{className:"h-3 w-3"}),e.jsxs("span",{children:["Cadastrado em ",f.createdAt.toLocaleDateString("pt-BR")]})]})]})]},f.uid))}),c.length===10&&e.jsx("div",{className:"px-2 py-1 text-xs text-muted-foreground border-t",children:"Mostrando os primeiros 10 resultados"})]})]})},mt=()=>[{id:"free",name:"Free",description:"Plano gratuito com funcionalidades básicas",price:0,features:["Funcionalidades básicas","Suporte por email"]},{id:"standard",name:"Standard",description:"Plano intermediário com mais recursos",price:1,features:["Todas as funcionalidades Free","Relatórios avançados","Suporte prioritário"]},{id:"medium",name:"Medium",description:"Plano avançado para empresas em crescimento",price:49.9,features:["Todas as funcionalidades Standard","API access","Integrações avançadas"]},{id:"ultimate",name:"Ultimate",description:"Plano premium com todos os recursos",price:99.9,features:["Todas as funcionalidades","Suporte 24/7","Consultoria personalizada"]}],ut=o=>["free","standard","medium","ultimate"].includes(o),xt=()=>{const{user:o,isAdmin:i}=fs(),{stats:t,loading:a,error:n,refetch:r}=Xs(),[l,c]=d.useState([]),[x,j]=d.useState(!0),[b,_]=d.useState(""),[$,L]=d.useState([]),[k,H]=d.useState(!1),[z,B]=d.useState(""),[U,M]=d.useState(""),[u,v]=d.useState(""),[O,Y]=d.useState(0),[f,P]=d.useState(!1),[F,Q]=d.useState(null),[ht,Me]=d.useState(!1),[Fe,le]=d.useState(""),[Ie,_e]=d.useState(""),[ze,He]=d.useState(!1),[q,ee]=d.useState(null),[pt,Oe]=d.useState(!1),[qe,ce]=d.useState([]),[ft,We]=d.useState([]),[gt,de]=d.useState([]),[As,Ve]=d.useState(!1),[h,me]=d.useState(null),[Ds,ue]=d.useState(!1),[Ss,xe]=d.useState(!1),[Es,he]=d.useState(!1),[C,Ge]=d.useState(null),[pe,Ke]=d.useState(""),[Je,Ze]=d.useState(!1),se=mt();d.useEffect(()=>{(async()=>{try{j(!0);const m=await J();c(m)}catch(m){console.error("Erro ao buscar usuários:",m)}finally{j(!1)}})()},[]),d.useEffect(()=>{(async()=>{try{H(!0);const m=await ds();L(m.sort((A,N)=>{const g=A.createdAt?.toDate?A.createdAt.toDate():new Date(A.createdAt);return(N.createdAt?.toDate?N.createdAt.toDate():new Date(N.createdAt)).getTime()-g.getTime()}))}catch(m){console.error("Erro ao buscar histórico:",m)}finally{H(!1)}})()},[]),d.useEffect(()=>{(async()=>{try{Ve(!0);const[m,A,N]=await Promise.all([ke(),ms(),Ce()]);ce(m),We(A.sort((g,S)=>{const V=g.createdAt.toDate?g.createdAt.toDate():new Date(g.createdAt);return(S.createdAt.toDate?S.createdAt.toDate():new Date(S.createdAt)).getTime()-V.getTime()})),de(N.sort((g,S)=>{const V=g.createdAt.toDate?g.createdAt.toDate():new Date(g.createdAt);return(S.createdAt.toDate?S.createdAt.toDate():new Date(S.createdAt)).getTime()-V.getTime()}))}catch(m){console.error("Erro ao buscar dados de admin:",m)}finally{Ve(!1)}})()},[]);const fe=l.filter(s=>s.name.toLowerCase().includes(b.toLowerCase())||s.email.toLowerCase().includes(b.toLowerCase())),Xe=()=>{r(),y.success("Dados atualizados com sucesso!")},Rs=async()=>{if(z.trim())try{Me(!0);const s=await Z(z.trim());Q(s),M(s?s.currentPlan:"")}catch{Q(null),M("")}finally{Me(!1)}},Us=async()=>{if(!F||!U){y.error("Por favor, selecione um usuário e um plano");return}if(U===F.currentPlan){y.error("O usuário já possui este plano");return}if(!ut(U)){y.error("Plano inválido selecionado");return}try{P(!0),await rt(F.email,U,o?.email||"",u||void 0,O||void 0),B(""),M(""),v(""),Y(0),Q(null),r();const s=await J();c(s);const m=await ds();L(m.sort((A,N)=>{const g=A.createdAt?.toDate?A.createdAt.toDate():new Date(A.createdAt);return(N.createdAt?.toDate?N.createdAt.toDate():new Date(N.createdAt)).getTime()-g.getTime()}))}catch(s){console.error("Erro ao atualizar plano:",s)}finally{P(!1)}},Ps=async()=>{if(Fe.trim())try{Oe(!0);const s=await Z(Fe.trim());ee(s)}catch{ee(null)}finally{Oe(!1)}},ks=async()=>{if(!q){y.error("Por favor, busque um usuário primeiro");return}try{He(!0),await it(q.email,o?.email||"",Ie||void 0),le(""),_e(""),ee(null);const[s,m,A]=await Promise.all([ke(),ms(),Ce()]);ce(s),We(m.sort((N,g)=>{const S=N.createdAt.toDate?N.createdAt.toDate():new Date(N.createdAt);return(g.createdAt.toDate?g.createdAt.toDate():new Date(g.createdAt)).getTime()-S.getTime()})),de(A.sort((N,g)=>{const S=N.createdAt.toDate?N.createdAt.toDate():new Date(N.createdAt);return(g.createdAt.toDate?g.createdAt.toDate():new Date(g.createdAt)).getTime()-S.getTime()}))}catch(s){console.error("Erro ao promover usuário:",s)}finally{He(!1)}},Cs=async s=>{try{await ot(s,o?.email||"","Remoção via painel administrativo");const[m,A]=await Promise.all([ke(),Ce()]);ce(m),de(A.sort((N,g)=>{const S=N.createdAt.toDate?N.createdAt.toDate():new Date(N.createdAt);return(g.createdAt.toDate?g.createdAt.toDate():new Date(g.createdAt)).getTime()-S.getTime()}))}catch(m){console.error("Erro ao remover privilégios de admin:",m)}},Ye=s=>{me(s),ue(!0)},Ts=s=>{me(s),xe(!0)},W=()=>{me(null),ue(!1),xe(!1),he(!1),Ge(null),Ke("")},$s=s=>{Ge(s),he(!0)},Ls=async()=>{if(C){if(pe.toLowerCase()!=="excluir"){y.error('Digite "excluir" para confirmar a exclusão');return}if(!us(C.id,o?.uid)){y.error("Não é possível excluir este usuário");return}try{if(Ze(!0),C.id.startsWith("mock"))console.log(`📝 Exclusão simulada para usuário mock: ${C.email}`),y.success(`Usuário ${C.email} excluído com sucesso (simulação)`);else{const m=await ct(C.id,C.email,o?.email||void 0);if(m.success)y.success(m.message),console.log("✅ Exclusão concluída:",m.deletedData);else{y.error(m.message);return}}const s=await J();c(s),W()}catch(s){console.error("Erro ao excluir usuário:",s),y.error("Erro ao excluir usuário. Tente novamente.")}finally{Ze(!1)}}};return e.jsxs(Ws,{defaultValue:"analytics",className:"w-full",children:[e.jsxs(Vs,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(we,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Dashboard Avançado"]}),e.jsxs(we,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Resultados & Estatísticas"]}),e.jsxs(we,{value:"plans",className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-4 w-4"}),"Gerenciar Planos"]})]}),e.jsxs(Ae,{value:"analytics",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Dashboard Avançado"}),e.jsx("p",{className:"text-muted-foreground",children:"Análise completa do desempenho do sistema"})]}),e.jsxs(D,{onClick:Xe,variant:"outline",size:"sm",disabled:a,className:"flex items-center gap-2",children:[e.jsx(te,{className:`h-4 w-4 ${a?"animate-spin":""}`}),"Atualizar"]})]}),a?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[...Array(4)].map((s,m)=>e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/3"})]})},m))}):t?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(p,{className:"p-6 border-l-4 border-l-emerald-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Hoje"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:["R$ ",t.revenueToday.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.revenueToday>0?"Receitas do dia atual":"Nenhuma receita hoje"})]}),e.jsx(Ne,{className:"h-8 w-8 text-emerald-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Semana"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",t.revenueWeek.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Últimos 7 dias"})]}),e.jsx(ae,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Mês"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["R$ ",t.revenueMonth.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Últimos 30 dias"})]}),e.jsx(ge,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Melhor Dia"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.bestDay.date}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["R$ ",t.bestDay.revenue.toLocaleString("pt-BR",{minimumFractionDigits:2})," em vendas"]})]}),e.jsx(te,{className:"h-8 w-8 text-orange-500"})]})})]}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(p,{className:"p-6 border-l-4 border-l-emerald-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Hoje"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:"R$ 0,00"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Nenhuma receita hoje"})]}),e.jsx(Ne,{className:"h-8 w-8 text-emerald-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Semana"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"R$ 0,00"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Últimos 7 dias"})]}),e.jsx(ae,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Receita Mês"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"R$ 0,00"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Últimos 30 dias"})]}),e.jsx(ge,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx(p,{className:"p-6 border-l-4 border-l-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Melhor Dia"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Nenhuma receita registrada"})]}),e.jsx(te,{className:"h-8 w-8 text-orange-500"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Receita Total: R$ ",t?.totalRevenue.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Receita Hoje"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:t?`${Math.min(t.revenueToday/Math.max(t.totalRevenue,1)*100,100)}%`:"0%"}})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",t?.revenueToday.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Receita Semanal"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:t?`${Math.min(t.revenueWeek/Math.max(t.totalRevenue,1)*100,100)}%`:"0%"}})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",t?.revenueWeek.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Receita Mensal"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:t?`${Math.min(t.revenueMonth/Math.max(t.totalRevenue,1)*100,100)}%`:"0%"}})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",t?.revenueMonth.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Melhor Dia"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-orange-600",children:t?.bestDay.date||"N/A"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",t?.bestDay.revenue.toLocaleString("pt-BR",{minimumFractionDigits:2})||"0,00"]})]})]}),t&&t.totalRevenue===0&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhuma receita registrada ainda"})})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Planos Mais Populares"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Ultimate"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-2/3 h-full bg-primary rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"2 usuários (67%)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Standard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-1/3 h-full bg-blue-500 rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"1 usuário (33%)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Medium"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-0 h-full bg-muted-foreground rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"0 usuários (0%)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Free"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full",children:e.jsx("div",{className:"w-0 h-full bg-muted-foreground rounded-full"})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"0 usuários (0%)"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Crescimento de Usuários"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Este Mês"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"+3 usuários"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Mês Anterior"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"+0 usuários"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Crescimento"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"∞% ↗️"})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Métricas de Engajamento"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Taxa de Conversão"}),e.jsx("span",{className:"text-sm font-semibold text-primary",children:"100%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Usuários Ativos"}),e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:"3/3"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Retenção"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"100%"})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Projeções"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Próximo Mês"}),e.jsx("span",{className:"text-sm font-semibold text-purple-600",children:"R$ 31,00"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Meta Anual"}),e.jsx("span",{className:"text-sm font-semibold text-orange-600",children:"R$ 372,00"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Crescimento Esperado"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"+3,300%"})]})]})]})]}),e.jsxs(p,{className:"p-6 border-l-4 border-l-yellow-500",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-yellow-500"}),"Alertas e Recomendações"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"🎯 Oportunidade:"})," Considere criar campanhas de marketing para o plano Medium, que ainda não tem usuários."]})}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"📈 Tendência:"})," O plano Ultimate está sendo o mais escolhido. Considere criar um plano ainda mais premium."]})}),e.jsx("div",{className:"p-3 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-800",children:e.jsxs("p",{className:"text-sm text-emerald-800 dark:text-emerald-200",children:[e.jsx("strong",{children:"✅ Excelente:"})," Taxa de conversão de 100% indica que o produto está bem posicionado no mercado."]})})]})]})]}),e.jsxs(Ae,{value:"dashboard",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Resultados & Estatísticas"}),e.jsx("p",{className:"text-muted-foreground",children:"Visão geral do desempenho do sistema"})]}),e.jsxs(D,{onClick:Xe,variant:"outline",size:"sm",disabled:a,className:"flex items-center gap-2",children:[e.jsx(te,{className:`h-4 w-4 ${a?"animate-spin":""}`}),"Atualizar"]})]}),n&&e.jsxs(De,{variant:"destructive",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx(Se,{children:n})]}),a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[...Array(4)].map((s,m)=>e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/3"})]})},m))}):t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(ie,{title:"Total de Usuários",value:t.totalUsers.toLocaleString(),icon:je,trend:{value:t.growthRate,isPositive:t.growthRate>0}}),e.jsx(ie,{title:"Usuários Ativos",value:t.activeUsers.toLocaleString(),icon:re}),e.jsx(ie,{title:"Receita Total",value:`R$ ${t.totalRevenue.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,icon:Ne}),e.jsx(ie,{title:"Taxa de Crescimento",value:`${t.growthRate.toFixed(1)}%`,icon:ae,trend:{value:t.growthRate,isPositive:t.growthRate>0}})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Distribuição de Planos"}),a?e.jsx("div",{className:"space-y-3",children:[...Array(4)].map((s,m)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-16 animate-pulse"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-48 h-2 bg-muted rounded-full animate-pulse"}),e.jsx("div",{className:"h-4 bg-muted rounded w-8 animate-pulse"})]})]},m))}):t?e.jsx("div",{className:"space-y-4",children:Object.entries(t.planDistribution).map(([s,m])=>{const A=t.totalUsers>0?m/t.totalUsers*100:0,N=se.find(g=>g.id===s);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:N?.name||s}),e.jsxs(R,{variant:"outline",className:"text-xs",children:[m," usuários"]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[A.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full transition-all duration-500",style:{width:`${A}%`}})})]},s)})}):null]}),e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Atividade Recente"}),a?e.jsx("div",{className:"space-y-3",children:[...Array(4)].map((s,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4 animate-pulse"}),e.jsx("div",{className:"h-3 bg-muted rounded w-16 animate-pulse"})]},m))}):t?e.jsx("div",{className:"space-y-3",children:t.recentActivity.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhuma atividade recente"}):t.recentActivity.map((s,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsx("span",{className:"text-sm",children:s.action}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.time})]},m))}):null]})]}),e.jsxs(p,{className:"shadow-card",children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Usuários do Sistema (",fe.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(G,{placeholder:"Buscar usuários...",className:"w-64 pl-10",value:b,onChange:s=>_(s.target.value)})]}),e.jsx(D,{variant:"outline",children:"Filtros"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:x?e.jsxs("div",{className:"p-4 sm:p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Carregando usuários..."})]}):e.jsx("div",{className:"min-w-full",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-semibold",children:"Usuário"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Email"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Plano"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Expira em"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Registrado em"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Ações"})]})}),e.jsx("tbody",{children:fe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-muted-foreground",children:b?"Nenhum usuário encontrado para a busca.":"Nenhum usuário encontrado."})}):fe.map(s=>e.jsxs("tr",{className:"border-t border-border hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-4 font-medium",children:s.name}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:s.email}),e.jsx("td",{className:"p-4",children:e.jsx(R,{variant:s.plan==="free"?"secondary":"default",className:"capitalize",children:s.plan})}),e.jsx("td",{className:"p-4",children:e.jsx(R,{variant:s.status==="active"?"default":"secondary",children:s.status==="active"?"Ativo":"Inativo"})}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:s.planExpirationDate?s.planExpirationDate.toDate?s.planExpirationDate.toDate().toLocaleDateString("pt-BR"):new Date(s.planExpirationDate).toLocaleDateString("pt-BR"):s.plan==="free"?"N/A":"Não definido"}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:s.createdAt?s.createdAt.toDate?s.createdAt.toDate().toLocaleDateString("pt-BR"):new Date(s.createdAt).toLocaleDateString("pt-BR"):"N/A"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{size:"sm",variant:"outline",onClick:()=>Ye(s),className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),"Editar"]}),e.jsxs(D,{size:"sm",variant:"outline",onClick:()=>Ts(s),className:"flex items-center gap-1",children:[e.jsx(es,{className:"h-3 w-3"}),"Ver Detalhes"]}),e.jsxs(D,{size:"sm",variant:"destructive",onClick:()=>$s(s),className:"flex items-center gap-1",disabled:!us(s.id,o?.uid),children:[e.jsx(be,{className:"h-3 w-3"}),"Excluir"]})]})})]},s.id))})]})})})]})]}),e.jsxs(Ae,{value:"plans",className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gerenciamento de Planos"}),e.jsx("p",{className:"text-muted-foreground",children:"Alterar planos de usuários por email"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"p-6 relative z-50",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(_s,{className:"h-5 w-5"}),"Alterar Plano de Usuário"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Email do Usuário"}),e.jsx("div",{className:"mt-1",children:e.jsx(xs,{placeholder:"Digite o email do usuário",onUserSelect:s=>{B(s.email),Q({uid:s.uid,email:s.email,displayName:s.displayName})},onSearch:s=>{B(s),Rs()}})})]}),F&&e.jsxs(De,{children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx(Se,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",F.name||"Nome não informado"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",F.email||"Email não informado"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Plano Atual:"}),e.jsx(R,{className:"capitalize",children:F.currentPlan||"free"})]})]})})]}),F&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"newPlan",children:"Novo Plano"}),e.jsxs(ss,{value:U,onValueChange:M,children:[e.jsx(ts,{className:"mt-1",children:e.jsx(as,{placeholder:"Selecione o novo plano"})}),e.jsx(rs,{children:se.map(s=>e.jsx(is,{value:s.id,disabled:s.id===F.currentPlan,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:s.name}),e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["R$ ",s.price.toFixed(2)]})]})},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"reason",children:"Motivo da Alteração (opcional)"}),e.jsx($e,{id:"reason",placeholder:"Ex: Upgrade promocional, correção de problema, etc.",value:u,onChange:s=>v(s.target.value),className:"mt-1"})]}),U&&U!=="free"&&e.jsxs("div",{children:[e.jsx(T,{htmlFor:"subscriptionMonths",children:"Meses de Assinatura"}),e.jsx(G,{id:"subscriptionMonths",type:"number",placeholder:"Ex: 12 (para 1 ano)",value:O,onChange:s=>Y(parseInt(s.target.value)||0),className:"mt-1",min:"1",max:"120"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Deixe vazio para não definir período específico"})]}),e.jsx(D,{onClick:Us,disabled:f||!U||U===F.currentPlan,className:"w-full",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Alterando Plano..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Alterar Plano"]})})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(zs,{className:"h-5 w-5"}),"Histórico de Alterações"]}),k?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((s,m)=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/4"})]})},m))}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:$.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhuma alteração de plano registrada"}):$.map(s=>e.jsx("div",{className:"p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:s.userEmail}),e.jsx(R,{variant:"outline",className:"text-xs",children:s.newPlan})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.previousPlan," → ",s.newPlan]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Alterado por: ",s.updatedBy||s.changedBy]}),s.reason&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Motivo: ",s.reason]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.createdAt?.toDate?s.createdAt.toDate().toLocaleString("pt-BR"):new Date(s.createdAt).toLocaleString("pt-BR")})]})},s.id))})]})]}),e.jsxs(p,{className:"p-6 relative z-10",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5"}),"Gerenciar Administradores"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Email do Usuário para Promover"}),e.jsx("div",{className:"mt-1",children:e.jsx(xs,{placeholder:"Digite o email do usuário",onUserSelect:s=>{le(s.email),ee({uid:s.uid,email:s.email,displayName:s.displayName})},onSearch:s=>{le(s),Ps()}})})]}),q&&e.jsxs(De,{children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx(Se,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",q.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",q.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"}),e.jsx(R,{className:"ml-2",variant:"outline",children:"Usuário Regular"})]})]})})]}),q&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"adminReason",children:"Motivo da Promoção (opcional)"}),e.jsx($e,{id:"adminReason",placeholder:"Ex: Responsável pela equipe, suporte técnico, etc.",value:Ie,onChange:s=>_e(s.target.value),className:"mt-1"})]}),e.jsx(D,{onClick:ks,disabled:ze,className:"w-full bg-gradient-primary",children:ze?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Promovendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Promover a Administrador"]})})]})]})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),"Administradores Atuais"]}),As?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((s,m)=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]})},m))}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:qe.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum administrador encontrado"}):qe.map(s=>e.jsx("div",{className:"p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s.email}),e.jsx(R,{variant:"default",className:"bg-gradient-primary",children:"Admin"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Promovido por: ",s.promotedBy||"Sistema"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.addedAt?s.addedAt.toDate?s.addedAt.toDate().toLocaleString("pt-BR"):s.addedAt.toString():"Data não disponível"})]}),s.email!==o?.email&&s.userId!=="hardcoded"&&e.jsx(D,{size:"sm",variant:"destructive",onClick:()=>Cs(s.email),children:"Remover Admin"})]})},s.userId))})]}),e.jsxs(p,{className:"p-6 lg:col-span-2",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Planos Disponíveis"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:se.map(s=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold",children:s.name}),e.jsxs(R,{variant:s.price===0?"secondary":"default",children:["R$ ",s.price.toFixed(2)]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsx("ul",{className:"text-xs text-muted-foreground space-y-1",children:s.features.map((m,A)=>e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3 text-green-500"}),m]},A))})]})},s.id))})]})]}),e.jsx(Ee,{open:Ds,onOpenChange:ue,children:e.jsxs(Re,{className:"max-w-2xl",children:[e.jsx(Ue,{children:e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"Editar Usuário: ",h?.name]})}),h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Nome"}),e.jsx(G,{value:h.name,readOnly:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(T,{children:"Email"}),e.jsx(G,{value:h.email,readOnly:!0,className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Plano Atual"}),e.jsx("div",{className:"mt-1",children:e.jsx(R,{className:"capitalize",children:h.plan})})]}),e.jsxs("div",{children:[e.jsx(T,{children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx(R,{variant:h.status==="active"?"default":"secondary",children:h.status==="active"?"Ativo":"Inativo"})})]})]}),e.jsxs("div",{children:[e.jsx(T,{children:"Alterar Plano"}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsxs(ss,{defaultValue:h.plan,onValueChange:s=>{console.log("Alterando plano para:",s)},children:[e.jsx(ts,{className:"flex-1",children:e.jsx(as,{})}),e.jsx(rs,{children:se.map(s=>e.jsxs(is,{value:s.id,children:[s.name," - R$ ",s.price.toFixed(2)]},s.id))})]}),e.jsxs(D,{size:"sm",variant:"outline",children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Aplicar"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(D,{variant:"outline",onClick:W,children:"Cancelar"}),e.jsx(D,{onClick:W,children:"Salvar Alterações"})]})]})]})}),e.jsx(Ee,{open:Ss,onOpenChange:xe,children:e.jsxs(Re,{className:"max-w-4xl",children:[e.jsx(Ue,{children:e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5"}),"Detalhes do Usuário: ",h?.name]})}),h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Informações Pessoais"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nome:"})," ",h.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",h.email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ID:"})," ",e.jsx("code",{className:"text-xs",children:h.id})]})]})]}),e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Status da Conta"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Plano:"}),e.jsx(R,{className:"capitalize",children:h.plan})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Status:"}),e.jsx(R,{variant:h.status==="active"?"default":"secondary",children:h.status==="active"?"Ativo":"Inativo"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Plano expira em:"})," ",h.planExpirationDate?h.planExpirationDate.toDate?h.planExpirationDate.toDate().toLocaleDateString("pt-BR"):new Date(h.planExpirationDate).toLocaleDateString("pt-BR"):h.plan==="free"?"N/A":"Não definido"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Registrado em:"})," ",h.createdAt?h.createdAt.toDate?h.createdAt.toDate().toLocaleDateString("pt-BR"):new Date(h.createdAt).toLocaleDateString("pt-BR"):"N/A"]}),h.lastLogin&&e.jsxs("div",{children:[e.jsx("strong",{children:"Último acesso:"})," ",h.lastLogin.toDate?h.lastLogin.toDate().toLocaleDateString("pt-BR"):new Date(h.lastLogin).toLocaleDateString("pt-BR")]})]})]})]}),e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Estatísticas de Uso"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Transações"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Funcionários"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Relatórios"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:"-"}),e.jsx("div",{className:"text-muted-foreground",children:"Dias Ativo"})]})]})]}),e.jsxs(p,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Atividades Recentes"}),e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"Histórico de atividades em desenvolvimento"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(D,{variant:"outline",onClick:W,children:"Fechar"}),e.jsxs(D,{onClick:()=>{W(),Ye(h)},children:[e.jsx(ve,{className:"h-4 w-4 mr-1"}),"Editar Usuário"]})]})]})]})}),e.jsx(Ee,{open:Es,onOpenChange:he,children:e.jsxs(Re,{className:"max-w-md",children:[e.jsx(Ue,{children:e.jsxs(Pe,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(be,{className:"h-5 w-5"}),"Confirmar Exclusão de Usuário"]})}),C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-destructive font-medium mb-2",children:"⚠️ Atenção: Esta ação não pode ser desfeita"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Todos os dados do usuário serão excluídos permanentemente"}),e.jsx("li",{children:"• Histórico de transações será removido"}),e.jsx("li",{children:"• Configurações e preferências serão perdidas"}),e.jsx("li",{children:"• Acesso ao sistema será revogado"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Usuário a ser excluído:"}),e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:C.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:C.email}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Plano: ",C.plan]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",e.jsx("code",{className:"text-xs",children:C.id})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Dados que serão excluídos:"}),e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg space-y-1",children:[e.jsx("p",{className:"text-sm",children:"• Perfil e configurações do usuário"}),e.jsx("p",{className:"text-sm",children:"• Todos os funcionários cadastrados"}),e.jsx("p",{className:"text-sm",children:"• Histórico completo de transações"}),e.jsx("p",{className:"text-sm",children:"• Plataformas de apostas configuradas"}),e.jsx("p",{className:"text-sm",children:"• Histórico de alterações de plano"}),e.jsx("p",{className:"text-sm",children:"• Acesso ao sistema será revogado"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"deleteConfirmation",children:["Para confirmar, digite ",e.jsx("strong",{children:"excluir"}),":"]}),e.jsx(G,{id:"deleteConfirmation",placeholder:"Digite 'excluir' para confirmar",value:pe,onChange:s=>Ke(s.target.value),className:"border-destructive/50 focus:border-destructive"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(D,{variant:"outline",onClick:W,children:"Cancelar"}),e.jsx(D,{variant:"destructive",onClick:Ls,disabled:Je||pe.toLowerCase()!=="excluir",children:Je?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Excluindo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"Excluir Usuário"]})})]})]})]})})]})},$t=()=>{const{user:o,isAdmin:i}=fs();return e.jsx(Hs,{children:e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Painel Administrativo"}),i&&e.jsxs(R,{variant:"default",className:"flex items-center gap-1 bg-gradient-primary",children:[e.jsx(Te,{className:"h-3 w-3"}),"Admin"]})]}),e.jsxs("p",{className:"text-muted-foreground",children:["Gerencie usuários e configurações do sistema • Acesso restrito • ",o?.email]})]}),e.jsx(xt,{})]})})};export{$t as default};
