import{j as e,a6 as w,a7 as U,p as N,i}from"./ui-vendor-CIJA2k99.js";import{u as I,r as o}from"./react-vendor-a_rYd-gI.js";import{D as S,A as E,i as z,a as L,b as T,c as B,d as k,e as F,f as R,g as G}from"./DashboardLayout-BStG2aYf.js";import{i as H,l as O,C as n,j,B as d,H as $}from"./index-mvhQqbRd.js";import{L as c}from"./label-5IA6As71.js";import{I as m}from"./input-foYkf2QR.js";import{G as V}from"./firebase-vendor-Dsl9zeYT.js";import{d as q}from"./user-subcollections.service-BgWJVIJ-.js";import{U as b}from"./user-basic-info.service-DlNIYZkN.js";import"./index-CnEst0fN.js";import"./chart-vendor-D_ps4xzz.js";const re=()=>{const{user:a,logout:M}=H(),{currentPlan:t}=O(),u=I(),[h,p]=o.useState(""),[C,f]=o.useState(!1),[l,x]=o.useState({name:"",phone:"",email:""}),[g,v]=o.useState(!0);o.useEffect(()=>{(async()=>{if(a?.uid)try{v(!0);const r=await b.getUserBasicInfo(a.uid);x({name:r?.name||a.name||a.email?.split("@")[0]||"Usuário",phone:r?.phone||"",email:a.email||""})}catch(r){console.error("Erro ao carregar informações do usuário:",r),x({name:a.name||a.email?.split("@")[0]||"Usuário",phone:"",email:a.email||""})}finally{v(!1)}})()},[a]);const D=async()=>{if(a?.uid)try{await b.updateBasicInfo(a.uid,{name:l.name,phone:l.phone}),i.success("Perfil atualizado com sucesso!")}catch{i.error("Erro ao atualizar perfil. Tente novamente.")}},y=async()=>{if(h.toLowerCase()!=="sim"){i.error('Digite "sim" para confirmar a exclusão');return}try{const s=$.currentUser,r=s?.uid;if(!s||!r){i.error("Usuário não autenticado");return}await q(r),await V(s),i.success("Conta excluída com sucesso"),f(!1),p(""),u("/")}catch(s){s?.code==="auth/requires-recent-login"?i.error("Por segurança, faça login novamente e tente excluir a conta."):i.error("Não foi possível excluir a conta. Tente novamente.")}},P=()=>{f(!0),p("")},A=[{date:"2024-09-29",plan:"Ultimate",amount:99.9,status:"paid"},{date:"2024-08-30",plan:"Ultimate",amount:99.9,status:"paid"},{date:"2024-07-30",plan:"Standard",amount:49,status:"paid"}];return e.jsx(S,{children:e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Meu Perfil"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie suas informações pessoais"})]}),e.jsx(n,{className:"p-6 shadow-card",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"p-4 bg-primary/10 rounded-full",children:e.jsx(w,{className:"h-16 w-16 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:l.name||a?.name||"Usuário"}),e.jsx(j,{variant:"default",className:"capitalize",children:t}),a?.isAdmin&&e.jsx(j,{variant:"secondary",children:"Admin"})]}),e.jsx("p",{className:"text-muted-foreground mb-4",children:l.email}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>u("/planos"),children:"Gerenciar Plano"})]})]})}),e.jsxs(n,{className:"p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Informações Pessoais"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Nome Completo"}),e.jsx(m,{value:l.name,onChange:s=>x(r=>({...r,name:s.target.value})),disabled:g})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Email"}),e.jsx(m,{type:"email",value:l.email,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Telefone"}),e.jsx(m,{type:"tel",placeholder:"(11) 99999-9999",value:l.phone,onChange:s=>x(r=>({...r,phone:s.target.value})),disabled:g})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"CPF/CNPJ"}),e.jsx(m,{placeholder:"000.000.000-00",disabled:!0})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(d,{onClick:D,children:"Salvar Alterações"})})]}),e.jsxs(n,{className:"p-6 shadow-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(U,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Plano Atual"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Plano"}),e.jsx("p",{className:"text-xl font-bold capitalize",children:t})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:t==="free"?"Status":"Plano expira em"}),e.jsx("p",{className:"text-xl font-bold",children:t==="free"?"Ativo":"31/12/2025"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Valor Mensal"}),e.jsx("p",{className:"text-xl font-bold",children:t==="free"?"Grátis":t==="standard"?"R$ 49,00":t==="medium"?"R$ 49,90":"R$ 99,90"})]})]}),e.jsx(d,{variant:"outline",onClick:()=>u("/planos"),children:"Alterar Plano"})]}),e.jsxs(n,{className:"shadow-card",children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Histórico de Pagamentos"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-semibold",children:"Data"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Plano"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Valor"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Nota Fiscal"})]})}),e.jsx("tbody",{children:A.map((s,r)=>e.jsxs("tr",{className:"border-t border-border hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:new Date(s.date).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"p-4",children:s.plan}),e.jsxs("td",{className:"p-4 font-semibold",children:["R$ ",s.amount.toFixed(2).replace(".",",")]}),e.jsx("td",{className:"p-4",children:e.jsx(j,{variant:"default",children:"Pago"})}),e.jsx("td",{className:"p-4",children:e.jsx(d,{variant:"ghost",size:"sm",children:"Download"})})]},r))})]})})]}),e.jsxs(n,{className:"p-6 shadow-card border-destructive/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(N,{className:"h-5 w-5 text-destructive"}),e.jsx("h3",{className:"text-lg font-semibold text-destructive",children:"Zona de Perigo"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Uma vez que você exclua sua conta, não há como voltar atrás. Por favor, tenha certeza."}),e.jsxs(E,{open:C,onOpenChange:f,children:[e.jsx(z,{asChild:!0,children:e.jsx(d,{variant:"destructive",onClick:P,children:"Excluir Conta"})}),e.jsxs(L,{className:"bg-card border-border",children:[e.jsxs(T,{children:[e.jsxs(B,{className:"text-foreground flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-destructive"}),"Confirmar Exclusão de Conta"]}),e.jsxs(k,{className:"text-muted-foreground",children:["Esta ação é ",e.jsx("strong",{children:"irreversível"}),". Todos os seus dados serão permanentemente excluídos."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-destructive font-medium mb-2",children:"⚠️ Atenção: Esta ação não pode ser desfeita"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Todos os seus dados serão excluídos permanentemente"}),e.jsx("li",{children:"• Seu histórico de transações será perdido"}),e.jsx("li",{children:"• Suas configurações serão removidas"}),e.jsx("li",{children:"• Você precisará criar uma nova conta para usar o sistema"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"deleteConfirmation",className:"text-sm font-medium text-foreground",children:["Para confirmar, digite ",e.jsx("strong",{children:'"sim"'})," abaixo:"]}),e.jsx(m,{id:"deleteConfirmation",type:"text",placeholder:"Digite 'sim' para confirmar",value:h,onChange:s=>p(s.target.value),className:"border-destructive/50 focus:border-destructive"})]})]}),e.jsxs(F,{children:[e.jsx(R,{className:"bg-muted hover:bg-muted/80 text-foreground border-border",children:"Cancelar"}),e.jsx(G,{onClick:y,disabled:h.toLowerCase()!=="sim",className:"bg-destructive hover:bg-destructive/90 text-destructive-foreground disabled:opacity-50 disabled:cursor-not-allowed",children:"Excluir Conta Permanentemente"})]})]})]})]})]})})};export{re as default};
