const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/user-notifications.service-CAzP-qxP.js","assets/firebase-vendor-BUxvNq0f.js","assets/index-LiAbW-2G.js","assets/ui-vendor-CYAqJ0RG.js","assets/react-vendor-a_rYd-gI.js","assets/chart-vendor-ctXMAO2v.js","assets/index-RBW8IlQ1.css"])))=>i.map(i=>d[i]);
var v=Object.defineProperty;var F=(c,t,e)=>t in c?v(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e;var A=(c,t,e)=>F(c,typeof t!="symbol"?t+"":t,e);import{U as a,a as r}from"./user-subcollections.service-B4HigrO8.js";import{_ as U}from"./index-LiAbW-2G.js";import{A as S,B as l,z as d}from"./firebase-vendor-BUxvNq0f.js";class P{static async saveInitialSetup(t,e){return a.saveToUserSubcollection(t,r.CONFIG,this.docId,e)}static async getUserConfig(t){return a.getFromUserSubcollection(t,r.CONFIG,this.docId)}static async updateUserPlan(t,e){return a.updateUserSubcollection(t,r.CONFIG,this.docId,{currentPlan:e})}static async updateMonthlyGoal(t,e){return a.updateUserSubcollection(t,r.CONFIG,this.docId,{monthlyGoal:e})}static async updateSelectedPlatforms(t,e){return a.updateUserSubcollection(t,r.CONFIG,this.docId,{selectedPlatforms:e})}}A(P,"docId","initial");class R{static async createEmployee(t,e){console.log("UserEmployeeService.createEmployee - dados recebidos:",{userId:t,employeeData:e});const s=await a.addToUserSubcollection(t,r.EMPLOYEES,e);try{const{sendNewEmployeeNotification:n}=await U(async()=>{const{sendNewEmployeeNotification:m}=await import("./user-notifications.service-CAzP-qxP.js").then(i=>i.u);return{sendNewEmployeeNotification:m}},__vite__mapDeps([0,1,2,3,4,5,6]));await n(t,e.name,s)}catch(n){console.error("Erro ao enviar notificação de novo funcionário:",n)}return s}static async getEmployees(t){console.log("UserEmployeeService.getEmployees - buscando funcionários para userId:",t);const e=await a.getAllFromUserSubcollection(t,r.EMPLOYEES,[S("createdAt","desc")]);return console.log("Funcionários encontrados:",e),e}static async getActiveEmployees(t){return a.getAllFromUserSubcollection(t,r.EMPLOYEES,[l("status","==","active"),S("createdAt","desc")])}static async updateEmployee(t,e,s){return a.updateUserSubcollection(t,r.EMPLOYEES,e,s)}static async deleteEmployee(t,e){return a.deleteFromUserSubcollection(t,r.EMPLOYEES,e)}}class _{static async createPlatform(t,e){return a.addToUserSubcollection(t,r.PLATFORMS,e)}static async getPlatforms(t){return a.getAllFromUserSubcollection(t,r.PLATFORMS,[S("name","asc")])}static async getActivePlatforms(t){return a.getAllFromUserSubcollection(t,r.PLATFORMS,[l("isActive","==",!0),S("name","asc")])}static async updatePlatform(t,e,s){return a.updateUserSubcollection(t,r.PLATFORMS,e,s)}static async deletePlatform(t,e){return a.deleteFromUserSubcollection(t,r.PLATFORMS,e)}}class h{static async createTransaction(t,e){return a.addToUserSubcollection(t,r.TRANSACTIONS,e)}static async getTransactions(t,e=100){return a.getAllFromUserSubcollection(t,r.TRANSACTIONS,[d(e)])}static async getTransactionsByDateRange(t,e,s){console.log("UserTransactionService.getTransactionsByDateRange - userId:",t),console.log("UserTransactionService.getTransactionsByDateRange - startDate:",e),console.log("UserTransactionService.getTransactionsByDateRange - endDate:",s);const n=await a.getAllFromUserSubcollection(t,r.TRANSACTIONS,[l("date",">=",e),l("date","<=",s)]);return console.log("UserTransactionService.getTransactionsByDateRange - transactions found:",n),n}static async getTransactionsByEmployee(t,e){return a.getAllFromUserSubcollection(t,r.TRANSACTIONS,[l("employeeId","==",e)])}static async updateTransaction(t,e,s){return a.updateUserSubcollection(t,r.TRANSACTIONS,e,s)}static async deleteTransaction(t,e,s){const m=(await this.getTransactions(t,1e3)).find(o=>o.id===e),i=m?.date;if(await a.deleteFromUserSubcollection(t,r.TRANSACTIONS,e),!s?.skipDailySummaryUpdate&&m&&i)try{const o=await y.getDailySummaryByDate(t,i);if(o&&o.transactionsSnapshot&&Array.isArray(o.transactionsSnapshot))return;if(o){const u=await this.getTransactionsByDateRange(t,i,i);if(u.length===0){(!o.transactionsSnapshot||!Array.isArray(o.transactionsSnapshot)||o.transactionsSnapshot.length===0)&&await y.deleteDailySummary(t,o.id);return}const{calculateProfit:p,calculateTotalDeposits:T,calculateTotalWithdraws:E}=await U(async()=>{const{calculateProfit:f,calculateTotalDeposits:I,calculateTotalWithdraws:O}=await import("./financial-calculations-dg7KAW8P.js");return{calculateProfit:f,calculateTotalDeposits:I,calculateTotalWithdraws:O}},[]),g=p(u),b=T(u),D=E(u);await y.updateDailySummary(t,o.id,{totalDeposits:b,totalWithdraws:D,profit:g,margin:g,transactionCount:u.length,updatedAt:new Date})}}catch(o){console.error("Erro ao atualizar resumo diário ao excluir transação:",o)}}}class y{static async createDailySummary(t,e){return a.addToUserSubcollection(t,r.DAILY_SUMMARIES,e)}static async getAllDailySummaries(t){console.log("UserDailySummaryService.getAllDailySummaries - userId:",t);const e=await a.getAllFromUserSubcollection(t,r.DAILY_SUMMARIES,[]);return console.log("UserDailySummaryService.getAllDailySummaries - summaries found:",e),e}static async updateDailySummary(t,e,s){return a.updateUserSubcollection(t,r.DAILY_SUMMARIES,e,s)}static async deleteDailySummary(t,e){return a.deleteFromUserSubcollection(t,r.DAILY_SUMMARIES,e)}static async getDailySummaries(t,e=30){return a.getAllFromUserSubcollection(t,r.DAILY_SUMMARIES,[S("date","desc"),d(e)])}static async getDailySummaryByDate(t,e){const s=await a.getAllFromUserSubcollection(t,r.DAILY_SUMMARIES,[l("date","==",e),d(1)]);return s.length>0?s[0]:null}}const C=Object.freeze(Object.defineProperty({__proto__:null,UserDailySummaryService:y,UserEmployeeService:R,UserPlatformService:_,UserTransactionService:h},Symbol.toStringTag,{value:"Module"}));export{P as U,_ as a,h as b,y as c,R as d,C as u};
