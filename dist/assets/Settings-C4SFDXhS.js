const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-LiAbW-2G.js","assets/ui-vendor-CYAqJ0RG.js","assets/react-vendor-a_rYd-gI.js","assets/chart-vendor-ctXMAO2v.js","assets/firebase-vendor-BUxvNq0f.js","assets/index-RBW8IlQ1.css"])))=>i.map(i=>d[i]);
import{i as u,j as e,O as k,a as j,a4 as R,F as q,a5 as M,n as T,u as O,Y as U}from"./ui-vendor-CYAqJ0RG.js";import{r as p}from"./react-vendor-a_rYd-gI.js";import{D as B}from"./DashboardLayout-B3XyjcMy.js";import{o as L,_,C as h,q as F,r as z,s as G,t as I,B as x,j as P,h as V}from"./index-LiAbW-2G.js";import{L as r}from"./label-DLesFRW0.js";import{I as y}from"./input-J7GhaNSr.js";import{S as i}from"./switch-DAVPgkOz.js";import{T as H,a as Q,b as g,c as N}from"./tabs-BpqDSPQO.js";import{t as J}from"./firebase-vendor-BUxvNq0f.js";import{A as w,a as b}from"./alert-BhNgEuP2.js";import{g as K,c as Y}from"./user-notifications.service-CAzP-qxP.js";import"./user-specific.service-C1DLMu9g.js";import"./user-subcollections.service-B4HigrO8.js";import"./index-DMSHDzho.js";import"./chart-vendor-ctXMAO2v.js";import"./index-CdAzXW5_.js";const $=async(a="json")=>{try{console.log("üóÇÔ∏è Solicitando exporta√ß√£o de dados:",a);const d=(await J(L,"exportUserData")({format:a})).data;return d.success?(u.success("Exporta√ß√£o conclu√≠da!",{description:"Seus dados est√£o prontos para download.",duration:1e4}),console.log("‚úÖ Exporta√ß√£o conclu√≠da:",d.exportId)):u.error("Erro na exporta√ß√£o",{description:d.message}),d}catch(c){console.error("‚ùå Erro ao exportar dados:",c);const t=c.message||"Erro desconhecido ao exportar dados";return u.error("Erro na exporta√ß√£o",{description:t}),{success:!1,message:t}}},W=async a=>{try{console.log("üì• Registrando download:",a);const{captureBusinessEvent:c}=await _(async()=>{const{captureBusinessEvent:t}=await import("./index-LiAbW-2G.js").then(d=>d.N);return{captureBusinessEvent:t}},__vite__mapDeps([0,1,2,3,4,5]));c("data_export_downloaded",{exportId:a})}catch(c){console.error("Erro ao registrar download:",c)}},X=()=>{const[a,c]=p.useState(!1),[t,d]=p.useState(null),o=async m=>{try{c(!0),d(null);const n=await $(m);n.success&&n.downloadUrl&&d({downloadUrl:n.downloadUrl,expiresAt:n.expiresAt,exportId:n.exportId,format:m})}catch(n){console.error("Erro ao exportar dados:",n)}finally{c(!1)}},f=(m,n)=>{W(n),window.open(m,"_blank")};return e.jsxs(h,{children:[e.jsxs(F,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Exportar Meus Dados (LGPD)"]}),e.jsx(G,{children:"Baixe uma c√≥pia completa de todos os seus dados armazenados no sistema. De acordo com a LGPD, voc√™ tem direito de acessar todos os dados pessoais que mantemos sobre voc√™."})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"O que ser√° inclu√≠do:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Dados de autentica√ß√£o e perfil"}),e.jsx("li",{children:"Funcion√°rios cadastrados"}),e.jsx("li",{children:"Transa√ß√µes e pagamentos"}),e.jsx("li",{children:"Plataformas configuradas"}),e.jsx("li",{children:"Resumos di√°rios e relat√≥rios"}),e.jsx("li",{children:"Configura√ß√µes e prefer√™ncias"}),e.jsx("li",{children:"Hist√≥rico de altera√ß√µes de plano"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium",children:"Escolha o formato de exporta√ß√£o:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(x,{onClick:()=>o("json"),disabled:a,className:"h-auto py-4 flex flex-col items-center gap-2",variant:"outline",children:[a?e.jsx(j,{className:"h-6 w-6 animate-spin"}):e.jsx(R,{className:"h-6 w-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"Formato JSON"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Estruturado e leg√≠vel por m√°quinas"})]})]}),e.jsxs(x,{onClick:()=>o("csv"),disabled:a,className:"h-auto py-4 flex flex-col items-center gap-2",variant:"outline",children:[a?e.jsx(j,{className:"h-6 w-6 animate-spin"}):e.jsx(q,{className:"h-6 w-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"Formato CSV"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Compat√≠vel com Excel e Sheets"})]})]})]})]}),a&&e.jsxs(w,{children:[e.jsx(j,{className:"h-4 w-4 animate-spin"}),e.jsx(b,{children:"Preparando seus dados... Isso pode levar alguns segundos."})]}),t&&t.downloadUrl&&e.jsxs(w,{className:"border-green-500/50 bg-green-500/10",children:[e.jsx(k,{className:"h-4 w-4 text-green-600"}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-green-600",children:"Exporta√ß√£o conclu√≠da!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Seus dados foram exportados com sucesso no formato"," ",e.jsx(P,{variant:"secondary",children:t.format?.toUpperCase()})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs(x,{onClick:()=>f(t.downloadUrl,t.exportId),className:"flex-1",size:"sm",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Baixar Dados"]})}),t.expiresAt&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["‚è∞ O link de download expira em"," ",new Date(t.expiresAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsx(w,{children:e.jsxs(b,{className:"text-xs",children:[e.jsx("strong",{children:"Importante:"})," O arquivo exportado cont√©m dados sens√≠veis. Mantenha-o em local seguro e n√£o compartilhe com terceiros. O link de download expira automaticamente ap√≥s 24 horas."]})}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("p",{children:"‚Ä¢ A exporta√ß√£o inclui todos os dados at√© o momento da solicita√ß√£o"}),e.jsx("p",{children:"‚Ä¢ Dados exportados anteriormente n√£o s√£o inclu√≠dos"}),e.jsx("p",{children:"‚Ä¢ Voc√™ pode solicitar uma nova exporta√ß√£o a qualquer momento"}),e.jsx("p",{children:"‚Ä¢ Os arquivos de exporta√ß√£o s√£o armazenados por 30 dias"})]})]})]})},pe=()=>{const{user:a}=V(),c=T(),[t,d]=p.useState(!1),[o,f]=p.useState({email:!0,push:!0,paymentsPending:!0,goal50Percent:!0,goal75Percent:!0,goal100Percent:!0,goalReached:!0,newEmployees:!1,weeklyReports:!0,paymentOverdue:!0,lowBalance:!1,highActivity:!1}),m={email:!0,push:!0,paymentsPending:!0,goal50Percent:!0,goal75Percent:!0,goal100Percent:!0,goalReached:!0,newEmployees:!1,weeklyReports:!0,paymentOverdue:!0,lowBalance:!1,highActivity:!1},{data:n,isLoading:C,error:v}=O({queryKey:["notification-preferences",a?.uid],queryFn:async()=>{if(!a?.uid)return console.error("‚ö†Ô∏è Usu√°rio n√£o autenticado"),m;try{console.log("üì• Buscando prefer√™ncias para usu√°rio:",a.uid);const s=await K(a.uid);return console.log("‚úÖ Prefer√™ncias carregadas:",s),s}catch(s){return console.error("‚ùå Erro ao buscar prefer√™ncias:",s),m}},enabled:!!a?.uid,retry:1,staleTime:1/0,gcTime:1e3*60*10,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1});p.useEffect(()=>{n&&(console.log("üîÑ Atualizando estado com prefer√™ncias:",n),f(n))},[n]),p.useEffect(()=>{v&&(console.error("‚ùå Erro nas prefer√™ncias:",v),u.error("Erro ao carregar prefer√™ncias. Usando configura√ß√µes padr√£o."))},[v]);const E=U({mutationFn:async s=>{if(!a?.uid)throw new Error("Usu√°rio n√£o autenticado");return Y(a.uid,s)},onSuccess:()=>{c.invalidateQueries({queryKey:["notification-preferences",a?.uid]}),u.success("Prefer√™ncias de notifica√ß√£o salvas com sucesso!")},onError:s=>{console.error("Erro ao salvar prefer√™ncias:",s),u.error("Erro ao salvar prefer√™ncias. Tente novamente.")}}),A=async()=>{if(!a?.uid){u.error("Usu√°rio n√£o autenticado");return}d(!0);try{await E.mutateAsync(o)}catch{}finally{d(!1)}},l=(s,S)=>{f(D=>({...D,[s]:S}))};return e.jsx(B,{children:e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx(P,{className:"rounded-full bg-primary/10 px-4 py-1 text-[0.65rem] font-semibold uppercase tracking-[0.35em] text-primary mb-4",children:"Configura√ß√µes"}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Configura√ß√µes"}),e.jsx("p",{className:"text-muted-foreground",children:"Personalize suas prefer√™ncias"})]}),e.jsxs(H,{defaultValue:"general",className:"space-y-6",children:[e.jsxs(Q,{className:"grid w-full max-w-2xl grid-cols-4",children:[e.jsx(g,{value:"general",children:"Geral"}),e.jsx(g,{value:"notifications",children:"Notifica√ß√µes"}),e.jsx(g,{value:"security",children:"Seguran√ßa"}),e.jsx(g,{value:"privacy",children:"Privacidade"})]}),e.jsxs(N,{value:"general",className:"space-y-6",children:[e.jsxs(h,{className:"p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Configura√ß√µes Gerais"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Fuso Hor√°rio"}),e.jsxs("select",{className:"w-full max-w-xs h-10 rounded-md border border-input bg-background px-3 text-sm",children:[e.jsx("option",{children:"America/Sao_Paulo (GMT-3)"}),e.jsx("option",{children:"America/New_York (GMT-5)"}),e.jsx("option",{children:"Europe/London (GMT+0)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Moeda Padr√£o"}),e.jsxs("select",{className:"w-full max-w-xs h-10 rounded-md border border-input bg-background px-3 text-sm",children:[e.jsx("option",{children:"BRL (R$)"}),e.jsx("option",{children:"USD ($)"}),e.jsx("option",{children:"EUR (‚Ç¨)"})]})]})]})]}),e.jsxs(h,{className:"p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Prefer√™ncias de Interface"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Modo Compacto"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reduz o espa√ßamento da interface"})]}),e.jsx(i,{})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Anima√ß√µes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ativa/desativa anima√ß√µes da interface"})]}),e.jsx(i,{defaultChecked:!0})]})]})]})]}),e.jsx(N,{value:"notifications",className:"space-y-6",children:e.jsxs(h,{className:"p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Notifica√ß√µes"}),C&&!n?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[e.jsx(j,{className:"h-6 w-6 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando prefer√™ncias..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Gerais"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Notifica√ß√µes de Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receba atualiza√ß√µes por email"})]}),e.jsx(i,{checked:o.email,onCheckedChange:s=>l("email",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Notifica√ß√µes Push"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notifica√ß√µes em tempo real no navegador"})]}),e.jsx(i,{checked:o.push,onCheckedChange:s=>l("push",s)})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Metas Mensais"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"50% da Meta Atingida"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notifica√ß√£o quando atingir 50% da meta mensal"})]}),e.jsx(i,{checked:o.goal50Percent,onCheckedChange:s=>l("goal50Percent",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"75% da Meta Atingida"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notifica√ß√£o quando atingir 75% da meta mensal"})]}),e.jsx(i,{checked:o.goal75Percent,onCheckedChange:s=>l("goal75Percent",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"100% da Meta Atingida"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notifica√ß√£o quando atingir 100% da meta mensal"})]}),e.jsx(i,{checked:o.goal100Percent,onCheckedChange:s=>l("goal100Percent",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Meta Superada"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notifica√ß√£o quando superar a meta mensal"})]}),e.jsx(i,{checked:o.goalReached,onCheckedChange:s=>l("goalReached",s)})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Pagamentos"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Pagamentos Pendentes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Alertas sobre pagamentos n√£o realizados"})]}),e.jsx(i,{checked:o.paymentsPending,onCheckedChange:s=>l("paymentsPending",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Pagamentos Atrasados"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Alertas sobre pagamentos em atraso"})]}),e.jsx(i,{checked:o.paymentOverdue,onCheckedChange:s=>l("paymentOverdue",s)})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Outros"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Novos Funcion√°rios"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Alerta quando um novo funcion√°rio √© cadastrado"})]}),e.jsx(i,{checked:o.newEmployees,onCheckedChange:s=>l("newEmployees",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Saldo Baixo"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Alerta quando o saldo de uma plataforma estiver baixo"})]}),e.jsx(i,{checked:o.lowBalance,onCheckedChange:s=>l("lowBalance",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Alta Atividade"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notifica√ß√£o quando detectar alta atividade de transa√ß√µes"})]}),e.jsx(i,{checked:o.highActivity,onCheckedChange:s=>l("highActivity",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Relat√≥rios Semanais"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Resumo semanal enviado por email"})]}),e.jsx(i,{checked:o.weeklyReports,onCheckedChange:s=>l("weeklyReports",s)})]})]})]})]})}),e.jsxs(N,{value:"security",className:"space-y-6",children:[e.jsxs(h,{className:"p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Alterar Senha"}),e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Senha Atual"}),e.jsx(y,{type:"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Nova Senha"}),e.jsx(y,{type:"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Confirmar Nova Senha"}),e.jsx(y,{type:"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"})]}),e.jsx(x,{children:"Atualizar Senha"})]})]}),e.jsxs(h,{className:"p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Privacidade"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Autentica√ß√£o de Dois Fatores"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Adiciona uma camada extra de seguran√ßa"})]}),e.jsx(i,{})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Sess√µes Ativas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Gerenciar dispositivos conectados"})]}),e.jsx(x,{variant:"outline",size:"sm",children:"Ver Sess√µes"})]})]})]})]}),e.jsxs(N,{value:"privacy",className:"space-y-6",children:[e.jsx(X,{}),e.jsxs(h,{className:"p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Pol√≠tica de Privacidade"}),e.jsxs("div",{className:"space-y-4 text-sm text-muted-foreground",children:[e.jsx("p",{children:"Seus dados s√£o protegidos de acordo com a Lei Geral de Prote√ß√£o de Dados (LGPD). Coletamos apenas as informa√ß√µes necess√°rias para o funcionamento do sistema."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(x,{variant:"outline",size:"sm",asChild:!0,children:e.jsx("a",{href:"/privacidade",target:"_blank",children:"Ver Pol√≠tica Completa"})}),e.jsx(x,{variant:"outline",size:"sm",asChild:!0,children:e.jsx("a",{href:"/termos",target:"_blank",children:"Ver Termos de Uso"})})]})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{onClick:A,disabled:t||C,children:t?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):"Salvar Altera√ß√µes"})})]})})};export{pe as default};
