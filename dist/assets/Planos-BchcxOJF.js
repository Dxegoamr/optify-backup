import{Y as N,j as e,T as E,a as R,i as h,m as s,U as p,e as g,C as y,S as k,_ as S,Z as v}from"./ui-vendor-BKTCjC1N.js";import{r as u}from"./react-vendor-a_rYd-gI.js";import{D}from"./DashboardLayout-Bqy226V8.js";import{B as A,i as C,j as I,k as b,C as _}from"./index-CNSrT_AO.js";import{S as B}from"./switch-CClsDL2V.js";import{A as w,b as U,a as L}from"./alert-C6DPH5uI.js";import"./firebase-vendor-Dsl9zeYT.js";import"./input-BpX8f5oW.js";import"./index-C3o8K6qv.js";import"./chart-vendor-CfBne3GF.js";import"./index-CdAzXW5_.js";const f={FIREBASE_API_KEY:"AIzaSyD3Z8Z8Z8Z8Z8Z8Z8Z8Z8Z8Z8Z8Z8Z8Z8",FIREBASE_AUTH_DOMAIN:"optify-definitivo.firebaseapp.com",FIREBASE_PROJECT_ID:"optify-definitivo",FIREBASE_STORAGE_BUCKET:"optify-definitivo.appspot.com",FIREBASE_MESSAGING_SENDER_ID:"123456789",FIREBASE_APP_ID:"1:123456789:web:abcdef123456",MERCADO_PAGO_PUBLIC_KEY:"APP_USR-9ca765f9-6a73-47a9-ab3d-0923791c2a4f",API_URL:"https://us-central1-optify-definitivo.cloudfunctions.net"};function F(){return N({mutationFn:async o=>{console.log("🔍 Hook - URL da API:",f.API_URL),console.log("🔍 Hook - Payload:",o);const r=await fetch(`${f.API_URL}/createPaymentPreference`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(console.log("🔍 Hook - Status da resposta:",r.status),console.log("🔍 Hook - Headers da resposta:",Object.fromEntries(r.headers.entries())),!r.ok){const c=await r.json().catch(()=>({}));throw console.error("🔍 Hook - Erro da API:",c),new Error(c.error||"Erro ao criar preferência")}const i=await r.json();return console.log("🔍 Hook - Resposta da API:",i),i},onError:o=>{console.error("❌ Hook - Erro na mutation:",o)}})}const Z=({onClose:o})=>{const[r,i]=u.useState(!1),[c,l]=u.useState(!1);u.useEffect(()=>{(async()=>{try{const j=await fetch("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",{method:"HEAD",mode:"no-cors"});i(!1)}catch{i(!0)}})()},[]),u.useEffect(()=>{localStorage.getItem("adBlockerWarningDismissed")&&l(!0)},[]);const x=()=>{l(!0),localStorage.setItem("adBlockerWarningDismissed","true"),o?.()};return c||!r?null:e.jsxs(w,{className:"border-amber-500 bg-amber-500/10 mb-4",children:[e.jsx(E,{className:"h-4 w-4 text-amber-500"}),e.jsx(U,{className:"text-amber-500 font-semibold",children:"Aviso: Bloqueador de Anúncios Detectado"}),e.jsxs(L,{className:"mt-2 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"Seu bloqueador de anúncios pode interferir com o processo de pagamento do Mercado Pago."}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Para resolver:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Desabilite temporariamente o bloqueador de anúncios"}),e.jsx("li",{children:"Ou adicione o Mercado Pago à lista de exceções"}),e.jsx("li",{children:"Ou use o modo de navegação anônima"})]})]}),e.jsx("div",{className:"flex gap-2 mt-3",children:e.jsx(A,{variant:"outline",size:"sm",onClick:x,className:"h-8",children:"Entendi"})})]})]})},W=()=>{const{user:o}=C(),{currentPlan:r}=I(),[i,c]=u.useState(!1),l=F(),x={free:0,standard:1,medium:2,ultimate:3},d=t=>{const a=x[r]||0;return(x[t]||0)<a},m={free:[{text:"Dashboard básico",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de 1 funcionário",icon:p},{text:"Registro de transações do dia atual",icon:s},{text:"Depósitos e saques básicos",icon:s},{text:"Visualização do calendário (mês atual)",icon:s},{text:"Calendário Anterior",icon:s,blocked:!0},{text:"Pagamentos",icon:s,blocked:!0},{text:"Relatórios",icon:s,blocked:!0},{text:"Saldo de Contas",icon:s,blocked:!0},{text:"Histórico",icon:s,blocked:!0}],standard:[{text:"Dashboard básico",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de até 5 funcionários",icon:p},{text:"Registro de transações do dia atual",icon:s},{text:"Depósitos e saques",icon:s},{text:"Relatórios básicos",icon:g},{text:"Visualização do calendário (mês atual)",icon:s},{text:"Suporte por email",icon:s},{text:"Calendário Anterior",icon:s,blocked:!0},{text:"Pagamentos",icon:s,blocked:!0},{text:"Saldo de Contas",icon:s,blocked:!0},{text:"Histórico",icon:s,blocked:!0}],medium:[{text:"Dashboard completo",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de até 10 funcionários",icon:p},{text:"Registro de transações",icon:s},{text:"Depósitos e saques",icon:s},{text:"Calendário Anterior",icon:s},{text:"Pagamentos",icon:s},{text:"Relatórios avançados",icon:g},{text:"Saldo de Contas",icon:s},{text:"Histórico completo",icon:s}],ultimate:[{text:"Dashboard completo e avançado",icon:s},{text:"Resumo do dia",icon:s},{text:"Cadastro de até 50 funcionários",icon:p},{text:"Registro de transações ilimitadas",icon:s},{text:"Depósitos e saques",icon:s},{text:"Calendário Anterior",icon:s},{text:"Pagamentos",icon:s},{text:"Relatórios avançados",icon:g},{text:"Saldo de Contas",icon:s},{text:"Histórico completo",icon:s},{text:"CPA Chinesa",icon:y,exclusive:!0},{text:"Painel Avançado",icon:k,exclusive:!0},{text:"Dutchuing Bot",icon:S,exclusive:!0},{text:"Integrações avançadas",icon:v,exclusive:!0},{text:"API personalizada",icon:v,exclusive:!0},{text:"Suporte prioritário",icon:s,exclusive:!0},{text:"Suporte dedicado",icon:s,exclusive:!0}]},j=async t=>{if(!o){h.error("Você precisa estar logado para assinar um plano");return}if(t==="free"){h.error("O plano Free já está ativo");return}try{console.log("🔍 Debug - Variáveis de ambiente:",{API_URL:f.API_URL,PUBLIC_KEY:f.MERCADO_PAGO_PUBLIC_KEY}),console.log("🔍 Debug - Dados do payload:",{userId:o.uid,userEmail:o.email||"",userName:o.displayName||o.email?.split("@")[0]||"Usuário",planId:t,billingType:i?"annual":"monthly"});const a=await l.mutateAsync({userId:o.uid,userEmail:o.email||"",userName:o.displayName||o.email?.split("@")[0]||"Usuário",planId:t,billingType:i?"annual":"monthly"});console.log("✅ Preferência criada:",a);const n=a.init_point||a.sandbox_init_point;if(!n)throw new Error("URL de checkout não retornada pelo Mercado Pago");console.log("🔗 Redirecionando para:",n),window.location.href=n}catch(a){console.error("❌ Erro ao criar preferência:",a);const n=a instanceof Error?a.message:"Erro desconhecido";h.error(`Erro ao processar pagamento: ${n}`)}},P=[{name:"Free",value:"free",price:0,period:"Grátis",annualPrice:0,features:m.free,current:r==="free",popular:!1,description:"Testar o sistema"},{name:"Standard",value:"standard",price:34.9,period:"mês",annualPrice:356.76,features:m.standard,current:r==="standard",popular:!1,description:"Pequenos negócios"},{name:"Medium",value:"medium",price:49.9,period:"mês",annualPrice:509.16,features:m.medium,current:r==="medium",popular:!0,description:"Médias empresas"},{name:"Ultimate",value:"ultimate",price:74.9,period:"mês",annualPrice:764.76,features:m.ultimate,current:r==="ultimate",popular:!1,description:"Grandes empresas"}];return e.jsx(D,{children:e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsx(Z,{}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Escolha seu Plano"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Selecione o plano ideal para o seu negócio"}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("span",{className:i?"text-muted-foreground":"font-semibold",children:"Mensal"}),e.jsx(B,{checked:i,onCheckedChange:c}),e.jsxs("span",{className:i?"font-semibold":"text-muted-foreground",children:["Anual",e.jsx(b,{variant:"default",className:"ml-2",children:"15% OFF"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:P.map(t=>e.jsxs(_,{className:`
                p-6 relative shadow-card card-hover flex flex-col h-full
                ${t.popular?"border-primary border-2":""}
                ${d(t.value)?"opacity-60":""}
              `,children:[t.popular&&e.jsx(b,{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:"Mais Popular"}),t.current&&e.jsx(b,{variant:"outline",className:"absolute -top-3 left-1/2 -translate-x-1/2",children:"Plano Atual"}),e.jsxs("div",{className:"flex flex-col h-full space-y-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:t.description}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-4xl font-bold",children:["R$ ",(i?t.annualPrice/12:t.price).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),t.price>0&&e.jsxs("span",{className:"text-muted-foreground",children:["/",t.period]})]}),i&&t.price>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Valor anual: R$ ",t.annualPrice.toLocaleString("pt-BR",{minimumFractionDigits:2}),e.jsx("br",{}),"Economia de R$ ",(t.price*12-t.annualPrice).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsx("div",{className:"flex-grow space-y-3",children:t.features.map((a,n)=>e.jsxs("div",{className:"flex items-start gap-2",children:[a.blocked?e.jsx("div",{className:"h-5 w-5 shrink-0 mt-0.5 rounded-full border-2 border-muted-foreground/30 flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 rounded-full bg-muted-foreground/30"})}):e.jsx(a.icon,{className:`h-5 w-5 shrink-0 mt-0.5 ${a.exclusive?"text-primary":"text-success"}`}),e.jsxs("span",{className:`text-sm ${a.blocked?"text-muted-foreground/60":""} ${a.exclusive?"text-primary font-medium":""}`,children:[a.text,a.exclusive&&e.jsx("span",{className:"ml-1 text-xs",children:"(exclusivo)"})]})]},n))}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{className:"w-full",variant:t.current?"outline":"default",disabled:t.current||l.isPending||d(t.value),onClick:()=>!t.current&&!d(t.value)&&j(t.value),children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Redirecionando..."]}):t.current?"Plano Atual":d(t.value)?"Plano Menor":"Assinar"})})]})]},t.name))}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"Todos os planos incluem 7 dias de teste grátis"}),e.jsx("p",{children:"Cancele a qualquer momento, sem taxas adicionais"})]})]})})};export{W as default};
